{"version":3,"sources":["meteor://ðŸ’»app/packages/easysearch_autosuggest/lib/template.autosuggest.js","meteor://ðŸ’»app/packages/easysearch:autosuggest/lib/autosuggest.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4H;;;;;;;;;;;ACpBA,SAAS,wBAAT,EAAmC,UAAnC,CAA8C,YAAY;AAAA;;;;;;;;;;AASxD,MAAM,eAAe,SAAf,YAAe,CAAC,GAAD,EAAM,UAAN;AAAA,WAAqB,MAAK,IAAL,CAAU,GAAV,KAAkB,UAAvC;AAAA,GAArB;;AAEA,MAAI,CAAC,KAAK,IAAL,CAAU,KAAf,EAAsB;AACpB,UAAM,IAAI,OAAO,KAAX,CAAiB,UAAjB,EAA6B,4CAA7B,CAAN;AACD;;AAED,MAAI,KAAK,IAAL,CAAU,OAAd,EAAuB;AACrB,UAAM,IAAI,OAAO,KAAX,CAAiB,mBAAjB,EAAsC,4BAAtC,CAAN;AACD;;AAED,MAAI,eAAJ;AAAA,MAAY,oBAAZ;AAAA,MACE,QAAQ,KAAK,IAAL,CAAU,KADpB;AAAA,MAEE,aAAa,aAAa,YAAb,EAA2B,KAA3B,CAFf;AAAA,MAGE,aAAa,aAAa,YAAb,EAA2B,MAAM,MAAN,CAAa,MAAb,CAAoB,CAApB,CAA3B,CAHf;AAAA,MAIE,cAAc,aAAa,aAAb,EAA4B,UAA5B,CAJhB;AAAA,MAKE,sBAAsB,aAAa,qBAAb,EAAoC,UAAC,CAAD;AAAA,WAAO,CAAP;AAAA,GAApC,CALxB;AAAA,MAME,qBAAqB,SACnB,aAAa,kBAAb,EAAiC,8CAAjC,CADmB,CANvB;;AAUA,MAAM,SAAS,KAAK,CAAL,CAAO,QAAP,EAAiB,SAAjB,CAA2B,oBAAoB;AAC5D,0BAD4D;AAE5D,0BAF4D;AAG5D,4BAH4D;AAI5D,YAAQ,KAJoD;AAK5D,aAAS,IALmD;AAM5D,YAAQ;AACN;AAAQ,wBAAC,IAAD,EAAO,MAAP;AAAA,iBAAkB,MAAM,cAAN,CAAqB,kBAArB,EAAyC;AACjE,iBAAK,IAD4D;AAEjE,iBAAK,KAAK,GAFuD;AAGjE,mBAAO,EAAE,GAAF,CAAM,IAAN,EAAY,UAAZ;AAH0D,WAAzC,CAAlB;AAAA;;AAAR;AAAA;AADM,KANoD;AAa5D;AAAM,oBAAC,KAAD,EAAQ,QAAR,EAAqB;AACzB,YAAI,WAAJ,EAAiB;AACf,sBAAY,IAAZ;AACD;;AAED,sBAAc,QAAQ,OAAR,CAAgB,YAAM;AAClC,cAAI,SAAS,MAAM,MAAN,CAAa,KAAb,CAAb;AAAA,cACE,OAAO,OAAO,KAAP,EADT;;AAGA,cAAI,MAAJ,EAAY;AACV,yBAAa,MAAb;AACD;;AAED,mBAAS,WAAW,YAAM;AACxB,mBAAO,CAAP,EAAU,SAAV,CAAoB,YAApB;AACA,qBAAS,IAAT;AACD,WAHQ,EAGN,GAHM,CAAT;AAID,SAZa,CAAd;AAaD;;AAlBD;AAAA;AAb4D,GAApB,CAA3B,CAAf;AAiCD,CA9DD,2H","file":"/packages/easysearch_autosuggest.js","sourcesContent":["\nTemplate.__checkName(\"EasySearch.Autosuggest\");\nTemplate[\"EasySearch.Autosuggest\"] = new Template(\"Template.EasySearch.Autosuggest\", (function() {\n  var view = this;\n  return HTML.SELECT(HTML.Attrs(function() {\n    return Spacebars.attrMustache(view.lookup(\"attributes\"));\n  }));\n}));\n\nTemplate.__checkName(\"EasySarch.Autogguest.DefaultRenderSuggestion\");\nTemplate[\"EasySarch.Autogguest.DefaultRenderSuggestion\"] = new Template(\"Template.EasySarch.Autogguest.DefaultRenderSuggestion\", (function() {\n  var view = this;\n  return HTML.DIV(\"\\n    \", HTML.SPAN({\n    \"class\": \"autosuggest-title\"\n  }, HTML.SPAN({\n    \"class\": \"name\"\n  }, Blaze.View(\"lookup:label\", function() {\n    return Spacebars.mustache(view.lookup(\"label\"));\n  }))), \"\\n  \");\n}));\n","Template['EasySearch.Autosuggest'].onRendered(function () {\n  /**\n   * Helper function to return data for the autosuggest component.\n   *\n   * @param {String} val        Value to return\n   * @param {*}      defaultVal Optional default value to provide\n   *\n   * @return {*}\n   */\n  const getDataValue = (val, defaultVal) => this.data[val] || defaultVal;\n\n  if (!this.data.index) {\n    throw new Meteor.Error('no-index', 'Please provide an index for your component');\n  }\n\n  if (this.data.indexes) {\n    throw new Meteor.Error('only-single-index', 'Can only specify one index');\n  }\n\n  let handle, computation,\n    index = this.data.index,\n    valueField = getDataValue('valueField', '_id'),\n    labelField = getDataValue('labelField', index.config.fields[0]),\n    searchField = getDataValue('searchField', labelField),\n    changeConfiguration = getDataValue('changeConfiguration', (c) => c),\n    suggestionTemplate = Template[\n      getDataValue('renderSuggestion', 'EasySarch.Autogguest.DefaultRenderSuggestion')\n    ];\n\n  const select = this.$('select').selectize(changeConfiguration({\n    valueField,\n    labelField,\n    searchField,\n    create: false,\n    preload: true,\n    render: {\n      option: (item, escape) => Blaze.toHTMLWithData(suggestionTemplate, {\n        doc: item,\n        _id: item._id,\n        label: _.get(item, labelField)\n      })\n    },\n    load: (query, callback) => {\n      if (computation) {\n        computation.stop();\n      }\n\n      computation = Tracker.autorun(() => {\n        let cursor = index.search(query),\n          docs = cursor.fetch();\n\n        if (handle) {\n          clearTimeout(handle);\n        }\n\n        handle = setTimeout(() => {\n          select[0].selectize.clearOptions();\n          callback(docs);\n        }, 100);\n      });\n    }\n  }));\n});\n"]}