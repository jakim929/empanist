{"metadata":{"usedHelpers":["inherits","possibleConstructorReturn","createClass","classCallCheck","toConsumableArray","interopRequireDefault"],"marked":[],"modules":{"imports":[],"exports":{"exported":[],"specifiers":[]}}},"options":{"filename":"/packages/easysearch:components/lib/base.js","filenameRelative":"/packages/easysearch:components/lib/base.js","env":{},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"polyfill":false}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],{"loose":true}],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null]],"ignore":[],"code":true,"metadata":true,"ast":false,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"/packages/easysearch:components/lib/base.js.map","sourceFileName":"/packages/easysearch:components/lib/base.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"basename":"base"},"ignored":false,"code":"var _toConsumableArray2 = require('babel-runtime/helpers/toConsumableArray');\n\nvar _toConsumableArray3 = _interopRequireDefault(_toConsumableArray2);\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require('babel-runtime/helpers/createClass');\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require('babel-runtime/helpers/inherits');\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\n/**\n * The BaseComponent holds the base logic for EasySearch Components.\n *\n * @type {BaseComponent}\n */\nBaseComponent = function (_BlazeComponent) {\n  (0, _inherits3['default'])(BaseComponent, _BlazeComponent);\n\n  function BaseComponent() {\n    (0, _classCallCheck3['default'])(this, BaseComponent);\n    return (0, _possibleConstructorReturn3['default'])(this, _BlazeComponent.apply(this, arguments));\n  }\n\n  /**\n   * Setup component on created.\n   */\n\n  BaseComponent.prototype.onCreated = function () {\n    function onCreated() {\n      var _ref;\n\n      var index = this.getData().index,\n          indexes = [index];\n\n      if (!index) {\n        indexes = this.getData().indexes;\n      }\n\n      if (_.isEmpty(indexes)) {\n        throw new Meteor.Error('no-index', 'Please provide an index for your component');\n      }\n\n      if (indexes.filter(function (index) {\n        return index instanceof EasySearch.Index;\n      }).length != indexes.length) {\n        throw new Meteor.Error('invalid-configuration', 'Did not receive an index or an array of indexes: \"' + indexes.toString() + '\"');\n      }\n\n      this.indexes = indexes;\n      this.options = _.defaults({}, (_ref = _).omit.apply(_ref, [this.getData()].concat((0, _toConsumableArray3['default'])(BaseComponent.reserveredProperties))), this.defaultOptions);\n\n      check(this.name, Match.Optional(String));\n      check(this.options, Object);\n\n      this.eachIndex(function (index, name) {\n        if (!index.getComponentDict(name)) {\n          index.registerComponent(name);\n        }\n      });\n    }\n\n    return onCreated;\n  }();\n\n  /**\n   * Return the default options.\n   *\n   * @returns {Object}\n   */\n\n\n  /**\n   * Search the component.\n   *\n   * @param {String} searchString String to search for\n   */\n\n  BaseComponent.prototype.search = function () {\n    function search(searchString) {\n      check(searchString, String);\n\n      var showDocuments = !this.getData().noDocumentsOnEmpty || 0 < searchString.length;\n\n      this.eachIndex(function (index, name) {\n        index.getComponentDict(name).set('showDocuments', showDocuments);\n\n        if (showDocuments) {\n          index.getComponentMethods(name).search(searchString);\n        }\n      });\n    }\n\n    return search;\n  }();\n\n  /**\n   * Return the data.\n   *\n   * @returns {Object}\n   */\n\n\n  BaseComponent.prototype.getData = function () {\n    function getData() {\n      return this.data() || {};\n    }\n\n    return getData;\n  }();\n\n  /**\n   * Return the dictionaries.\n   *\n   * @returns {Object}\n   */\n\n\n  /**\n   * Loop through each index and apply a function\n   *\n   * @param {Function} func   Function to run\n   * @param {String}   method Lodash method name\n   *\n   * @return mixed\n   */\n\n  BaseComponent.prototype.eachIndex = function () {\n    function eachIndex(func) {\n      var method = arguments.length <= 1 || arguments[1] === undefined ? 'each' : arguments[1];\n\n      var componentScope = this,\n          logic = this.getData().logic;\n\n      if (!_.isEmpty(logic)) {\n        method = 'OR' === logic ? 'some' : 'every';\n      }\n\n      return _[method](this.indexes, function (index) {\n        return func.apply(this, [index, componentScope.name]);\n      });\n    }\n\n    return eachIndex;\n  }();\n\n  (0, _createClass3['default'])(BaseComponent, [{\n    key: 'name',\n\n    /**\n     * Return the name of the component.\n     *\n     * @returns {String}\n     */\n    get: function () {\n      function get() {\n        return this.getData().name;\n      }\n\n      return get;\n    }()\n\n    /**\n     * Return an array of properties that are reserved to the base component.\n     *\n     * @returns {String[]}\n     */\n\n  }, {\n    key: 'defaultOptions',\n    get: function () {\n      function get() {\n        return {};\n      }\n\n      return get;\n    }()\n  }, {\n    key: 'dicts',\n    get: function () {\n      function get() {\n        return this.eachIndex(function (index, name) {\n          return index.getComponentDict(name);\n        }, 'map');\n      }\n\n      return get;\n    }()\n  }], [{\n    key: 'reserveredProperties',\n    get: function () {\n      function get() {\n        return ['index', 'indexes', 'name', 'attributes'];\n      }\n\n      return get;\n    }()\n  }]);\n  return BaseComponent;\n}(BlazeComponent);\n\nEasySearch.BaseComponent = BaseComponent;","ast":null,"map":{"version":3,"sources":["/packages/easysearch:components/lib/base.js"],"names":[],"mappings":"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","file":"/packages/easysearch:components/lib/base.js.map","sourcesContent":["/**\n * The BaseComponent holds the base logic for EasySearch Components.\n *\n * @type {BaseComponent}\n */\nBaseComponent = class BaseComponent extends BlazeComponent {\n  /**\n   * Return the name of the component.\n   *\n   * @returns {String}\n   */\n  get name() {\n    return this.getData().name;\n  }\n\n  /**\n   * Return an array of properties that are reserved to the base component.\n   *\n   * @returns {String[]}\n   */\n  static get reserveredProperties() {\n    return ['index', 'indexes', 'name', 'attributes'];\n  }\n\n  /**\n   * Setup component on created.\n   */\n  onCreated() {\n    let index = this.getData().index,\n      indexes = [index];\n\n    if (!index) {\n      indexes = this.getData().indexes;\n    }\n\n    if (_.isEmpty(indexes)) {\n      throw new Meteor.Error('no-index', 'Please provide an index for your component');\n    }\n\n    if (indexes.filter((index) => index instanceof EasySearch.Index).length != indexes.length) {\n      throw new Meteor.Error(\n        'invalid-configuration',\n        `Did not receive an index or an array of indexes: \"${indexes.toString()}\"`\n      );\n    }\n\n    this.indexes = indexes;\n    this.options = _.defaults({}, _.omit(this.getData(), ...BaseComponent.reserveredProperties), this.defaultOptions);\n\n    check(this.name, Match.Optional(String));\n    check(this.options, Object);\n\n    this.eachIndex(function (index, name) {\n      if (!index.getComponentDict(name)) {\n        index.registerComponent(name);\n      }\n    });\n  }\n\n  /**\n   * Return the default options.\n   *\n   * @returns {Object}\n   */\n  get defaultOptions () {\n    return {};\n  }\n\n  /**\n   * Search the component.\n   *\n   * @param {String} searchString String to search for\n   */\n  search(searchString) {\n    check(searchString, String);\n\n    const showDocuments = !this.getData().noDocumentsOnEmpty || 0 < searchString.length;\n\n    this.eachIndex(function (index, name) {\n      index.getComponentDict(name).set('showDocuments', showDocuments);\n\n      if (showDocuments) {\n        index.getComponentMethods(name).search(searchString);\n      }\n    });\n  }\n\n  /**\n   * Return the data.\n   *\n   * @returns {Object}\n   */\n  getData() {\n    return (this.data() || {});\n  }\n\n  /**\n   * Return the dictionaries.\n   *\n   * @returns {Object}\n   */\n  get dicts() {\n    return this.eachIndex((index, name) => {\n      return index.getComponentDict(name);\n    }, 'map');\n  }\n\n  /**\n   * Loop through each index and apply a function\n   *\n   * @param {Function} func   Function to run\n   * @param {String}   method Lodash method name\n   *\n   * @return mixed\n   */\n  eachIndex(func, method = 'each') {\n    let componentScope = this,\n      logic = this.getData().logic;\n\n    if (!_.isEmpty(logic)) {\n      method = 'OR' === logic ? 'some' : 'every';\n    }\n\n    return _[method](this.indexes, function (index) {\n      return func.apply(this, [index, componentScope.name]);\n    });\n  }\n};\n\nEasySearch.BaseComponent = BaseComponent;\n"]},"hash":"07bdbe18a92ac15af578e579621e96bd4d318b2b"}
