{"metadata":{"usedHelpers":["inherits","possibleConstructorReturn","createClass","classCallCheck","toConsumableArray","interopRequireDefault"],"marked":[],"modules":{"imports":[],"exports":{"exported":[],"specifiers":[]}}},"options":{"filename":"/packages/easysearch:components/lib/base.js","filenameRelative":"/packages/easysearch:components/lib/base.js","env":{},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],{"polyfill":false}],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],{"loose":true}],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null]],"ignore":[],"code":true,"metadata":true,"ast":false,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"/packages/easysearch:components/lib/base.js.map","sourceFileName":"/packages/easysearch:components/lib/base.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"basename":"base"},"ignored":false,"code":"var _toConsumableArray2 = require('babel-runtime/helpers/toConsumableArray');\n\nvar _toConsumableArray3 = _interopRequireDefault(_toConsumableArray2);\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require('babel-runtime/helpers/createClass');\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require('babel-runtime/helpers/inherits');\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\n/**\n * The BaseComponent holds the base logic for EasySearch Components.\n *\n * @type {BaseComponent}\n */\nBaseComponent = function (_BlazeComponent) {\n  (0, _inherits3['default'])(BaseComponent, _BlazeComponent);\n\n  function BaseComponent() {\n    (0, _classCallCheck3['default'])(this, BaseComponent);\n    return (0, _possibleConstructorReturn3['default'])(this, _BlazeComponent.apply(this, arguments));\n  }\n\n  /**\n   * Setup component on created.\n   */\n\n  BaseComponent.prototype.onCreated = function () {\n    function onCreated() {\n      var _ref;\n\n      var index = this.getData().index,\n          indexes = [index];\n\n      if (!index) {\n        indexes = this.getData().indexes;\n      }\n\n      if (_.isEmpty(indexes)) {\n        throw new Meteor.Error('no-index', 'Please provide an index for your component');\n      }\n\n      if (indexes.filter(function (index) {\n        return index instanceof EasySearch.Index;\n      }).length != indexes.length) {\n        throw new Meteor.Error('invalid-configuration', 'Did not receive an index or an array of indexes: \"' + indexes.toString() + '\"');\n      }\n\n      this.indexes = indexes;\n      this.options = _.defaults({}, (_ref = _).omit.apply(_ref, [this.getData()].concat((0, _toConsumableArray3['default'])(BaseComponent.reserveredProperties))), this.defaultOptions);\n\n      check(this.name, Match.Optional(String));\n      check(this.options, Object);\n\n      this.eachIndex(function (index, name) {\n        if (!index.getComponentDict(name)) {\n          index.registerComponent(name);\n        }\n      });\n    }\n\n    return onCreated;\n  }();\n\n  /**\n   * Return the default options.\n   *\n   * @returns {Object}\n   */\n\n\n  /**\n   * Search the component.\n   *\n   * @param {String} searchString String to search for\n   */\n\n  BaseComponent.prototype.search = function () {\n    function search(searchString) {\n      check(searchString, String);\n\n      var showDocuments = !this.getData().noDocumentsOnEmpty || 0 < searchString.length;\n\n      this.eachIndex(function (index, name) {\n        index.getComponentDict(name).set('showDocuments', showDocuments);\n\n        if (showDocuments) {\n          index.getComponentMethods(name).search(searchString);\n        }\n      });\n    }\n\n    return search;\n  }();\n\n  /**\n   * Return the data.\n   *\n   * @returns {Object}\n   */\n\n\n  BaseComponent.prototype.getData = function () {\n    function getData() {\n      return this.data() || {};\n    }\n\n    return getData;\n  }();\n\n  /**\n   * Return the dictionaries.\n   *\n   * @returns {Object}\n   */\n\n\n  /**\n   * Loop through each index and apply a function\n   *\n   * @param {Function} func   Function to run\n   * @param {String}   method Lodash method name\n   *\n   * @return mixed\n   */\n\n  BaseComponent.prototype.eachIndex = function () {\n    function eachIndex(func) {\n      var method = arguments.length <= 1 || arguments[1] === undefined ? 'each' : arguments[1];\n\n      var componentScope = this,\n          logic = this.getData().logic;\n\n      if (!_.isEmpty(logic)) {\n        method = 'OR' === logic ? 'some' : 'every';\n      }\n\n      return _[method](this.indexes, function (index) {\n        return func.apply(this, [index, componentScope.name]);\n      });\n    }\n\n    return eachIndex;\n  }();\n\n  (0, _createClass3['default'])(BaseComponent, [{\n    key: 'name',\n\n    /**\n     * Return the name of the component.\n     *\n     * @returns {String}\n     */\n    get: function () {\n      function get() {\n        return this.getData().name;\n      }\n\n      return get;\n    }()\n\n    /**\n     * Return an array of properties that are reserved to the base component.\n     *\n     * @returns {String[]}\n     */\n\n  }, {\n    key: 'defaultOptions',\n    get: function () {\n      function get() {\n        return {};\n      }\n\n      return get;\n    }()\n  }, {\n    key: 'dicts',\n    get: function () {\n      function get() {\n        return this.eachIndex(function (index, name) {\n          return index.getComponentDict(name);\n        }, 'map');\n      }\n\n      return get;\n    }()\n  }], [{\n    key: 'reserveredProperties',\n    get: function () {\n      function get() {\n        return ['index', 'indexes', 'name', 'attributes'];\n      }\n\n      return get;\n    }()\n  }]);\n  return BaseComponent;\n}(BlazeComponent);\n\nEasySearch.BaseComponent = BaseComponent;","ast":null,"map":{"version":3,"sources":["/packages/easysearch:components/lib/base.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;AAKA;AAAA;;AAAA;AAAA;AAAA;AAAA;;;;;;AAAA,0BAsBE,SAtBF;AAAA,yBAsBc;AAAA;;AACV,UAAI,QAAQ,KAAK,OAAL,GAAe,KAA3B;AAAA,UACE,UAAU,CAAC,KAAD,CADZ;;AAGA,UAAI,CAAC,KAAL,EAAY;AACV,kBAAU,KAAK,OAAL,GAAe,OAAzB;AACD;;AAED,UAAI,EAAE,OAAF,CAAU,OAAV,CAAJ,EAAwB;AACtB,cAAM,IAAI,OAAO,KAAX,CAAiB,UAAjB,EAA6B,4CAA7B,CAAN;AACD;;AAED,UAAI,QAAQ,MAAR,CAAe,UAAC,KAAD;AAAA,eAAW,iBAAiB,WAAW,KAAvC;AAAA,OAAf,EAA6D,MAA7D,IAAuE,QAAQ,MAAnF,EAA2F;AACzF,cAAM,IAAI,OAAO,KAAX,CACJ,uBADI,yDAEiD,QAAQ,QAAR,EAFjD,OAAN;AAID;;AAED,WAAK,OAAL,GAAe,OAAf;AACA,WAAK,OAAL,GAAe,EAAE,QAAF,CAAW,EAAX,EAAe,WAAE,IAAF,cAAO,KAAK,OAAL,EAAP,6CAA0B,cAAc,oBAAxC,GAAf,EAA8E,KAAK,cAAnF,CAAf;;AAEA,YAAM,KAAK,IAAX,EAAiB,MAAM,QAAN,CAAe,MAAf,CAAjB;AACA,YAAM,KAAK,OAAX,EAAoB,MAApB;;AAEA,WAAK,SAAL,CAAe,UAAU,KAAV,EAAiB,IAAjB,EAAuB;AACpC,YAAI,CAAC,MAAM,gBAAN,CAAuB,IAAvB,CAAL,EAAmC;AACjC,gBAAM,iBAAN,CAAwB,IAAxB;AACD;AACF,OAJD;AAKD;;AApDH;AAAA;;;;;;;;;;;;;;;AAAA,0BAoEE,MApEF;AAAA,oBAoES,YApET,EAoEuB;AACnB,YAAM,YAAN,EAAoB,MAApB;;AAEA,UAAM,gBAAgB,CAAC,KAAK,OAAL,GAAe,kBAAhB,IAAsC,IAAI,aAAa,MAA7E;;AAEA,WAAK,SAAL,CAAe,UAAU,KAAV,EAAiB,IAAjB,EAAuB;AACpC,cAAM,gBAAN,CAAuB,IAAvB,EAA6B,GAA7B,CAAiC,eAAjC,EAAkD,aAAlD;;AAEA,YAAI,aAAJ,EAAmB;AACjB,gBAAM,mBAAN,CAA0B,IAA1B,EAAgC,MAAhC,CAAuC,YAAvC;AACD;AACF,OAND;AAOD;;AAhFH;AAAA;;;;;;;;;AAAA,0BAuFE,OAvFF;AAAA,uBAuFY;AACR,aAAQ,KAAK,IAAL,MAAe,EAAvB;AACD;;AAzFH;AAAA;;;;;;;;;;;;;;;;;;AAAA,0BA8GE,SA9GF;AAAA,uBA8GY,IA9GZ,EA8GmC;AAAA,UAAjB,MAAiB,yDAAR,MAAQ;;AAC/B,UAAI,iBAAiB,IAArB;AAAA,UACE,QAAQ,KAAK,OAAL,GAAe,KADzB;;AAGA,UAAI,CAAC,EAAE,OAAF,CAAU,KAAV,CAAL,EAAuB;AACrB,iBAAS,SAAS,KAAT,GAAiB,MAAjB,GAA0B,OAAnC;AACD;;AAED,aAAO,EAAE,MAAF,EAAU,KAAK,OAAf,EAAwB,UAAU,KAAV,EAAiB;AAC9C,eAAO,KAAK,KAAL,CAAW,IAAX,EAAiB,CAAC,KAAD,EAAQ,eAAe,IAAvB,CAAjB,CAAP;AACD,OAFM,CAAP;AAGD;;AAzHH;AAAA;;AAAA;AAAA;;;;;;;AAAA;AAAA,qBAMa;AACT,eAAO,KAAK,OAAL,GAAe,IAAtB;AACD;;AARH;AAAA;;;;;;;;AAAA;AAAA;AAAA;AAAA,qBA2DwB;AACpB,eAAO,EAAP;AACD;;AA7DH;AAAA;AAAA;AAAA;AAAA;AAAA,qBAgGc;AACV,eAAO,KAAK,SAAL,CAAe,UAAC,KAAD,EAAQ,IAAR,EAAiB;AACrC,iBAAO,MAAM,gBAAN,CAAuB,IAAvB,CAAP;AACD,SAFM,EAEJ,KAFI,CAAP;AAGD;;AApGH;AAAA;AAAA;AAAA;AAAA;AAAA,qBAeoC;AAChC,eAAO,CAAC,OAAD,EAAU,SAAV,EAAqB,MAArB,EAA6B,YAA7B,CAAP;AACD;;AAjBH;AAAA;AAAA;AAAA;AAAA,EAA4C,cAA5C;;AA4HA,WAAW,aAAX,GAA2B,aAA3B","file":"/packages/easysearch:components/lib/base.js.map","sourcesContent":["/**\n * The BaseComponent holds the base logic for EasySearch Components.\n *\n * @type {BaseComponent}\n */\nBaseComponent = class BaseComponent extends BlazeComponent {\n  /**\n   * Return the name of the component.\n   *\n   * @returns {String}\n   */\n  get name() {\n    return this.getData().name;\n  }\n\n  /**\n   * Return an array of properties that are reserved to the base component.\n   *\n   * @returns {String[]}\n   */\n  static get reserveredProperties() {\n    return ['index', 'indexes', 'name', 'attributes'];\n  }\n\n  /**\n   * Setup component on created.\n   */\n  onCreated() {\n    let index = this.getData().index,\n      indexes = [index];\n\n    if (!index) {\n      indexes = this.getData().indexes;\n    }\n\n    if (_.isEmpty(indexes)) {\n      throw new Meteor.Error('no-index', 'Please provide an index for your component');\n    }\n\n    if (indexes.filter((index) => index instanceof EasySearch.Index).length != indexes.length) {\n      throw new Meteor.Error(\n        'invalid-configuration',\n        `Did not receive an index or an array of indexes: \"${indexes.toString()}\"`\n      );\n    }\n\n    this.indexes = indexes;\n    this.options = _.defaults({}, _.omit(this.getData(), ...BaseComponent.reserveredProperties), this.defaultOptions);\n\n    check(this.name, Match.Optional(String));\n    check(this.options, Object);\n\n    this.eachIndex(function (index, name) {\n      if (!index.getComponentDict(name)) {\n        index.registerComponent(name);\n      }\n    });\n  }\n\n  /**\n   * Return the default options.\n   *\n   * @returns {Object}\n   */\n  get defaultOptions () {\n    return {};\n  }\n\n  /**\n   * Search the component.\n   *\n   * @param {String} searchString String to search for\n   */\n  search(searchString) {\n    check(searchString, String);\n\n    const showDocuments = !this.getData().noDocumentsOnEmpty || 0 < searchString.length;\n\n    this.eachIndex(function (index, name) {\n      index.getComponentDict(name).set('showDocuments', showDocuments);\n\n      if (showDocuments) {\n        index.getComponentMethods(name).search(searchString);\n      }\n    });\n  }\n\n  /**\n   * Return the data.\n   *\n   * @returns {Object}\n   */\n  getData() {\n    return (this.data() || {});\n  }\n\n  /**\n   * Return the dictionaries.\n   *\n   * @returns {Object}\n   */\n  get dicts() {\n    return this.eachIndex((index, name) => {\n      return index.getComponentDict(name);\n    }, 'map');\n  }\n\n  /**\n   * Loop through each index and apply a function\n   *\n   * @param {Function} func   Function to run\n   * @param {String}   method Lodash method name\n   *\n   * @return mixed\n   */\n  eachIndex(func, method = 'each') {\n    let componentScope = this,\n      logic = this.getData().logic;\n\n    if (!_.isEmpty(logic)) {\n      method = 'OR' === logic ? 'some' : 'every';\n    }\n\n    return _[method](this.indexes, function (index) {\n      return func.apply(this, [index, componentScope.name]);\n    });\n  }\n};\n\nEasySearch.BaseComponent = BaseComponent;\n"]},"hash":"33c970256c3ff78252311242c1e10cd44e367490"}
