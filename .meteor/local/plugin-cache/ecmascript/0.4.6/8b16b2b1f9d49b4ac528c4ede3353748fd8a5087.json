{"metadata":{"usedHelpers":[],"marked":[],"modules":{"imports":[],"exports":{"exported":[],"specifiers":[]}}},"options":{"filename":"/packages/easysearch:components/lib/component-methods.js","filenameRelative":"/packages/easysearch:components/lib/component-methods.js","env":{},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],{"polyfill":false}],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],{"loose":true}],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null]],"ignore":[],"code":true,"metadata":true,"ast":false,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"/packages/easysearch:components/lib/component-methods.js.map","sourceFileName":"/packages/easysearch:components/lib/component-methods.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"basename":"component-methods"},"ignored":false,"code":"EasySearch._getComponentMethods = function (dict, index) {\n  return {\n    /**\n     * Search a component for the given search string.\n     *\n     * @param {Object|String} searchDefinition Search definition\n     */\n    search: function () {\n      function search(searchDefinition) {\n        dict.set('searchOptions', {\n          props: (dict.get('searchOptions') || {}).props\n        });\n\n        dict.set('searchDefinition', searchDefinition);\n        dict.set('stopPublication', true);\n      }\n\n      return search;\n    }(),\n    /**\n     * Return the EasySearch.Cursor for the current search.\n     *\n     * @returns {Cursor}\n     */\n    getCursor: function () {\n      function getCursor() {\n        var searchDefinition = dict.get('searchDefinition') || '',\n            options = dict.get('searchOptions'),\n            showDocuments = dict.get('showDocuments');\n\n        check(options, Match.Optional(Object));\n\n        if (false === showDocuments) {\n          dict.set('count', 0);\n          dict.set('searching', false);\n          dict.set('limit', 0);\n          dict.set('skip', 0);\n          dict.set('currentCount', 0);\n          dict.set('stopPublication', false);\n\n          return EasySearch.Cursor.emptyCursor;\n        }\n\n        var cursor = index.search(searchDefinition, options),\n            searchOptions = index._getSearchOptions(options);\n\n        dict.set('count', cursor.count());\n        dict.set('searching', !cursor.isReady());\n        dict.set('limit', searchOptions.limit);\n        dict.set('skip', searchOptions.skip);\n        dict.set('currentCount', cursor.mongoCursor.count());\n        dict.set('stopPublication', false);\n\n        return cursor;\n      }\n\n      return getCursor;\n    }(),\n    /**\n     * Return true if the current search string is empty.\n     *\n     * @returns {boolean}\n     */\n    searchIsEmpty: function () {\n      function searchIsEmpty() {\n        var searchDefinition = dict.get('searchDefinition');\n\n        return !searchDefinition || _.isString(searchDefinition) && 0 === searchDefinition.trim().length;\n      }\n\n      return searchIsEmpty;\n    }(),\n    /**\n     * Return true if the component has no results.\n     *\n     * @returns {boolean}\n     */\n    hasNoResults: function () {\n      function hasNoResults() {\n        var count = dict.get('count'),\n            showDocuments = dict.get('showDocuments');\n\n        return false !== showDocuments && !dict.get('searching') && (!_.isNumber(count) || 0 === count);\n      }\n\n      return hasNoResults;\n    }(),\n    /**\n     * Return true if the component is being searched.\n     *\n     * @returns {boolean}\n     */\n    isSearching: function () {\n      function isSearching() {\n        return !!dict.get('searching');\n      }\n\n      return isSearching;\n    }(),\n    /**\n     * Return true if the component has more documents than displayed right now.\n     *\n     * @returns {boolean}\n     */\n    hasMoreDocuments: function () {\n      function hasMoreDocuments() {\n        return dict.get('currentCount') < dict.get('count');\n      }\n\n      return hasMoreDocuments;\n    }(),\n    /**\n     * Load more documents for the component.\n     *\n     * @param {Number} count Count of docs\n     */\n    loadMore: function () {\n      function loadMore(count) {\n        check(count, Number);\n\n        var currentCount = dict.get('currentCount'),\n            options = dict.get('searchOptions') || {};\n\n        options.limit = currentCount + count;\n        dict.set('searchOptions', options);\n      }\n\n      return loadMore;\n    }(),\n    /**\n     * Paginate through documents for the given page.\n     *\n     * @param {Number} page Page number\n     */\n    paginate: function () {\n      function paginate(page) {\n        check(page, Number);\n\n        var options = dict.get('searchOptions') || {},\n            limit = dict.get('limit');\n\n        options.skip = limit * (page - 1);\n        dict.set('searchOptions', options);\n        dict.set('stopPublication', true);\n      }\n\n      return paginate;\n    }(),\n    /**\n     * Add custom properties for search.\n     */\n    addProps: function () {\n      function addProps() {\n        for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n          args[_key] = arguments[_key];\n        }\n\n        var options = dict.get('searchOptions') || {};\n\n        options.props = options.props || {};\n\n        if (_.isObject(args[0])) {\n          options.props = _.extend(options.props, args[0]);\n        } else if (_.isString(args[0])) {\n          options.props[args[0]] = args[1];\n        }\n\n        dict.set('searchOptions', options);\n      }\n\n      return addProps;\n    }(),\n    /**\n     * Remove custom properties for search.\n     */\n    removeProps: function () {\n      function removeProps() {\n        for (var _len2 = arguments.length, args = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n          args[_key2] = arguments[_key2];\n        }\n\n        var options = dict.get('searchOptions') || {};\n\n        if (!_.isEmpty(args)) {\n          options.props = _.omit(options.props, args) || {};\n        } else {\n          options.props = {};\n        }\n\n        dict.set('searchOptions', options);\n      }\n\n      return removeProps;\n    }()\n  };\n};","ast":null,"map":{"version":3,"sources":["/packages/easysearch:components/lib/component-methods.js"],"names":[],"mappings":"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","file":"/packages/easysearch:components/lib/component-methods.js.map","sourcesContent":["EasySearch._getComponentMethods = function (dict, index) {\n  return {\n    /**\n     * Search a component for the given search string.\n     *\n     * @param {Object|String} searchDefinition Search definition\n     */\n    search: (searchDefinition) => {\n      dict.set('searchOptions', {\n        props: (dict.get('searchOptions') || {}).props\n      });\n\n      dict.set('searchDefinition', searchDefinition);\n      dict.set('stopPublication', true);\n    },\n    /**\n     * Return the EasySearch.Cursor for the current search.\n     *\n     * @returns {Cursor}\n     */\n    getCursor: () => {\n      const searchDefinition = dict.get('searchDefinition') || '',\n        options = dict.get('searchOptions'),\n        showDocuments = dict.get('showDocuments');\n\n      check(options, Match.Optional(Object));\n\n      if (false === showDocuments) {\n        dict.set('count', 0);\n        dict.set('searching', false);\n        dict.set('limit', 0);\n        dict.set('skip', 0);\n        dict.set('currentCount', 0);\n        dict.set('stopPublication', false);\n\n        return EasySearch.Cursor.emptyCursor;\n      }\n\n      const cursor = index.search(searchDefinition, options),\n        searchOptions = index._getSearchOptions(options);\n\n      dict.set('count', cursor.count());\n      dict.set('searching', !cursor.isReady());\n      dict.set('limit', searchOptions.limit);\n      dict.set('skip', searchOptions.skip);\n      dict.set('currentCount', cursor.mongoCursor.count());\n      dict.set('stopPublication', false);\n\n      return cursor;\n    },\n    /**\n     * Return true if the current search string is empty.\n     *\n     * @returns {boolean}\n     */\n    searchIsEmpty: () => {\n      let searchDefinition = dict.get('searchDefinition');\n\n      return !searchDefinition || (_.isString(searchDefinition) && 0 === searchDefinition.trim().length);\n    },\n    /**\n     * Return true if the component has no results.\n     *\n     * @returns {boolean}\n     */\n    hasNoResults: () => {\n      let count = dict.get('count'),\n        showDocuments = dict.get('showDocuments');\n\n      return false !== showDocuments\n        && !dict.get('searching')\n        && (!_.isNumber(count) || 0 === count);\n    },\n    /**\n     * Return true if the component is being searched.\n     *\n     * @returns {boolean}\n     */\n    isSearching: () => {\n      return !!dict.get('searching');\n    },\n    /**\n     * Return true if the component has more documents than displayed right now.\n     *\n     * @returns {boolean}\n     */\n    hasMoreDocuments: () => {\n      return dict.get('currentCount') < dict.get('count');\n    },\n    /**\n     * Load more documents for the component.\n     *\n     * @param {Number} count Count of docs\n     */\n    loadMore: (count) => {\n      check(count, Number);\n\n      let currentCount = dict.get('currentCount'),\n        options = dict.get('searchOptions') || {};\n\n      options.limit = currentCount + count;\n      dict.set('searchOptions', options);\n    },\n    /**\n     * Paginate through documents for the given page.\n     *\n     * @param {Number} page Page number\n     */\n    paginate: (page) => {\n      check(page, Number);\n\n      let options = dict.get('searchOptions') || {},\n        limit = dict.get('limit');\n\n      options.skip = limit * (page - 1);\n      dict.set('searchOptions', options);\n      dict.set('stopPublication', true);\n    },\n    /**\n     * Add custom properties for search.\n     */\n    addProps: (...args) => {\n      let options = dict.get('searchOptions') || {};\n\n      options.props = options.props || {};\n\n      if (_.isObject(args[0])) {\n        options.props = _.extend(options.props, args[0]);\n      } else if (_.isString(args[0])) {\n        options.props[args[0]] = args[1];\n      }\n\n      dict.set('searchOptions', options);\n    },\n    /**\n     * Remove custom properties for search.\n     */\n    removeProps: (...args) => {\n      let options = dict.get('searchOptions') || {};\n\n      if (!_.isEmpty(args)) {\n        options.props = _.omit(options.props, args) || {};\n      } else {\n        options.props = {};\n      }\n\n      dict.set('searchOptions', options);\n    }\n  };\n};\n"]},"hash":"8b16b2b1f9d49b4ac528c4ede3353748fd8a5087"}
