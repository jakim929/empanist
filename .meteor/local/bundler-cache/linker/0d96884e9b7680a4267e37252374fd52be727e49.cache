[{"type":"js","data":"//////////////////////////////////////////////////////////////////////////\n//                                                                      //\n// This is a generated file. You can view the original                  //\n// source in your browser if your browser supports source maps.         //\n// Source maps are supported by all recent versions of Chrome, Safari,  //\n// and Firefox, and by Internet Explorer 11.                            //\n//                                                                      //\n//////////////////////////////////////////////////////////////////////////\n\n\n(function () {\n\n/* Imports */\nvar Meteor = Package.meteor.Meteor;\nvar global = Package.meteor.global;\nvar meteorEnv = Package.meteor.meteorEnv;\nvar $ = Package.jquery.$;\nvar jQuery = Package.jquery.jQuery;\nvar Blaze = Package.ui.Blaze;\nvar UI = Package.ui.UI;\nvar Handlebars = Package.ui.Handlebars;\nvar HTML = Package.htmljs.HTML;\n\n/* Package-scope variables */\nvar isprefetch;\n\n(function(){\n\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                  //\n// packages/sergeyt_typeahead/typeahead.bundle.js                                                                   //\n//                                                                                                                  //\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                    //\n/*!                                                                                                                 // 1\n * typeahead.js 0.11.1                                                                                              // 2\n * https://github.com/twitter/typeahead.js                                                                          // 3\n * Copyright 2013-2015 Twitter, Inc. and other contributors; Licensed MIT                                           // 4\n */                                                                                                                 // 5\n                                                                                                                    // 6\n(function(root, factory) {                                                                                          // 7\n    if (typeof define === \"function\" && define.amd) {                                                               // 8\n        define(\"bloodhound\", [ \"jquery\" ], function(a0) {                                                           // 9\n            return root[\"Bloodhound\"] = factory(a0);                                                                // 10\n        });                                                                                                         // 11\n    } else if (typeof exports === \"object\") {                                                                       // 12\n        module.exports = factory(require(\"jquery\"));                                                                // 13\n    } else {                                                                                                        // 14\n        root[\"Bloodhound\"] = factory(jQuery);                                                                       // 15\n    }                                                                                                               // 16\n})(this, function($) {                                                                                              // 17\n    var _ = function() {                                                                                            // 18\n        \"use strict\";                                                                                               // 19\n        return {                                                                                                    // 20\n            isMsie: function() {                                                                                    // 21\n                return /(msie|trident)/i.test(navigator.userAgent) ? navigator.userAgent.match(/(msie |rv:)(\\d+(.\\d+)?)/i)[2] : false;\n            },                                                                                                      // 23\n            isBlankString: function(str) {                                                                          // 24\n                return !str || /^\\s*$/.test(str);                                                                   // 25\n            },                                                                                                      // 26\n            escapeRegExChars: function(str) {                                                                       // 27\n                return str.replace(/[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g, \"\\\\$&\");                                  // 28\n            },                                                                                                      // 29\n            isString: function(obj) {                                                                               // 30\n                return typeof obj === \"string\";                                                                     // 31\n            },                                                                                                      // 32\n            isNumber: function(obj) {                                                                               // 33\n                return typeof obj === \"number\";                                                                     // 34\n            },                                                                                                      // 35\n            isArray: $.isArray,                                                                                     // 36\n            isFunction: $.isFunction,                                                                               // 37\n            isObject: $.isPlainObject,                                                                              // 38\n            isUndefined: function(obj) {                                                                            // 39\n                return typeof obj === \"undefined\";                                                                  // 40\n            },                                                                                                      // 41\n            isElement: function(obj) {                                                                              // 42\n                return !!(obj && obj.nodeType === 1);                                                               // 43\n            },                                                                                                      // 44\n            isJQuery: function(obj) {                                                                               // 45\n                return obj instanceof $;                                                                            // 46\n            },                                                                                                      // 47\n            toStr: function toStr(s) {                                                                              // 48\n                return _.isUndefined(s) || s === null ? \"\" : s + \"\";                                                // 49\n            },                                                                                                      // 50\n            bind: $.proxy,                                                                                          // 51\n            each: function(collection, cb) {                                                                        // 52\n                $.each(collection, reverseArgs);                                                                    // 53\n                function reverseArgs(index, value) {                                                                // 54\n                    return cb(value, index);                                                                        // 55\n                }                                                                                                   // 56\n            },                                                                                                      // 57\n            map: $.map,                                                                                             // 58\n            filter: $.grep,                                                                                         // 59\n            every: function(obj, test) {                                                                            // 60\n                var result = true;                                                                                  // 61\n                if (!obj) {                                                                                         // 62\n                    return result;                                                                                  // 63\n                }                                                                                                   // 64\n                $.each(obj, function(key, val) {                                                                    // 65\n                    if (!(result = test.call(null, val, key, obj))) {                                               // 66\n                        return false;                                                                               // 67\n                    }                                                                                               // 68\n                });                                                                                                 // 69\n                return !!result;                                                                                    // 70\n            },                                                                                                      // 71\n            some: function(obj, test) {                                                                             // 72\n                var result = false;                                                                                 // 73\n                if (!obj) {                                                                                         // 74\n                    return result;                                                                                  // 75\n                }                                                                                                   // 76\n                $.each(obj, function(key, val) {                                                                    // 77\n                    if (result = test.call(null, val, key, obj)) {                                                  // 78\n                        return false;                                                                               // 79\n                    }                                                                                               // 80\n                });                                                                                                 // 81\n                return !!result;                                                                                    // 82\n            },                                                                                                      // 83\n            mixin: $.extend,                                                                                        // 84\n            identity: function(x) {                                                                                 // 85\n                return x;                                                                                           // 86\n            },                                                                                                      // 87\n            clone: function(obj) {                                                                                  // 88\n                return $.extend(true, {}, obj);                                                                     // 89\n            },                                                                                                      // 90\n            getIdGenerator: function() {                                                                            // 91\n                var counter = 0;                                                                                    // 92\n                return function() {                                                                                 // 93\n                    return counter++;                                                                               // 94\n                };                                                                                                  // 95\n            },                                                                                                      // 96\n            templatify: function templatify(obj) {                                                                  // 97\n                return $.isFunction(obj) ? obj : template;                                                          // 98\n                function template() {                                                                               // 99\n                    return String(obj);                                                                             // 100\n                }                                                                                                   // 101\n            },                                                                                                      // 102\n            defer: function(fn) {                                                                                   // 103\n                setTimeout(fn, 0);                                                                                  // 104\n            },                                                                                                      // 105\n            debounce: function(func, wait, immediate) {                                                             // 106\n                var timeout, result;                                                                                // 107\n                return function() {                                                                                 // 108\n                    var context = this, args = arguments, later, callNow;                                           // 109\n                    later = function() {                                                                            // 110\n                        timeout = null;                                                                             // 111\n                        if (!immediate) {                                                                           // 112\n                            result = func.apply(context, args);                                                     // 113\n                        }                                                                                           // 114\n                    };                                                                                              // 115\n                    callNow = immediate && !timeout;                                                                // 116\n                    clearTimeout(timeout);                                                                          // 117\n                    timeout = setTimeout(later, wait);                                                              // 118\n                    if (callNow) {                                                                                  // 119\n                        result = func.apply(context, args);                                                         // 120\n                    }                                                                                               // 121\n                    return result;                                                                                  // 122\n                };                                                                                                  // 123\n            },                                                                                                      // 124\n            throttle: function(func, wait) {                                                                        // 125\n                var context, args, timeout, result, previous, later;                                                // 126\n                previous = 0;                                                                                       // 127\n                later = function() {                                                                                // 128\n                    previous = new Date();                                                                          // 129\n                    timeout = null;                                                                                 // 130\n                    result = func.apply(context, args);                                                             // 131\n                };                                                                                                  // 132\n                return function() {                                                                                 // 133\n                    var now = new Date(), remaining = wait - (now - previous);                                      // 134\n                    context = this;                                                                                 // 135\n                    args = arguments;                                                                               // 136\n                    if (remaining <= 0) {                                                                           // 137\n                        clearTimeout(timeout);                                                                      // 138\n                        timeout = null;                                                                             // 139\n                        previous = now;                                                                             // 140\n                        result = func.apply(context, args);                                                         // 141\n                    } else if (!timeout) {                                                                          // 142\n                        timeout = setTimeout(later, remaining);                                                     // 143\n                    }                                                                                               // 144\n                    return result;                                                                                  // 145\n                };                                                                                                  // 146\n            },                                                                                                      // 147\n            stringify: function(val) {                                                                              // 148\n                return _.isString(val) ? val : JSON.stringify(val);                                                 // 149\n            },                                                                                                      // 150\n            noop: function() {}                                                                                     // 151\n        };                                                                                                          // 152\n    }();                                                                                                            // 153\n    var VERSION = \"0.11.1\";                                                                                         // 154\n    var tokenizers = function() {                                                                                   // 155\n        \"use strict\";                                                                                               // 156\n        return {                                                                                                    // 157\n            nonword: nonword,                                                                                       // 158\n            whitespace: whitespace,                                                                                 // 159\n            obj: {                                                                                                  // 160\n                nonword: getObjTokenizer(nonword),                                                                  // 161\n                whitespace: getObjTokenizer(whitespace)                                                             // 162\n            }                                                                                                       // 163\n        };                                                                                                          // 164\n        function whitespace(str) {                                                                                  // 165\n            str = _.toStr(str);                                                                                     // 166\n            return str ? str.split(/\\s+/) : [];                                                                     // 167\n        }                                                                                                           // 168\n        function nonword(str) {                                                                                     // 169\n            str = _.toStr(str);                                                                                     // 170\n            return str ? str.split(/\\W+/) : [];                                                                     // 171\n        }                                                                                                           // 172\n        function getObjTokenizer(tokenizer) {                                                                       // 173\n            return function setKey(keys) {                                                                          // 174\n                keys = _.isArray(keys) ? keys : [].slice.call(arguments, 0);                                        // 175\n                return function tokenize(o) {                                                                       // 176\n                    var tokens = [];                                                                                // 177\n                    _.each(keys, function(k) {                                                                      // 178\n                        tokens = tokens.concat(tokenizer(_.toStr(o[k])));                                           // 179\n                    });                                                                                             // 180\n                    return tokens;                                                                                  // 181\n                };                                                                                                  // 182\n            };                                                                                                      // 183\n        }                                                                                                           // 184\n    }();                                                                                                            // 185\n    var LruCache = function() {                                                                                     // 186\n        \"use strict\";                                                                                               // 187\n        function LruCache(maxSize) {                                                                                // 188\n            this.maxSize = _.isNumber(maxSize) ? maxSize : 100;                                                     // 189\n            this.reset();                                                                                           // 190\n            if (this.maxSize <= 0) {                                                                                // 191\n                this.set = this.get = $.noop;                                                                       // 192\n            }                                                                                                       // 193\n        }                                                                                                           // 194\n        _.mixin(LruCache.prototype, {                                                                               // 195\n            set: function set(key, val) {                                                                           // 196\n                var tailItem = this.list.tail, node;                                                                // 197\n                if (this.size >= this.maxSize) {                                                                    // 198\n                    this.list.remove(tailItem);                                                                     // 199\n                    delete this.hash[tailItem.key];                                                                 // 200\n                    this.size--;                                                                                    // 201\n                }                                                                                                   // 202\n                if (node = this.hash[key]) {                                                                        // 203\n                    node.val = val;                                                                                 // 204\n                    this.list.moveToFront(node);                                                                    // 205\n                } else {                                                                                            // 206\n                    node = new Node(key, val);                                                                      // 207\n                    this.list.add(node);                                                                            // 208\n                    this.hash[key] = node;                                                                          // 209\n                    this.size++;                                                                                    // 210\n                }                                                                                                   // 211\n            },                                                                                                      // 212\n            get: function get(key) {                                                                                // 213\n                var node = this.hash[key];                                                                          // 214\n                if (node) {                                                                                         // 215\n                    this.list.moveToFront(node);                                                                    // 216\n                    return node.val;                                                                                // 217\n                }                                                                                                   // 218\n            },                                                                                                      // 219\n            reset: function reset() {                                                                               // 220\n                this.size = 0;                                                                                      // 221\n                this.hash = {};                                                                                     // 222\n                this.list = new List();                                                                             // 223\n            }                                                                                                       // 224\n        });                                                                                                         // 225\n        function List() {                                                                                           // 226\n            this.head = this.tail = null;                                                                           // 227\n        }                                                                                                           // 228\n        _.mixin(List.prototype, {                                                                                   // 229\n            add: function add(node) {                                                                               // 230\n                if (this.head) {                                                                                    // 231\n                    node.next = this.head;                                                                          // 232\n                    this.head.prev = node;                                                                          // 233\n                }                                                                                                   // 234\n                this.head = node;                                                                                   // 235\n                this.tail = this.tail || node;                                                                      // 236\n            },                                                                                                      // 237\n            remove: function remove(node) {                                                                         // 238\n                node.prev ? node.prev.next = node.next : this.head = node.next;                                     // 239\n                node.next ? node.next.prev = node.prev : this.tail = node.prev;                                     // 240\n            },                                                                                                      // 241\n            moveToFront: function(node) {                                                                           // 242\n                this.remove(node);                                                                                  // 243\n                this.add(node);                                                                                     // 244\n            }                                                                                                       // 245\n        });                                                                                                         // 246\n        function Node(key, val) {                                                                                   // 247\n            this.key = key;                                                                                         // 248\n            this.val = val;                                                                                         // 249\n            this.prev = this.next = null;                                                                           // 250\n        }                                                                                                           // 251\n        return LruCache;                                                                                            // 252\n    }();                                                                                                            // 253\n    var PersistentStorage = function() {                                                                            // 254\n        \"use strict\";                                                                                               // 255\n        var LOCAL_STORAGE;                                                                                          // 256\n        try {                                                                                                       // 257\n            LOCAL_STORAGE = window.localStorage;                                                                    // 258\n            LOCAL_STORAGE.setItem(\"~~~\", \"!\");                                                                      // 259\n            LOCAL_STORAGE.removeItem(\"~~~\");                                                                        // 260\n        } catch (err) {                                                                                             // 261\n            LOCAL_STORAGE = null;                                                                                   // 262\n        }                                                                                                           // 263\n        function PersistentStorage(namespace, override) {                                                           // 264\n            this.prefix = [ \"__\", namespace, \"__\" ].join(\"\");                                                       // 265\n            this.ttlKey = \"__ttl__\";                                                                                // 266\n            this.keyMatcher = new RegExp(\"^\" + _.escapeRegExChars(this.prefix));                                    // 267\n            this.ls = override || LOCAL_STORAGE;                                                                    // 268\n            !this.ls && this._noop();                                                                               // 269\n        }                                                                                                           // 270\n        _.mixin(PersistentStorage.prototype, {                                                                      // 271\n            _prefix: function(key) {                                                                                // 272\n                return this.prefix + key;                                                                           // 273\n            },                                                                                                      // 274\n            _ttlKey: function(key) {                                                                                // 275\n                return this._prefix(key) + this.ttlKey;                                                             // 276\n            },                                                                                                      // 277\n            _noop: function() {                                                                                     // 278\n                this.get = this.set = this.remove = this.clear = this.isExpired = _.noop;                           // 279\n            },                                                                                                      // 280\n            _safeSet: function(key, val) {                                                                          // 281\n                try {                                                                                               // 282\n                    this.ls.setItem(key, val);                                                                      // 283\n                } catch (err) {                                                                                     // 284\n                    if (err.name === \"QuotaExceededError\") {                                                        // 285\n                        this.clear();                                                                               // 286\n                        this._noop();                                                                               // 287\n                    }                                                                                               // 288\n                }                                                                                                   // 289\n            },                                                                                                      // 290\n            get: function(key) {                                                                                    // 291\n                if (this.isExpired(key)) {                                                                          // 292\n                    this.remove(key);                                                                               // 293\n                }                                                                                                   // 294\n                return decode(this.ls.getItem(this._prefix(key)));                                                  // 295\n            },                                                                                                      // 296\n            set: function(key, val, ttl) {                                                                          // 297\n                if (_.isNumber(ttl)) {                                                                              // 298\n                    this._safeSet(this._ttlKey(key), encode(now() + ttl));                                          // 299\n                } else {                                                                                            // 300\n                    this.ls.removeItem(this._ttlKey(key));                                                          // 301\n                }                                                                                                   // 302\n                return this._safeSet(this._prefix(key), encode(val));                                               // 303\n            },                                                                                                      // 304\n            remove: function(key) {                                                                                 // 305\n                this.ls.removeItem(this._ttlKey(key));                                                              // 306\n                this.ls.removeItem(this._prefix(key));                                                              // 307\n                return this;                                                                                        // 308\n            },                                                                                                      // 309\n            clear: function() {                                                                                     // 310\n                var i, keys = gatherMatchingKeys(this.keyMatcher);                                                  // 311\n                for (i = keys.length; i--; ) {                                                                      // 312\n                    this.remove(keys[i]);                                                                           // 313\n                }                                                                                                   // 314\n                return this;                                                                                        // 315\n            },                                                                                                      // 316\n            isExpired: function(key) {                                                                              // 317\n                var ttl = decode(this.ls.getItem(this._ttlKey(key)));                                               // 318\n                return _.isNumber(ttl) && now() > ttl ? true : false;                                               // 319\n            }                                                                                                       // 320\n        });                                                                                                         // 321\n        return PersistentStorage;                                                                                   // 322\n        function now() {                                                                                            // 323\n            return new Date().getTime();                                                                            // 324\n        }                                                                                                           // 325\n        function encode(val) {                                                                                      // 326\n            return JSON.stringify(_.isUndefined(val) ? null : val);                                                 // 327\n        }                                                                                                           // 328\n        function decode(val) {                                                                                      // 329\n            return $.parseJSON(val);                                                                                // 330\n        }                                                                                                           // 331\n        function gatherMatchingKeys(keyMatcher) {                                                                   // 332\n            var i, key, keys = [], len = LOCAL_STORAGE.length;                                                      // 333\n            for (i = 0; i < len; i++) {                                                                             // 334\n                if ((key = LOCAL_STORAGE.key(i)).match(keyMatcher)) {                                               // 335\n                    keys.push(key.replace(keyMatcher, \"\"));                                                         // 336\n                }                                                                                                   // 337\n            }                                                                                                       // 338\n            return keys;                                                                                            // 339\n        }                                                                                                           // 340\n    }();                                                                                                            // 341\n    var Transport = function() {                                                                                    // 342\n        \"use strict\";                                                                                               // 343\n        var pendingRequestsCount = 0, pendingRequests = {}, maxPendingRequests = 6, sharedCache = new LruCache(10);\n        function Transport(o) {                                                                                     // 345\n            o = o || {};                                                                                            // 346\n            this.cancelled = false;                                                                                 // 347\n            this.lastReq = null;                                                                                    // 348\n            this._send = o.transport;                                                                               // 349\n            this._get = o.limiter ? o.limiter(this._get) : this._get;                                               // 350\n            this._cache = o.cache === false ? new LruCache(0) : sharedCache;                                        // 351\n        }                                                                                                           // 352\n        Transport.setMaxPendingRequests = function setMaxPendingRequests(num) {                                     // 353\n            maxPendingRequests = num;                                                                               // 354\n        };                                                                                                          // 355\n        Transport.resetCache = function resetCache() {                                                              // 356\n            sharedCache.reset();                                                                                    // 357\n        };                                                                                                          // 358\n        _.mixin(Transport.prototype, {                                                                              // 359\n            _fingerprint: function fingerprint(o) {                                                                 // 360\n                o = o || {};                                                                                        // 361\n                return o.url + o.type + $.param(o.data || {});                                                      // 362\n            },                                                                                                      // 363\n            _get: function(o, cb) {                                                                                 // 364\n                var that = this, fingerprint, jqXhr;                                                                // 365\n                fingerprint = this._fingerprint(o);                                                                 // 366\n                if (this.cancelled || fingerprint !== this.lastReq) {                                               // 367\n                    return;                                                                                         // 368\n                }                                                                                                   // 369\n                if (jqXhr = pendingRequests[fingerprint]) {                                                         // 370\n                    jqXhr.done(done).fail(fail);                                                                    // 371\n                } else if (pendingRequestsCount < maxPendingRequests) {                                             // 372\n                    pendingRequestsCount++;                                                                         // 373\n                    pendingRequests[fingerprint] = this._send(o).done(done).fail(fail).always(always);              // 374\n                } else {                                                                                            // 375\n                    this.onDeckRequestArgs = [].slice.call(arguments, 0);                                           // 376\n                }                                                                                                   // 377\n                function done(resp) {                                                                               // 378\n                    cb(null, resp);                                                                                 // 379\n                    that._cache.set(fingerprint, resp);                                                             // 380\n                }                                                                                                   // 381\n                function fail() {                                                                                   // 382\n                    cb(true);                                                                                       // 383\n                }                                                                                                   // 384\n                function always() {                                                                                 // 385\n                    pendingRequestsCount--;                                                                         // 386\n                    delete pendingRequests[fingerprint];                                                            // 387\n                    if (that.onDeckRequestArgs) {                                                                   // 388\n                        that._get.apply(that, that.onDeckRequestArgs);                                              // 389\n                        that.onDeckRequestArgs = null;                                                              // 390\n                    }                                                                                               // 391\n                }                                                                                                   // 392\n            },                                                                                                      // 393\n            get: function(o, cb) {                                                                                  // 394\n                var resp, fingerprint;                                                                              // 395\n                cb = cb || $.noop;                                                                                  // 396\n                o = _.isString(o) ? {                                                                               // 397\n                    url: o                                                                                          // 398\n                } : o || {};                                                                                        // 399\n                fingerprint = this._fingerprint(o);                                                                 // 400\n                this.cancelled = false;                                                                             // 401\n                this.lastReq = fingerprint;                                                                         // 402\n                if (resp = this._cache.get(fingerprint)) {                                                          // 403\n                    cb(null, resp);                                                                                 // 404\n                } else {                                                                                            // 405\n                    this._get(o, cb);                                                                               // 406\n                }                                                                                                   // 407\n            },                                                                                                      // 408\n            cancel: function() {                                                                                    // 409\n                this.cancelled = true;                                                                              // 410\n            }                                                                                                       // 411\n        });                                                                                                         // 412\n        return Transport;                                                                                           // 413\n    }();                                                                                                            // 414\n    var SearchIndex = window.SearchIndex = function() {                                                             // 415\n        \"use strict\";                                                                                               // 416\n        var CHILDREN = \"c\", IDS = \"i\";                                                                              // 417\n        function SearchIndex(o) {                                                                                   // 418\n            o = o || {};                                                                                            // 419\n            if (!o.datumTokenizer || !o.queryTokenizer) {                                                           // 420\n                $.error(\"datumTokenizer and queryTokenizer are both required\");                                     // 421\n            }                                                                                                       // 422\n            this.identify = o.identify || _.stringify;                                                              // 423\n            this.datumTokenizer = o.datumTokenizer;                                                                 // 424\n            this.queryTokenizer = o.queryTokenizer;                                                                 // 425\n            this.reset();                                                                                           // 426\n        }                                                                                                           // 427\n        _.mixin(SearchIndex.prototype, {                                                                            // 428\n            bootstrap: function bootstrap(o) {                                                                      // 429\n                this.datums = o.datums;                                                                             // 430\n                this.trie = o.trie;                                                                                 // 431\n            },                                                                                                      // 432\n            add: function(data) {                                                                                   // 433\n                var that = this;                                                                                    // 434\n                data = _.isArray(data) ? data : [ data ];                                                           // 435\n                _.each(data, function(datum) {                                                                      // 436\n                    var id, tokens;                                                                                 // 437\n                    that.datums[id = that.identify(datum)] = datum;                                                 // 438\n                    tokens = normalizeTokens(that.datumTokenizer(datum));                                           // 439\n                    _.each(tokens, function(token) {                                                                // 440\n                        var node, chars, ch;                                                                        // 441\n                        node = that.trie;                                                                           // 442\n                        chars = token.split(\"\");                                                                    // 443\n                        while (ch = chars.shift()) {                                                                // 444\n                            node = node[CHILDREN][ch] || (node[CHILDREN][ch] = newNode());                          // 445\n                            node[IDS].push(id);                                                                     // 446\n                        }                                                                                           // 447\n                    });                                                                                             // 448\n                });                                                                                                 // 449\n            },                                                                                                      // 450\n            get: function get(ids) {                                                                                // 451\n                var that = this;                                                                                    // 452\n                return _.map(ids, function(id) {                                                                    // 453\n                    return that.datums[id];                                                                         // 454\n                });                                                                                                 // 455\n            },                                                                                                      // 456\n            search: function search(query) {                                                                        // 457\n                var that = this, tokens, matches;                                                                   // 458\n                tokens = normalizeTokens(this.queryTokenizer(query));                                               // 459\n                _.each(tokens, function(token) {                                                                    // 460\n                    var node, chars, ch, ids;                                                                       // 461\n                    if (matches && matches.length === 0) {                                                          // 462\n                        return false;                                                                               // 463\n                    }                                                                                               // 464\n                    node = that.trie;                                                                               // 465\n                    chars = token.split(\"\");                                                                        // 466\n                    while (node && (ch = chars.shift())) {                                                          // 467\n                        node = node[CHILDREN][ch];                                                                  // 468\n                    }                                                                                               // 469\n                    if (node && chars.length === 0) {                                                               // 470\n                        ids = node[IDS].slice(0);                                                                   // 471\n                        matches = matches ? getIntersection(matches, ids) : ids;                                    // 472\n                    } else {                                                                                        // 473\n                        matches = [];                                                                               // 474\n                        return false;                                                                               // 475\n                    }                                                                                               // 476\n                });                                                                                                 // 477\n                return matches ? _.map(unique(matches), function(id) {                                              // 478\n                    return that.datums[id];                                                                         // 479\n                }) : [];                                                                                            // 480\n            },                                                                                                      // 481\n            all: function all() {                                                                                   // 482\n                var values = [];                                                                                    // 483\n                for (var key in this.datums) {                                                                      // 484\n                    values.push(this.datums[key]);                                                                  // 485\n                }                                                                                                   // 486\n                return values;                                                                                      // 487\n            },                                                                                                      // 488\n            reset: function reset() {                                                                               // 489\n                this.datums = {};                                                                                   // 490\n                this.trie = newNode();                                                                              // 491\n            },                                                                                                      // 492\n            serialize: function serialize() {                                                                       // 493\n                return {                                                                                            // 494\n                    datums: this.datums,                                                                            // 495\n                    trie: this.trie                                                                                 // 496\n                };                                                                                                  // 497\n            }                                                                                                       // 498\n        });                                                                                                         // 499\n        return SearchIndex;                                                                                         // 500\n        function normalizeTokens(tokens) {                                                                          // 501\n            tokens = _.filter(tokens, function(token) {                                                             // 502\n                return !!token;                                                                                     // 503\n            });                                                                                                     // 504\n            tokens = _.map(tokens, function(token) {                                                                // 505\n                return token.toLowerCase();                                                                         // 506\n            });                                                                                                     // 507\n            return tokens;                                                                                          // 508\n        }                                                                                                           // 509\n        function newNode() {                                                                                        // 510\n            var node = {};                                                                                          // 511\n            node[IDS] = [];                                                                                         // 512\n            node[CHILDREN] = {};                                                                                    // 513\n            return node;                                                                                            // 514\n        }                                                                                                           // 515\n        function unique(array) {                                                                                    // 516\n            var seen = {}, uniques = [];                                                                            // 517\n            for (var i = 0, len = array.length; i < len; i++) {                                                     // 518\n                if (!seen[array[i]]) {                                                                              // 519\n                    seen[array[i]] = true;                                                                          // 520\n                    uniques.push(array[i]);                                                                         // 521\n                }                                                                                                   // 522\n            }                                                                                                       // 523\n            return uniques;                                                                                         // 524\n        }                                                                                                           // 525\n        function getIntersection(arrayA, arrayB) {                                                                  // 526\n            var ai = 0, bi = 0, intersection = [];                                                                  // 527\n            arrayA = arrayA.sort();                                                                                 // 528\n            arrayB = arrayB.sort();                                                                                 // 529\n            var lenArrayA = arrayA.length, lenArrayB = arrayB.length;                                               // 530\n            while (ai < lenArrayA && bi < lenArrayB) {                                                              // 531\n                if (arrayA[ai] < arrayB[bi]) {                                                                      // 532\n                    ai++;                                                                                           // 533\n                } else if (arrayA[ai] > arrayB[bi]) {                                                               // 534\n                    bi++;                                                                                           // 535\n                } else {                                                                                            // 536\n                    intersection.push(arrayA[ai]);                                                                  // 537\n                    ai++;                                                                                           // 538\n                    bi++;                                                                                           // 539\n                }                                                                                                   // 540\n            }                                                                                                       // 541\n            return intersection;                                                                                    // 542\n        }                                                                                                           // 543\n    }();                                                                                                            // 544\n    var Prefetch = function() {                                                                                     // 545\n        \"use strict\";                                                                                               // 546\n        var keys;                                                                                                   // 547\n        keys = {                                                                                                    // 548\n            data: \"data\",                                                                                           // 549\n            protocol: \"protocol\",                                                                                   // 550\n            thumbprint: \"thumbprint\"                                                                                // 551\n        };                                                                                                          // 552\n        function Prefetch(o) {                                                                                      // 553\n            this.url = o.url;                                                                                       // 554\n            this.ttl = o.ttl;                                                                                       // 555\n            this.cache = o.cache;                                                                                   // 556\n            this.prepare = o.prepare;                                                                               // 557\n            this.transform = o.transform;                                                                           // 558\n            this.transport = o.transport;                                                                           // 559\n            this.thumbprint = o.thumbprint;                                                                         // 560\n            this.storage = new PersistentStorage(o.cacheKey);                                                       // 561\n        }                                                                                                           // 562\n        _.mixin(Prefetch.prototype, {                                                                               // 563\n            _settings: function settings() {                                                                        // 564\n                return {                                                                                            // 565\n                    url: this.url,                                                                                  // 566\n                    type: \"GET\",                                                                                    // 567\n                    dataType: \"json\"                                                                                // 568\n                };                                                                                                  // 569\n            },                                                                                                      // 570\n            store: function store(data) {                                                                           // 571\n                if (!this.cache) {                                                                                  // 572\n                    return;                                                                                         // 573\n                }                                                                                                   // 574\n                this.storage.set(keys.data, data, this.ttl);                                                        // 575\n                this.storage.set(keys.protocol, location.protocol, this.ttl);                                       // 576\n                this.storage.set(keys.thumbprint, this.thumbprint, this.ttl);                                       // 577\n            },                                                                                                      // 578\n            fromCache: function fromCache() {                                                                       // 579\n                var stored = {}, isExpired;                                                                         // 580\n                if (!this.cache) {                                                                                  // 581\n                    return null;                                                                                    // 582\n                }                                                                                                   // 583\n                stored.data = this.storage.get(keys.data);                                                          // 584\n                stored.protocol = this.storage.get(keys.protocol);                                                  // 585\n                stored.thumbprint = this.storage.get(keys.thumbprint);                                              // 586\n                isExpired = stored.thumbprint !== this.thumbprint || stored.protocol !== location.protocol;         // 587\n                return stored.data && !isExpired ? stored.data : null;                                              // 588\n            },                                                                                                      // 589\n            fromNetwork: function(cb) {                                                                             // 590\n                var that = this, settings;                                                                          // 591\n                if (!cb) {                                                                                          // 592\n                    return;                                                                                         // 593\n                }                                                                                                   // 594\n                settings = this.prepare(this._settings());                                                          // 595\n                this.transport(settings).fail(onError).done(onResponse);                                            // 596\n                function onError() {                                                                                // 597\n                    cb(true);                                                                                       // 598\n                }                                                                                                   // 599\n                function onResponse(resp) {                                                                         // 600\n                    cb(null, that.transform(resp));                                                                 // 601\n                }                                                                                                   // 602\n            },                                                                                                      // 603\n            clear: function clear() {                                                                               // 604\n                this.storage.clear();                                                                               // 605\n                return this;                                                                                        // 606\n            }                                                                                                       // 607\n        });                                                                                                         // 608\n        return Prefetch;                                                                                            // 609\n    }();                                                                                                            // 610\n    var Remote = function() {                                                                                       // 611\n        \"use strict\";                                                                                               // 612\n        function Remote(o) {                                                                                        // 613\n            this.url = o.url;                                                                                       // 614\n            this.prepare = o.prepare;                                                                               // 615\n            this.transform = o.transform;                                                                           // 616\n            this.transport = new Transport({                                                                        // 617\n                cache: o.cache,                                                                                     // 618\n                limiter: o.limiter,                                                                                 // 619\n                transport: o.transport                                                                              // 620\n            });                                                                                                     // 621\n        }                                                                                                           // 622\n        _.mixin(Remote.prototype, {                                                                                 // 623\n            _settings: function settings() {                                                                        // 624\n                return {                                                                                            // 625\n                    url: this.url,                                                                                  // 626\n                    type: \"GET\",                                                                                    // 627\n                    dataType: \"json\"                                                                                // 628\n                };                                                                                                  // 629\n            },                                                                                                      // 630\n            get: function get(query, cb) {                                                                          // 631\n                var that = this, settings;                                                                          // 632\n                if (!cb) {                                                                                          // 633\n                    return;                                                                                         // 634\n                }                                                                                                   // 635\n                query = query || \"\";                                                                                // 636\n                settings = this.prepare(query, this._settings());                                                   // 637\n                return this.transport.get(settings, onResponse);                                                    // 638\n                function onResponse(err, resp) {                                                                    // 639\n                    err ? cb([]) : cb(that.transform(resp));                                                        // 640\n                }                                                                                                   // 641\n            },                                                                                                      // 642\n            cancelLastRequest: function cancelLastRequest() {                                                       // 643\n                this.transport.cancel();                                                                            // 644\n            }                                                                                                       // 645\n        });                                                                                                         // 646\n        return Remote;                                                                                              // 647\n    }();                                                                                                            // 648\n    var oParser = function() {                                                                                      // 649\n        \"use strict\";                                                                                               // 650\n        return function parse(o) {                                                                                  // 651\n            var defaults, sorter;                                                                                   // 652\n            defaults = {                                                                                            // 653\n                initialize: true,                                                                                   // 654\n                identify: _.stringify,                                                                              // 655\n                datumTokenizer: null,                                                                               // 656\n                queryTokenizer: null,                                                                               // 657\n                sufficient: 5,                                                                                      // 658\n                sorter: null,                                                                                       // 659\n                local: [],                                                                                          // 660\n                prefetch: null,                                                                                     // 661\n                remote: null                                                                                        // 662\n            };                                                                                                      // 663\n            o = _.mixin(defaults, o || {});                                                                         // 664\n            !o.datumTokenizer && $.error(\"datumTokenizer is required\");                                             // 665\n            !o.queryTokenizer && $.error(\"queryTokenizer is required\");                                             // 666\n            sorter = o.sorter;                                                                                      // 667\n            o.sorter = sorter ? function(x) {                                                                       // 668\n                return x.sort(sorter);                                                                              // 669\n            } : _.identity;                                                                                         // 670\n            o.local = _.isFunction(o.local) ? o.local() : o.local;                                                  // 671\n            o.prefetch = parsePrefetch(o.prefetch);                                                                 // 672\n            o.remote = parseRemote(o.remote);                                                                       // 673\n            return o;                                                                                               // 674\n        };                                                                                                          // 675\n        function parsePrefetch(o) {                                                                                 // 676\n            var defaults;                                                                                           // 677\n            if (!o) {                                                                                               // 678\n                return null;                                                                                        // 679\n            }                                                                                                       // 680\n            defaults = {                                                                                            // 681\n                url: null,                                                                                          // 682\n                ttl: 24 * 60 * 60 * 1e3,                                                                            // 683\n                cache: true,                                                                                        // 684\n                cacheKey: null,                                                                                     // 685\n                thumbprint: \"\",                                                                                     // 686\n                prepare: _.identity,                                                                                // 687\n                transform: _.identity,                                                                              // 688\n                transport: null                                                                                     // 689\n            };                                                                                                      // 690\n            o = _.isString(o) ? {                                                                                   // 691\n                url: o                                                                                              // 692\n            } : o;                                                                                                  // 693\n            o = _.mixin(defaults, o);                                                                               // 694\n            !o.url && $.error(\"prefetch requires url to be set\");                                                   // 695\n            o.transform = o.filter || o.transform;                                                                  // 696\n            o.cacheKey = o.cacheKey || o.url;                                                                       // 697\n            o.thumbprint = VERSION + o.thumbprint;                                                                  // 698\n            o.transport = o.transport ? callbackToDeferred(o.transport) : $.ajax;                                   // 699\n            return o;                                                                                               // 700\n        }                                                                                                           // 701\n        function parseRemote(o) {                                                                                   // 702\n            var defaults;                                                                                           // 703\n            if (!o) {                                                                                               // 704\n                return;                                                                                             // 705\n            }                                                                                                       // 706\n            defaults = {                                                                                            // 707\n                url: null,                                                                                          // 708\n                cache: true,                                                                                        // 709\n                prepare: null,                                                                                      // 710\n                replace: null,                                                                                      // 711\n                wildcard: null,                                                                                     // 712\n                limiter: null,                                                                                      // 713\n                rateLimitBy: \"debounce\",                                                                            // 714\n                rateLimitWait: 300,                                                                                 // 715\n                transform: _.identity,                                                                              // 716\n                transport: null                                                                                     // 717\n            };                                                                                                      // 718\n            o = _.isString(o) ? {                                                                                   // 719\n                url: o                                                                                              // 720\n            } : o;                                                                                                  // 721\n            o = _.mixin(defaults, o);                                                                               // 722\n            !o.url && $.error(\"remote requires url to be set\");                                                     // 723\n            o.transform = o.filter || o.transform;                                                                  // 724\n            o.prepare = toRemotePrepare(o);                                                                         // 725\n            o.limiter = toLimiter(o);                                                                               // 726\n            o.transport = o.transport ? callbackToDeferred(o.transport) : $.ajax;                                   // 727\n            delete o.replace;                                                                                       // 728\n            delete o.wildcard;                                                                                      // 729\n            delete o.rateLimitBy;                                                                                   // 730\n            delete o.rateLimitWait;                                                                                 // 731\n            return o;                                                                                               // 732\n        }                                                                                                           // 733\n        function toRemotePrepare(o) {                                                                               // 734\n            var prepare, replace, wildcard;                                                                         // 735\n            prepare = o.prepare;                                                                                    // 736\n            replace = o.replace;                                                                                    // 737\n            wildcard = o.wildcard;                                                                                  // 738\n            if (prepare) {                                                                                          // 739\n                return prepare;                                                                                     // 740\n            }                                                                                                       // 741\n            if (replace) {                                                                                          // 742\n                prepare = prepareByReplace;                                                                         // 743\n            } else if (o.wildcard) {                                                                                // 744\n                prepare = prepareByWildcard;                                                                        // 745\n            } else {                                                                                                // 746\n                prepare = idenityPrepare;                                                                           // 747\n            }                                                                                                       // 748\n            return prepare;                                                                                         // 749\n            function prepareByReplace(query, settings) {                                                            // 750\n                settings.url = replace(settings.url, query);                                                        // 751\n                return settings;                                                                                    // 752\n            }                                                                                                       // 753\n            function prepareByWildcard(query, settings) {                                                           // 754\n                settings.url = settings.url.replace(wildcard, encodeURIComponent(query));                           // 755\n                return settings;                                                                                    // 756\n            }                                                                                                       // 757\n            function idenityPrepare(query, settings) {                                                              // 758\n                return settings;                                                                                    // 759\n            }                                                                                                       // 760\n        }                                                                                                           // 761\n        function toLimiter(o) {                                                                                     // 762\n            var limiter, method, wait;                                                                              // 763\n            limiter = o.limiter;                                                                                    // 764\n            method = o.rateLimitBy;                                                                                 // 765\n            wait = o.rateLimitWait;                                                                                 // 766\n            if (!limiter) {                                                                                         // 767\n                limiter = /^throttle$/i.test(method) ? throttle(wait) : debounce(wait);                             // 768\n            }                                                                                                       // 769\n            return limiter;                                                                                         // 770\n            function debounce(wait) {                                                                               // 771\n                return function debounce(fn) {                                                                      // 772\n                    return _.debounce(fn, wait);                                                                    // 773\n                };                                                                                                  // 774\n            }                                                                                                       // 775\n            function throttle(wait) {                                                                               // 776\n                return function throttle(fn) {                                                                      // 777\n                    return _.throttle(fn, wait);                                                                    // 778\n                };                                                                                                  // 779\n            }                                                                                                       // 780\n        }                                                                                                           // 781\n        function callbackToDeferred(fn) {                                                                           // 782\n            return function wrapper(o) {                                                                            // 783\n                var deferred = $.Deferred();                                                                        // 784\n                fn(o, onSuccess, onError);                                                                          // 785\n                return deferred;                                                                                    // 786\n                function onSuccess(resp) {                                                                          // 787\n                    _.defer(function() {                                                                            // 788\n                        deferred.resolve(resp);                                                                     // 789\n                    });                                                                                             // 790\n                }                                                                                                   // 791\n                function onError(err) {                                                                             // 792\n                    _.defer(function() {                                                                            // 793\n                        deferred.reject(err);                                                                       // 794\n                    });                                                                                             // 795\n                }                                                                                                   // 796\n            };                                                                                                      // 797\n        }                                                                                                           // 798\n    }();                                                                                                            // 799\n    var Bloodhound = function() {                                                                                   // 800\n        \"use strict\";                                                                                               // 801\n        var old;                                                                                                    // 802\n        old = window && window.Bloodhound;                                                                          // 803\n        function Bloodhound(o) {                                                                                    // 804\n            o = oParser(o);                                                                                         // 805\n            this.sorter = o.sorter;                                                                                 // 806\n            this.identify = o.identify;                                                                             // 807\n            this.sufficient = o.sufficient;                                                                         // 808\n            this.local = o.local;                                                                                   // 809\n            this.remote = o.remote ? new Remote(o.remote) : null;                                                   // 810\n            this.prefetch = o.prefetch ? new Prefetch(o.prefetch) : null;                                           // 811\n            this.index = new SearchIndex({                                                                          // 812\n                identify: this.identify,                                                                            // 813\n                datumTokenizer: o.datumTokenizer,                                                                   // 814\n                queryTokenizer: o.queryTokenizer                                                                    // 815\n            });                                                                                                     // 816\n            o.initialize !== false && this.initialize();                                                            // 817\n        }                                                                                                           // 818\n        Bloodhound.noConflict = function noConflict() {                                                             // 819\n            window && (window.Bloodhound = old);                                                                    // 820\n            return Bloodhound;                                                                                      // 821\n        };                                                                                                          // 822\n        Bloodhound.tokenizers = tokenizers;                                                                         // 823\n        _.mixin(Bloodhound.prototype, {                                                                             // 824\n            __ttAdapter: function ttAdapter() {                                                                     // 825\n                var that = this;                                                                                    // 826\n                return this.remote ? withAsync : withoutAsync;                                                      // 827\n                function withAsync(query, sync, async) {                                                            // 828\n                    return that.search(query, sync, async);                                                         // 829\n                }                                                                                                   // 830\n                function withoutAsync(query, sync) {                                                                // 831\n                    return that.search(query, sync);                                                                // 832\n                }                                                                                                   // 833\n            },                                                                                                      // 834\n            _loadPrefetch: function loadPrefetch() {                                                                // 835\n                var that = this, deferred, serialized;                                                              // 836\n                deferred = $.Deferred();                                                                            // 837\n                if (!this.prefetch) {                                                                               // 838\n                    deferred.resolve();                                                                             // 839\n                } else if (serialized = this.prefetch.fromCache()) {                                                // 840\n                    this.index.bootstrap(serialized);                                                               // 841\n                    deferred.resolve();                                                                             // 842\n                } else {                                                                                            // 843\n                    this.prefetch.fromNetwork(done);                                                                // 844\n                }                                                                                                   // 845\n                return deferred.promise();                                                                          // 846\n                function done(err, data) {                                                                          // 847\n                    if (err) {                                                                                      // 848\n                        return deferred.reject();                                                                   // 849\n                    }                                                                                               // 850\n                    that.add(data);                                                                                 // 851\n                    that.prefetch.store(that.index.serialize());                                                    // 852\n                    deferred.resolve();                                                                             // 853\n                }                                                                                                   // 854\n            },                                                                                                      // 855\n            _initialize: function initialize() {                                                                    // 856\n                var that = this, deferred;                                                                          // 857\n                this.clear();                                                                                       // 858\n                (this.initPromise = this._loadPrefetch()).done(addLocalToIndex);                                    // 859\n                return this.initPromise;                                                                            // 860\n                function addLocalToIndex() {                                                                        // 861\n                    that.add(that.local);                                                                           // 862\n                }                                                                                                   // 863\n            },                                                                                                      // 864\n            initialize: function initialize(force) {                                                                // 865\n                return !this.initPromise || force ? this._initialize() : this.initPromise;                          // 866\n            },                                                                                                      // 867\n            add: function add(data) {                                                                               // 868\n                this.index.add(data);                                                                               // 869\n                return this;                                                                                        // 870\n            },                                                                                                      // 871\n            get: function get(ids) {                                                                                // 872\n                ids = _.isArray(ids) ? ids : [].slice.call(arguments);                                              // 873\n                return this.index.get(ids);                                                                         // 874\n            },                                                                                                      // 875\n            search: function search(query, sync, async) {                                                           // 876\n                var that = this, local;                                                                             // 877\n                local = this.sorter(this.index.search(query));                                                      // 878\n                sync(this.remote ? local.slice() : local);                                                          // 879\n                if (this.remote && local.length < this.sufficient) {                                                // 880\n                    this.remote.get(query, processRemote);                                                          // 881\n                } else if (this.remote) {                                                                           // 882\n                    this.remote.cancelLastRequest();                                                                // 883\n                }                                                                                                   // 884\n                return this;                                                                                        // 885\n                function processRemote(remote) {                                                                    // 886\n                    var nonDuplicates = [];                                                                         // 887\n                    _.each(remote, function(r) {                                                                    // 888\n                        !_.some(local, function(l) {                                                                // 889\n                            return that.identify(r) === that.identify(l);                                           // 890\n                        }) && nonDuplicates.push(r);                                                                // 891\n                    });                                                                                             // 892\n                    async && async(nonDuplicates);                                                                  // 893\n                }                                                                                                   // 894\n            },                                                                                                      // 895\n            all: function all() {                                                                                   // 896\n                return this.index.all();                                                                            // 897\n            },                                                                                                      // 898\n            clear: function clear() {                                                                               // 899\n                this.index.reset();                                                                                 // 900\n                return this;                                                                                        // 901\n            },                                                                                                      // 902\n            clearPrefetchCache: function clearPrefetchCache() {                                                     // 903\n                this.prefetch && this.prefetch.clear();                                                             // 904\n                return this;                                                                                        // 905\n            },                                                                                                      // 906\n            clearRemoteCache: function clearRemoteCache() {                                                         // 907\n                Transport.resetCache();                                                                             // 908\n                return this;                                                                                        // 909\n            },                                                                                                      // 910\n            ttAdapter: function ttAdapter() {                                                                       // 911\n                return this.__ttAdapter();                                                                          // 912\n            }                                                                                                       // 913\n        });                                                                                                         // 914\n        return Bloodhound;                                                                                          // 915\n    }();                                                                                                            // 916\n    return Bloodhound;                                                                                              // 917\n});                                                                                                                 // 918\n                                                                                                                    // 919\n(function(root, factory) {                                                                                          // 920\n    if (typeof define === \"function\" && define.amd) {                                                               // 921\n        define(\"typeahead.js\", [ \"jquery\" ], function(a0) {                                                         // 922\n            return factory(a0);                                                                                     // 923\n        });                                                                                                         // 924\n    } else if (typeof exports === \"object\") {                                                                       // 925\n        module.exports = factory(require(\"jquery\"));                                                                // 926\n    } else {                                                                                                        // 927\n        factory(jQuery);                                                                                            // 928\n    }                                                                                                               // 929\n})(this, function($) {                                                                                              // 930\n    var _ = function() {                                                                                            // 931\n        \"use strict\";                                                                                               // 932\n        return {                                                                                                    // 933\n            isMsie: function() {                                                                                    // 934\n                return /(msie|trident)/i.test(navigator.userAgent) ? navigator.userAgent.match(/(msie |rv:)(\\d+(.\\d+)?)/i)[2] : false;\n            },                                                                                                      // 936\n            isBlankString: function(str) {                                                                          // 937\n                return !str || /^\\s*$/.test(str);                                                                   // 938\n            },                                                                                                      // 939\n            escapeRegExChars: function(str) {                                                                       // 940\n                return str.replace(/[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g, \"\\\\$&\");                                  // 941\n            },                                                                                                      // 942\n            isString: function(obj) {                                                                               // 943\n                return typeof obj === \"string\";                                                                     // 944\n            },                                                                                                      // 945\n            isNumber: function(obj) {                                                                               // 946\n                return typeof obj === \"number\";                                                                     // 947\n            },                                                                                                      // 948\n            isArray: $.isArray,                                                                                     // 949\n            isFunction: $.isFunction,                                                                               // 950\n            isObject: $.isPlainObject,                                                                              // 951\n            isUndefined: function(obj) {                                                                            // 952\n                return typeof obj === \"undefined\";                                                                  // 953\n            },                                                                                                      // 954\n            isElement: function(obj) {                                                                              // 955\n                return !!(obj && obj.nodeType === 1);                                                               // 956\n            },                                                                                                      // 957\n            isJQuery: function(obj) {                                                                               // 958\n                return obj instanceof $;                                                                            // 959\n            },                                                                                                      // 960\n            toStr: function toStr(s) {                                                                              // 961\n                return _.isUndefined(s) || s === null ? \"\" : s + \"\";                                                // 962\n            },                                                                                                      // 963\n            bind: $.proxy,                                                                                          // 964\n            each: function(collection, cb) {                                                                        // 965\n                $.each(collection, reverseArgs);                                                                    // 966\n                function reverseArgs(index, value) {                                                                // 967\n                    return cb(value, index);                                                                        // 968\n                }                                                                                                   // 969\n            },                                                                                                      // 970\n            map: $.map,                                                                                             // 971\n            filter: $.grep,                                                                                         // 972\n            every: function(obj, test) {                                                                            // 973\n                var result = true;                                                                                  // 974\n                if (!obj) {                                                                                         // 975\n                    return result;                                                                                  // 976\n                }                                                                                                   // 977\n                $.each(obj, function(key, val) {                                                                    // 978\n                    if (!(result = test.call(null, val, key, obj))) {                                               // 979\n                        return false;                                                                               // 980\n                    }                                                                                               // 981\n                });                                                                                                 // 982\n                return !!result;                                                                                    // 983\n            },                                                                                                      // 984\n            some: function(obj, test) {                                                                             // 985\n                var result = false;                                                                                 // 986\n                if (!obj) {                                                                                         // 987\n                    return result;                                                                                  // 988\n                }                                                                                                   // 989\n                $.each(obj, function(key, val) {                                                                    // 990\n                    if (result = test.call(null, val, key, obj)) {                                                  // 991\n                        return false;                                                                               // 992\n                    }                                                                                               // 993\n                });                                                                                                 // 994\n                return !!result;                                                                                    // 995\n            },                                                                                                      // 996\n            mixin: $.extend,                                                                                        // 997\n            identity: function(x) {                                                                                 // 998\n                return x;                                                                                           // 999\n            },                                                                                                      // 1000\n            clone: function(obj) {                                                                                  // 1001\n                return $.extend(true, {}, obj);                                                                     // 1002\n            },                                                                                                      // 1003\n            getIdGenerator: function() {                                                                            // 1004\n                var counter = 0;                                                                                    // 1005\n                return function() {                                                                                 // 1006\n                    return counter++;                                                                               // 1007\n                };                                                                                                  // 1008\n            },                                                                                                      // 1009\n            templatify: function templatify(obj) {                                                                  // 1010\n                return $.isFunction(obj) ? obj : template;                                                          // 1011\n                function template() {                                                                               // 1012\n                    return String(obj);                                                                             // 1013\n                }                                                                                                   // 1014\n            },                                                                                                      // 1015\n            defer: function(fn) {                                                                                   // 1016\n                setTimeout(fn, 0);                                                                                  // 1017\n            },                                                                                                      // 1018\n            debounce: function(func, wait, immediate) {                                                             // 1019\n                var timeout, result;                                                                                // 1020\n                return function() {                                                                                 // 1021\n                    var context = this, args = arguments, later, callNow;                                           // 1022\n                    later = function() {                                                                            // 1023\n                        timeout = null;                                                                             // 1024\n                        if (!immediate) {                                                                           // 1025\n                            result = func.apply(context, args);                                                     // 1026\n                        }                                                                                           // 1027\n                    };                                                                                              // 1028\n                    callNow = immediate && !timeout;                                                                // 1029\n                    clearTimeout(timeout);                                                                          // 1030\n                    timeout = setTimeout(later, wait);                                                              // 1031\n                    if (callNow) {                                                                                  // 1032\n                        result = func.apply(context, args);                                                         // 1033\n                    }                                                                                               // 1034\n                    return result;                                                                                  // 1035\n                };                                                                                                  // 1036\n            },                                                                                                      // 1037\n            throttle: function(func, wait) {                                                                        // 1038\n                var context, args, timeout, result, previous, later;                                                // 1039\n                previous = 0;                                                                                       // 1040\n                later = function() {                                                                                // 1041\n                    previous = new Date();                                                                          // 1042\n                    timeout = null;                                                                                 // 1043\n                    result = func.apply(context, args);                                                             // 1044\n                };                                                                                                  // 1045\n                return function() {                                                                                 // 1046\n                    var now = new Date(), remaining = wait - (now - previous);                                      // 1047\n                    context = this;                                                                                 // 1048\n                    args = arguments;                                                                               // 1049\n                    if (remaining <= 0) {                                                                           // 1050\n                        clearTimeout(timeout);                                                                      // 1051\n                        timeout = null;                                                                             // 1052\n                        previous = now;                                                                             // 1053\n                        result = func.apply(context, args);                                                         // 1054\n                    } else if (!timeout) {                                                                          // 1055\n                        timeout = setTimeout(later, remaining);                                                     // 1056\n                    }                                                                                               // 1057\n                    return result;                                                                                  // 1058\n                };                                                                                                  // 1059\n            },                                                                                                      // 1060\n            stringify: function(val) {                                                                              // 1061\n                return _.isString(val) ? val : JSON.stringify(val);                                                 // 1062\n            },                                                                                                      // 1063\n            noop: function() {}                                                                                     // 1064\n        };                                                                                                          // 1065\n    }();                                                                                                            // 1066\n    var WWW = function() {                                                                                          // 1067\n        \"use strict\";                                                                                               // 1068\n        var defaultClassNames = {                                                                                   // 1069\n            wrapper: \"twitter-typeahead\",                                                                           // 1070\n            input: \"tt-input\",                                                                                      // 1071\n            hint: \"tt-hint\",                                                                                        // 1072\n            menu: \"tt-menu\",                                                                                        // 1073\n            dataset: \"tt-dataset\",                                                                                  // 1074\n            suggestion: \"tt-suggestion\",                                                                            // 1075\n            selectable: \"tt-selectable\",                                                                            // 1076\n            empty: \"tt-empty\",                                                                                      // 1077\n            open: \"tt-open\",                                                                                        // 1078\n            cursor: \"tt-cursor\",                                                                                    // 1079\n            highlight: \"tt-highlight\"                                                                               // 1080\n        };                                                                                                          // 1081\n        return build;                                                                                               // 1082\n        function build(o) {                                                                                         // 1083\n            var www, classes;                                                                                       // 1084\n            classes = _.mixin({}, defaultClassNames, o);                                                            // 1085\n            www = {                                                                                                 // 1086\n                css: buildCss(),                                                                                    // 1087\n                classes: classes,                                                                                   // 1088\n                html: buildHtml(classes),                                                                           // 1089\n                selectors: buildSelectors(classes)                                                                  // 1090\n            };                                                                                                      // 1091\n            return {                                                                                                // 1092\n                css: www.css,                                                                                       // 1093\n                html: www.html,                                                                                     // 1094\n                classes: www.classes,                                                                               // 1095\n                selectors: www.selectors,                                                                           // 1096\n                mixin: function(o) {                                                                                // 1097\n                    _.mixin(o, www);                                                                                // 1098\n                }                                                                                                   // 1099\n            };                                                                                                      // 1100\n        }                                                                                                           // 1101\n        function buildHtml(c) {                                                                                     // 1102\n            return {                                                                                                // 1103\n                wrapper: '<span class=\"' + c.wrapper + '\"></span>',                                                 // 1104\n                menu: '<div class=\"' + c.menu + '\"></div>'                                                          // 1105\n            };                                                                                                      // 1106\n        }                                                                                                           // 1107\n        function buildSelectors(classes) {                                                                          // 1108\n            var selectors = {};                                                                                     // 1109\n            _.each(classes, function(v, k) {                                                                        // 1110\n                selectors[k] = \".\" + v;                                                                             // 1111\n            });                                                                                                     // 1112\n            return selectors;                                                                                       // 1113\n        }                                                                                                           // 1114\n        function buildCss() {                                                                                       // 1115\n            var css = {                                                                                             // 1116\n                wrapper: {                                                                                          // 1117\n                    position: \"relative\",                                                                           // 1118\n                    display: \"inline-block\"                                                                         // 1119\n                },                                                                                                  // 1120\n                hint: {                                                                                             // 1121\n                    position: \"absolute\",                                                                           // 1122\n                    top: \"0\",                                                                                       // 1123\n                    left: \"0\",                                                                                      // 1124\n                    borderColor: \"transparent\",                                                                     // 1125\n                    boxShadow: \"none\",                                                                              // 1126\n                    opacity: \"1\"                                                                                    // 1127\n                },                                                                                                  // 1128\n                input: {                                                                                            // 1129\n                    position: \"relative\",                                                                           // 1130\n                    verticalAlign: \"top\",                                                                           // 1131\n                    backgroundColor: \"transparent\"                                                                  // 1132\n                },                                                                                                  // 1133\n                inputWithNoHint: {                                                                                  // 1134\n                    position: \"relative\",                                                                           // 1135\n                    verticalAlign: \"top\"                                                                            // 1136\n                },                                                                                                  // 1137\n                menu: {                                                                                             // 1138\n                    position: \"absolute\",                                                                           // 1139\n                    top: \"100%\",                                                                                    // 1140\n                    left: \"0\",                                                                                      // 1141\n                    zIndex: \"100\",                                                                                  // 1142\n                    display: \"none\"                                                                                 // 1143\n                },                                                                                                  // 1144\n                ltr: {                                                                                              // 1145\n                    left: \"0\",                                                                                      // 1146\n                    right: \"auto\"                                                                                   // 1147\n                },                                                                                                  // 1148\n                rtl: {                                                                                              // 1149\n                    left: \"auto\",                                                                                   // 1150\n                    right: \" 0\"                                                                                     // 1151\n                }                                                                                                   // 1152\n            };                                                                                                      // 1153\n            if (_.isMsie()) {                                                                                       // 1154\n                _.mixin(css.input, {                                                                                // 1155\n                    backgroundImage: \"url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)\"\n                });                                                                                                 // 1157\n            }                                                                                                       // 1158\n            return css;                                                                                             // 1159\n        }                                                                                                           // 1160\n    }();                                                                                                            // 1161\n    var EventBus = function() {                                                                                     // 1162\n        \"use strict\";                                                                                               // 1163\n        var namespace, deprecationMap;                                                                              // 1164\n        namespace = \"typeahead:\";                                                                                   // 1165\n        deprecationMap = {                                                                                          // 1166\n            render: \"rendered\",                                                                                     // 1167\n            cursorchange: \"cursorchanged\",                                                                          // 1168\n            select: \"selected\",                                                                                     // 1169\n            autocomplete: \"autocompleted\"                                                                           // 1170\n        };                                                                                                          // 1171\n        function EventBus(o) {                                                                                      // 1172\n            if (!o || !o.el) {                                                                                      // 1173\n                $.error(\"EventBus initialized without el\");                                                         // 1174\n            }                                                                                                       // 1175\n            this.$el = $(o.el);                                                                                     // 1176\n        }                                                                                                           // 1177\n        _.mixin(EventBus.prototype, {                                                                               // 1178\n            _trigger: function(type, args) {                                                                        // 1179\n                var $e;                                                                                             // 1180\n                $e = $.Event(namespace + type);                                                                     // 1181\n                (args = args || []).unshift($e);                                                                    // 1182\n                this.$el.trigger.apply(this.$el, args);                                                             // 1183\n                return $e;                                                                                          // 1184\n            },                                                                                                      // 1185\n            before: function(type) {                                                                                // 1186\n                var args, $e;                                                                                       // 1187\n                args = [].slice.call(arguments, 1);                                                                 // 1188\n                $e = this._trigger(\"before\" + type, args);                                                          // 1189\n                return $e.isDefaultPrevented();                                                                     // 1190\n            },                                                                                                      // 1191\n            trigger: function(type) {                                                                               // 1192\n                var deprecatedType;                                                                                 // 1193\n                this._trigger(type, [].slice.call(arguments, 1));                                                   // 1194\n                if (deprecatedType = deprecationMap[type]) {                                                        // 1195\n                    this._trigger(deprecatedType, [].slice.call(arguments, 1));                                     // 1196\n                }                                                                                                   // 1197\n            }                                                                                                       // 1198\n        });                                                                                                         // 1199\n        return EventBus;                                                                                            // 1200\n    }();                                                                                                            // 1201\n    var EventEmitter = function() {                                                                                 // 1202\n        \"use strict\";                                                                                               // 1203\n        var splitter = /\\s+/, nextTick = getNextTick();                                                             // 1204\n        return {                                                                                                    // 1205\n            onSync: onSync,                                                                                         // 1206\n            onAsync: onAsync,                                                                                       // 1207\n            off: off,                                                                                               // 1208\n            trigger: trigger                                                                                        // 1209\n        };                                                                                                          // 1210\n        function on(method, types, cb, context) {                                                                   // 1211\n            var type;                                                                                               // 1212\n            if (!cb) {                                                                                              // 1213\n                return this;                                                                                        // 1214\n            }                                                                                                       // 1215\n            types = types.split(splitter);                                                                          // 1216\n            cb = context ? bindContext(cb, context) : cb;                                                           // 1217\n            this._callbacks = this._callbacks || {};                                                                // 1218\n            while (type = types.shift()) {                                                                          // 1219\n                this._callbacks[type] = this._callbacks[type] || {                                                  // 1220\n                    sync: [],                                                                                       // 1221\n                    async: []                                                                                       // 1222\n                };                                                                                                  // 1223\n                this._callbacks[type][method].push(cb);                                                             // 1224\n            }                                                                                                       // 1225\n            return this;                                                                                            // 1226\n        }                                                                                                           // 1227\n        function onAsync(types, cb, context) {                                                                      // 1228\n            return on.call(this, \"async\", types, cb, context);                                                      // 1229\n        }                                                                                                           // 1230\n        function onSync(types, cb, context) {                                                                       // 1231\n            return on.call(this, \"sync\", types, cb, context);                                                       // 1232\n        }                                                                                                           // 1233\n        function off(types) {                                                                                       // 1234\n            var type;                                                                                               // 1235\n            if (!this._callbacks) {                                                                                 // 1236\n                return this;                                                                                        // 1237\n            }                                                                                                       // 1238\n            types = types.split(splitter);                                                                          // 1239\n            while (type = types.shift()) {                                                                          // 1240\n                delete this._callbacks[type];                                                                       // 1241\n            }                                                                                                       // 1242\n            return this;                                                                                            // 1243\n        }                                                                                                           // 1244\n        function trigger(types) {                                                                                   // 1245\n            var type, callbacks, args, syncFlush, asyncFlush;                                                       // 1246\n            if (!this._callbacks) {                                                                                 // 1247\n                return this;                                                                                        // 1248\n            }                                                                                                       // 1249\n            types = types.split(splitter);                                                                          // 1250\n            args = [].slice.call(arguments, 1);                                                                     // 1251\n            while ((type = types.shift()) && (callbacks = this._callbacks[type])) {                                 // 1252\n                syncFlush = getFlush(callbacks.sync, this, [ type ].concat(args));                                  // 1253\n                asyncFlush = getFlush(callbacks.async, this, [ type ].concat(args));                                // 1254\n                syncFlush() && nextTick(asyncFlush);                                                                // 1255\n            }                                                                                                       // 1256\n            return this;                                                                                            // 1257\n        }                                                                                                           // 1258\n        function getFlush(callbacks, context, args) {                                                               // 1259\n            return flush;                                                                                           // 1260\n            function flush() {                                                                                      // 1261\n                var cancelled;                                                                                      // 1262\n                for (var i = 0, len = callbacks.length; !cancelled && i < len; i += 1) {                            // 1263\n                    cancelled = callbacks[i].apply(context, args) === false;                                        // 1264\n                }                                                                                                   // 1265\n                return !cancelled;                                                                                  // 1266\n            }                                                                                                       // 1267\n        }                                                                                                           // 1268\n        function getNextTick() {                                                                                    // 1269\n            var nextTickFn;                                                                                         // 1270\n            if (window.setImmediate) {                                                                              // 1271\n                nextTickFn = function nextTickSetImmediate(fn) {                                                    // 1272\n                    setImmediate(function() {                                                                       // 1273\n                        fn();                                                                                       // 1274\n                    });                                                                                             // 1275\n                };                                                                                                  // 1276\n            } else {                                                                                                // 1277\n                nextTickFn = function nextTickSetTimeout(fn) {                                                      // 1278\n                    setTimeout(function() {                                                                         // 1279\n                        fn();                                                                                       // 1280\n                    }, 0);                                                                                          // 1281\n                };                                                                                                  // 1282\n            }                                                                                                       // 1283\n            return nextTickFn;                                                                                      // 1284\n        }                                                                                                           // 1285\n        function bindContext(fn, context) {                                                                         // 1286\n            return fn.bind ? fn.bind(context) : function() {                                                        // 1287\n                fn.apply(context, [].slice.call(arguments, 0));                                                     // 1288\n            };                                                                                                      // 1289\n        }                                                                                                           // 1290\n    }();                                                                                                            // 1291\n    var highlight = function(doc) {                                                                                 // 1292\n        \"use strict\";                                                                                               // 1293\n        var defaults = {                                                                                            // 1294\n            node: null,                                                                                             // 1295\n            pattern: null,                                                                                          // 1296\n            tagName: \"strong\",                                                                                      // 1297\n            className: null,                                                                                        // 1298\n            wordsOnly: false,                                                                                       // 1299\n            caseSensitive: false                                                                                    // 1300\n        };                                                                                                          // 1301\n        return function hightlight(o) {                                                                             // 1302\n            var regex;                                                                                              // 1303\n            o = _.mixin({}, defaults, o);                                                                           // 1304\n            if (!o.node || !o.pattern) {                                                                            // 1305\n                return;                                                                                             // 1306\n            }                                                                                                       // 1307\n            o.pattern = _.isArray(o.pattern) ? o.pattern : [ o.pattern ];                                           // 1308\n            regex = getRegex(o.pattern, o.caseSensitive, o.wordsOnly);                                              // 1309\n            traverse(o.node, hightlightTextNode);                                                                   // 1310\n            function hightlightTextNode(textNode) {                                                                 // 1311\n                var match, patternNode, wrapperNode;                                                                // 1312\n                if (match = regex.exec(textNode.data)) {                                                            // 1313\n                    wrapperNode = doc.createElement(o.tagName);                                                     // 1314\n                    o.className && (wrapperNode.className = o.className);                                           // 1315\n                    patternNode = textNode.splitText(match.index);                                                  // 1316\n                    patternNode.splitText(match[0].length);                                                         // 1317\n                    wrapperNode.appendChild(patternNode.cloneNode(true));                                           // 1318\n                    textNode.parentNode.replaceChild(wrapperNode, patternNode);                                     // 1319\n                }                                                                                                   // 1320\n                return !!match;                                                                                     // 1321\n            }                                                                                                       // 1322\n            function traverse(el, hightlightTextNode) {                                                             // 1323\n                var childNode, TEXT_NODE_TYPE = 3;                                                                  // 1324\n                for (var i = 0; i < el.childNodes.length; i++) {                                                    // 1325\n                    childNode = el.childNodes[i];                                                                   // 1326\n                    if (childNode.nodeType === TEXT_NODE_TYPE) {                                                    // 1327\n                        i += hightlightTextNode(childNode) ? 1 : 0;                                                 // 1328\n                    } else {                                                                                        // 1329\n                        traverse(childNode, hightlightTextNode);                                                    // 1330\n                    }                                                                                               // 1331\n                }                                                                                                   // 1332\n            }                                                                                                       // 1333\n        };                                                                                                          // 1334\n        function getRegex(patterns, caseSensitive, wordsOnly) {                                                     // 1335\n            var escapedPatterns = [], regexStr;                                                                     // 1336\n            for (var i = 0, len = patterns.length; i < len; i++) {                                                  // 1337\n                escapedPatterns.push(_.escapeRegExChars(patterns[i]));                                              // 1338\n            }                                                                                                       // 1339\n            regexStr = wordsOnly ? \"\\\\b(\" + escapedPatterns.join(\"|\") + \")\\\\b\" : \"(\" + escapedPatterns.join(\"|\") + \")\";\n            return caseSensitive ? new RegExp(regexStr) : new RegExp(regexStr, \"i\");                                // 1341\n        }                                                                                                           // 1342\n    }(window.document);                                                                                             // 1343\n    var Input = function() {                                                                                        // 1344\n        \"use strict\";                                                                                               // 1345\n        var specialKeyCodeMap;                                                                                      // 1346\n        specialKeyCodeMap = {                                                                                       // 1347\n            9: \"tab\",                                                                                               // 1348\n            27: \"esc\",                                                                                              // 1349\n            37: \"left\",                                                                                             // 1350\n            39: \"right\",                                                                                            // 1351\n            13: \"enter\",                                                                                            // 1352\n            38: \"up\",                                                                                               // 1353\n            40: \"down\"                                                                                              // 1354\n        };                                                                                                          // 1355\n        function Input(o, www) {                                                                                    // 1356\n            o = o || {};                                                                                            // 1357\n            if (!o.input) {                                                                                         // 1358\n                $.error(\"input is missing\");                                                                        // 1359\n            }                                                                                                       // 1360\n            www.mixin(this);                                                                                        // 1361\n            this.$hint = $(o.hint);                                                                                 // 1362\n            this.$input = $(o.input);                                                                               // 1363\n            this.query = this.$input.val();                                                                         // 1364\n            this.queryWhenFocused = this.hasFocus() ? this.query : null;                                            // 1365\n            this.$overflowHelper = buildOverflowHelper(this.$input);                                                // 1366\n            this._checkLanguageDirection();                                                                         // 1367\n            if (this.$hint.length === 0) {                                                                          // 1368\n                this.setHint = this.getHint = this.clearHint = this.clearHintIfInvalid = _.noop;                    // 1369\n            }                                                                                                       // 1370\n        }                                                                                                           // 1371\n        Input.normalizeQuery = function(str) {                                                                      // 1372\n            return _.toStr(str).replace(/^\\s*/g, \"\").replace(/\\s{2,}/g, \" \");                                       // 1373\n        };                                                                                                          // 1374\n        _.mixin(Input.prototype, EventEmitter, {                                                                    // 1375\n            _onBlur: function onBlur() {                                                                            // 1376\n                this.resetInputValue();                                                                             // 1377\n                this.trigger(\"blurred\");                                                                            // 1378\n            },                                                                                                      // 1379\n            _onFocus: function onFocus() {                                                                          // 1380\n                this.queryWhenFocused = this.query;                                                                 // 1381\n                this.trigger(\"focused\");                                                                            // 1382\n            },                                                                                                      // 1383\n            _onKeydown: function onKeydown($e) {                                                                    // 1384\n                var keyName = specialKeyCodeMap[$e.which || $e.keyCode];                                            // 1385\n                this._managePreventDefault(keyName, $e);                                                            // 1386\n                if (keyName && this._shouldTrigger(keyName, $e)) {                                                  // 1387\n                    this.trigger(keyName + \"Keyed\", $e);                                                            // 1388\n                }                                                                                                   // 1389\n            },                                                                                                      // 1390\n            _onInput: function onInput() {                                                                          // 1391\n                this._setQuery(this.getInputValue());                                                               // 1392\n                this.clearHintIfInvalid();                                                                          // 1393\n                this._checkLanguageDirection();                                                                     // 1394\n            },                                                                                                      // 1395\n            _managePreventDefault: function managePreventDefault(keyName, $e) {                                     // 1396\n                var preventDefault;                                                                                 // 1397\n                switch (keyName) {                                                                                  // 1398\n                  case \"up\":                                                                                        // 1399\n                  case \"down\":                                                                                      // 1400\n                    preventDefault = !withModifier($e);                                                             // 1401\n                    break;                                                                                          // 1402\n                                                                                                                    // 1403\n                  default:                                                                                          // 1404\n                    preventDefault = false;                                                                         // 1405\n                }                                                                                                   // 1406\n                preventDefault && $e.preventDefault();                                                              // 1407\n            },                                                                                                      // 1408\n            _shouldTrigger: function shouldTrigger(keyName, $e) {                                                   // 1409\n                var trigger;                                                                                        // 1410\n                switch (keyName) {                                                                                  // 1411\n                  case \"tab\":                                                                                       // 1412\n                    trigger = !withModifier($e);                                                                    // 1413\n                    break;                                                                                          // 1414\n                                                                                                                    // 1415\n                  default:                                                                                          // 1416\n                    trigger = true;                                                                                 // 1417\n                }                                                                                                   // 1418\n                return trigger;                                                                                     // 1419\n            },                                                                                                      // 1420\n            _checkLanguageDirection: function checkLanguageDirection() {                                            // 1421\n                var dir = (this.$input.css(\"direction\") || \"ltr\").toLowerCase();                                    // 1422\n                if (this.dir !== dir) {                                                                             // 1423\n                    this.dir = dir;                                                                                 // 1424\n                    this.$hint.attr(\"dir\", dir);                                                                    // 1425\n                    this.trigger(\"langDirChanged\", dir);                                                            // 1426\n                }                                                                                                   // 1427\n            },                                                                                                      // 1428\n            _setQuery: function setQuery(val, silent) {                                                             // 1429\n                var areEquivalent, hasDifferentWhitespace;                                                          // 1430\n                areEquivalent = areQueriesEquivalent(val, this.query);                                              // 1431\n                hasDifferentWhitespace = areEquivalent ? this.query.length !== val.length : false;                  // 1432\n                this.query = val;                                                                                   // 1433\n                if (!silent && !areEquivalent) {                                                                    // 1434\n                    this.trigger(\"queryChanged\", this.query);                                                       // 1435\n                } else if (!silent && hasDifferentWhitespace) {                                                     // 1436\n                    this.trigger(\"whitespaceChanged\", this.query);                                                  // 1437\n                }                                                                                                   // 1438\n            },                                                                                                      // 1439\n            bind: function() {                                                                                      // 1440\n                var that = this, onBlur, onFocus, onKeydown, onInput;                                               // 1441\n                onBlur = _.bind(this._onBlur, this);                                                                // 1442\n                onFocus = _.bind(this._onFocus, this);                                                              // 1443\n                onKeydown = _.bind(this._onKeydown, this);                                                          // 1444\n                onInput = _.bind(this._onInput, this);                                                              // 1445\n                this.$input.on(\"blur.tt\", onBlur).on(\"focus.tt\", onFocus).on(\"keydown.tt\", onKeydown);              // 1446\n                if (!_.isMsie() || _.isMsie() > 9) {                                                                // 1447\n                    this.$input.on(\"input.tt\", onInput);                                                            // 1448\n                } else {                                                                                            // 1449\n                    this.$input.on(\"keydown.tt keypress.tt cut.tt paste.tt\", function($e) {                         // 1450\n                        if (specialKeyCodeMap[$e.which || $e.keyCode]) {                                            // 1451\n                            return;                                                                                 // 1452\n                        }                                                                                           // 1453\n                        _.defer(_.bind(that._onInput, that, $e));                                                   // 1454\n                    });                                                                                             // 1455\n                }                                                                                                   // 1456\n                return this;                                                                                        // 1457\n            },                                                                                                      // 1458\n            focus: function focus() {                                                                               // 1459\n                this.$input.focus();                                                                                // 1460\n            },                                                                                                      // 1461\n            blur: function blur() {                                                                                 // 1462\n                this.$input.blur();                                                                                 // 1463\n            },                                                                                                      // 1464\n            getLangDir: function getLangDir() {                                                                     // 1465\n                return this.dir;                                                                                    // 1466\n            },                                                                                                      // 1467\n            getQuery: function getQuery() {                                                                         // 1468\n                return this.query || \"\";                                                                            // 1469\n            },                                                                                                      // 1470\n            setQuery: function setQuery(val, silent) {                                                              // 1471\n                this.setInputValue(val);                                                                            // 1472\n                this._setQuery(val, silent);                                                                        // 1473\n            },                                                                                                      // 1474\n            hasQueryChangedSinceLastFocus: function hasQueryChangedSinceLastFocus() {                               // 1475\n                return this.query !== this.queryWhenFocused;                                                        // 1476\n            },                                                                                                      // 1477\n            getInputValue: function getInputValue() {                                                               // 1478\n                return this.$input.val();                                                                           // 1479\n            },                                                                                                      // 1480\n            setInputValue: function setInputValue(value) {                                                          // 1481\n                this.$input.val(value);                                                                             // 1482\n                this.clearHintIfInvalid();                                                                          // 1483\n                this._checkLanguageDirection();                                                                     // 1484\n            },                                                                                                      // 1485\n            resetInputValue: function resetInputValue() {                                                           // 1486\n                this.setInputValue(this.query);                                                                     // 1487\n            },                                                                                                      // 1488\n            getHint: function getHint() {                                                                           // 1489\n                return this.$hint.val();                                                                            // 1490\n            },                                                                                                      // 1491\n            setHint: function setHint(value) {                                                                      // 1492\n                this.$hint.val(value);                                                                              // 1493\n            },                                                                                                      // 1494\n            clearHint: function clearHint() {                                                                       // 1495\n                this.setHint(\"\");                                                                                   // 1496\n            },                                                                                                      // 1497\n            clearHintIfInvalid: function clearHintIfInvalid() {                                                     // 1498\n                var val, hint, valIsPrefixOfHint, isValid;                                                          // 1499\n                val = this.getInputValue();                                                                         // 1500\n                hint = this.getHint();                                                                              // 1501\n                valIsPrefixOfHint = val !== hint && hint.indexOf(val) === 0;                                        // 1502\n                isValid = val !== \"\" && valIsPrefixOfHint && !this.hasOverflow();                                   // 1503\n                !isValid && this.clearHint();                                                                       // 1504\n            },                                                                                                      // 1505\n            hasFocus: function hasFocus() {                                                                         // 1506\n                return this.$input.is(\":focus\");                                                                    // 1507\n            },                                                                                                      // 1508\n            hasOverflow: function hasOverflow() {                                                                   // 1509\n                var constraint = this.$input.width() - 2;                                                           // 1510\n                this.$overflowHelper.text(this.getInputValue());                                                    // 1511\n                return this.$overflowHelper.width() >= constraint;                                                  // 1512\n            },                                                                                                      // 1513\n            isCursorAtEnd: function() {                                                                             // 1514\n                var valueLength, selectionStart, range;                                                             // 1515\n                valueLength = this.$input.val().length;                                                             // 1516\n                selectionStart = this.$input[0].selectionStart;                                                     // 1517\n                if (_.isNumber(selectionStart)) {                                                                   // 1518\n                    return selectionStart === valueLength;                                                          // 1519\n                } else if (document.selection) {                                                                    // 1520\n                    range = document.selection.createRange();                                                       // 1521\n                    range.moveStart(\"character\", -valueLength);                                                     // 1522\n                    return valueLength === range.text.length;                                                       // 1523\n                }                                                                                                   // 1524\n                return true;                                                                                        // 1525\n            },                                                                                                      // 1526\n            destroy: function destroy() {                                                                           // 1527\n                this.$hint.off(\".tt\");                                                                              // 1528\n                this.$input.off(\".tt\");                                                                             // 1529\n                this.$overflowHelper.remove();                                                                      // 1530\n                this.$hint = this.$input = this.$overflowHelper = $(\"<div>\");                                       // 1531\n            }                                                                                                       // 1532\n        });                                                                                                         // 1533\n        return Input;                                                                                               // 1534\n        function buildOverflowHelper($input) {                                                                      // 1535\n            return $('<pre aria-hidden=\"true\"></pre>').css({                                                        // 1536\n                position: \"absolute\",                                                                               // 1537\n                visibility: \"hidden\",                                                                               // 1538\n                whiteSpace: \"pre\",                                                                                  // 1539\n                fontFamily: $input.css(\"font-family\"),                                                              // 1540\n                fontSize: $input.css(\"font-size\"),                                                                  // 1541\n                fontStyle: $input.css(\"font-style\"),                                                                // 1542\n                fontVariant: $input.css(\"font-variant\"),                                                            // 1543\n                fontWeight: $input.css(\"font-weight\"),                                                              // 1544\n                wordSpacing: $input.css(\"word-spacing\"),                                                            // 1545\n                letterSpacing: $input.css(\"letter-spacing\"),                                                        // 1546\n                textIndent: $input.css(\"text-indent\"),                                                              // 1547\n                textRendering: $input.css(\"text-rendering\"),                                                        // 1548\n                textTransform: $input.css(\"text-transform\")                                                         // 1549\n            }).insertAfter($input);                                                                                 // 1550\n        }                                                                                                           // 1551\n        function areQueriesEquivalent(a, b) {                                                                       // 1552\n            return Input.normalizeQuery(a) === Input.normalizeQuery(b);                                             // 1553\n        }                                                                                                           // 1554\n        function withModifier($e) {                                                                                 // 1555\n            return $e.altKey || $e.ctrlKey || $e.metaKey || $e.shiftKey;                                            // 1556\n        }                                                                                                           // 1557\n    }();                                                                                                            // 1558\n    var Dataset = function() {                                                                                      // 1559\n        \"use strict\";                                                                                               // 1560\n        var keys, nameGenerator;                                                                                    // 1561\n        keys = {                                                                                                    // 1562\n            val: \"tt-selectable-display\",                                                                           // 1563\n            obj: \"tt-selectable-object\"                                                                             // 1564\n        };                                                                                                          // 1565\n        nameGenerator = _.getIdGenerator();                                                                         // 1566\n        function Dataset(o, www) {                                                                                  // 1567\n            o = o || {};                                                                                            // 1568\n            o.templates = o.templates || {};                                                                        // 1569\n            o.templates.notFound = o.templates.notFound || o.templates.empty;                                       // 1570\n            if (!o.source) {                                                                                        // 1571\n                $.error(\"missing source\");                                                                          // 1572\n            }                                                                                                       // 1573\n            if (!o.node) {                                                                                          // 1574\n                $.error(\"missing node\");                                                                            // 1575\n            }                                                                                                       // 1576\n            if (o.name && !isValidName(o.name)) {                                                                   // 1577\n                $.error(\"invalid dataset name: \" + o.name);                                                         // 1578\n            }                                                                                                       // 1579\n            www.mixin(this);                                                                                        // 1580\n            this.highlight = !!o.highlight;                                                                         // 1581\n            this.name = o.name || nameGenerator();                                                                  // 1582\n            this.limit = o.limit || 5;                                                                              // 1583\n            this.displayFn = getDisplayFn(o.display || o.displayKey);                                               // 1584\n            this.templates = getTemplates(o.templates, this.displayFn);                                             // 1585\n            this.source = o.source.__ttAdapter ? o.source.__ttAdapter() : o.source;                                 // 1586\n            this.async = _.isUndefined(o.async) ? this.source.length > 2 : !!o.async;                               // 1587\n            this._resetLastSuggestion();                                                                            // 1588\n            this.$el = $(o.node).addClass(this.classes.dataset).addClass(this.classes.dataset + \"-\" + this.name);   // 1589\n        }                                                                                                           // 1590\n        Dataset.extractData = function extractData(el) {                                                            // 1591\n            var $el = $(el);                                                                                        // 1592\n            if ($el.data(keys.obj)) {                                                                               // 1593\n                return {                                                                                            // 1594\n                    val: $el.data(keys.val) || \"\",                                                                  // 1595\n                    obj: $el.data(keys.obj) || null                                                                 // 1596\n                };                                                                                                  // 1597\n            }                                                                                                       // 1598\n            return null;                                                                                            // 1599\n        };                                                                                                          // 1600\n        _.mixin(Dataset.prototype, EventEmitter, {                                                                  // 1601\n            _overwrite: function overwrite(query, suggestions) {                                                    // 1602\n                suggestions = suggestions || [];                                                                    // 1603\n                if (suggestions.length) {                                                                           // 1604\n                    this._renderSuggestions(query, suggestions);                                                    // 1605\n                } else if (this.async && this.templates.pending) {                                                  // 1606\n                    this._renderPending(query);                                                                     // 1607\n                } else if (!this.async && this.templates.notFound) {                                                // 1608\n                    this._renderNotFound(query);                                                                    // 1609\n                } else {                                                                                            // 1610\n                    this._empty();                                                                                  // 1611\n                }                                                                                                   // 1612\n                this.trigger(\"rendered\", this.name, suggestions, false);                                            // 1613\n            },                                                                                                      // 1614\n            _append: function append(query, suggestions) {                                                          // 1615\n                suggestions = suggestions || [];                                                                    // 1616\n                if (suggestions.length && this.$lastSuggestion.length) {                                            // 1617\n                    this._appendSuggestions(query, suggestions);                                                    // 1618\n                } else if (suggestions.length) {                                                                    // 1619\n                    this._renderSuggestions(query, suggestions);                                                    // 1620\n                } else if (!this.$lastSuggestion.length && this.templates.notFound) {                               // 1621\n                    this._renderNotFound(query);                                                                    // 1622\n                }                                                                                                   // 1623\n                this.trigger(\"rendered\", this.name, suggestions, true);                                             // 1624\n            },                                                                                                      // 1625\n            _renderSuggestions: function renderSuggestions(query, suggestions) {                                    // 1626\n                var $fragment;                                                                                      // 1627\n                $fragment = this._getSuggestionsFragment(query, suggestions);                                       // 1628\n                this.$lastSuggestion = $fragment.children().last();                                                 // 1629\n                this.$el.html($fragment).prepend(this._getHeader(query, suggestions)).append(this._getFooter(query, suggestions));\n            },                                                                                                      // 1631\n            _appendSuggestions: function appendSuggestions(query, suggestions) {                                    // 1632\n                var $fragment, $lastSuggestion;                                                                     // 1633\n                $fragment = this._getSuggestionsFragment(query, suggestions);                                       // 1634\n                $lastSuggestion = $fragment.children().last();                                                      // 1635\n                this.$lastSuggestion.after($fragment);                                                              // 1636\n                this.$lastSuggestion = $lastSuggestion;                                                             // 1637\n            },                                                                                                      // 1638\n            _renderPending: function renderPending(query) {                                                         // 1639\n                var template = this.templates.pending;                                                              // 1640\n                this._resetLastSuggestion();                                                                        // 1641\n                template && this.$el.html(template({                                                                // 1642\n                    query: query,                                                                                   // 1643\n                    dataset: this.name                                                                              // 1644\n                }));                                                                                                // 1645\n            },                                                                                                      // 1646\n            _renderNotFound: function renderNotFound(query) {                                                       // 1647\n                var template = this.templates.notFound;                                                             // 1648\n                this._resetLastSuggestion();                                                                        // 1649\n                template && this.$el.html(template({                                                                // 1650\n                    query: query,                                                                                   // 1651\n                    dataset: this.name                                                                              // 1652\n                }));                                                                                                // 1653\n            },                                                                                                      // 1654\n            _empty: function empty() {                                                                              // 1655\n                this.$el.empty();                                                                                   // 1656\n                this._resetLastSuggestion();                                                                        // 1657\n            },                                                                                                      // 1658\n            _getSuggestionsFragment: function getSuggestionsFragment(query, suggestions) {                          // 1659\n                var that = this, fragment;                                                                          // 1660\n                fragment = document.createDocumentFragment();                                                       // 1661\n                _.each(suggestions, function getSuggestionNode(suggestion) {                                        // 1662\n                    var $el, context;                                                                               // 1663\n                    context = that._injectQuery(query, suggestion);                                                 // 1664\n                    $el = $(that.templates.suggestion(context)).data(keys.obj, suggestion).data(keys.val, that.displayFn(suggestion)).addClass(that.classes.suggestion + \" \" + that.classes.selectable);\n                    fragment.appendChild($el[0]);                                                                   // 1666\n                });                                                                                                 // 1667\n                this.highlight && highlight({                                                                       // 1668\n                    className: this.classes.highlight,                                                              // 1669\n                    node: fragment,                                                                                 // 1670\n                    pattern: query                                                                                  // 1671\n                });                                                                                                 // 1672\n                return $(fragment);                                                                                 // 1673\n            },                                                                                                      // 1674\n            _getFooter: function getFooter(query, suggestions) {                                                    // 1675\n                return this.templates.footer ? this.templates.footer({                                              // 1676\n                    query: query,                                                                                   // 1677\n                    suggestions: suggestions,                                                                       // 1678\n                    dataset: this.name                                                                              // 1679\n                }) : null;                                                                                          // 1680\n            },                                                                                                      // 1681\n            _getHeader: function getHeader(query, suggestions) {                                                    // 1682\n                return this.templates.header ? this.templates.header({                                              // 1683\n                    query: query,                                                                                   // 1684\n                    suggestions: suggestions,                                                                       // 1685\n                    dataset: this.name                                                                              // 1686\n                }) : null;                                                                                          // 1687\n            },                                                                                                      // 1688\n            _resetLastSuggestion: function resetLastSuggestion() {                                                  // 1689\n                this.$lastSuggestion = $();                                                                         // 1690\n            },                                                                                                      // 1691\n            _injectQuery: function injectQuery(query, obj) {                                                        // 1692\n                return _.isObject(obj) ? _.mixin({                                                                  // 1693\n                    _query: query                                                                                   // 1694\n                }, obj) : obj;                                                                                      // 1695\n            },                                                                                                      // 1696\n            update: function update(query) {                                                                        // 1697\n                var that = this, canceled = false, syncCalled = false, rendered = 0;                                // 1698\n                this.cancel();                                                                                      // 1699\n                this.cancel = function cancel() {                                                                   // 1700\n                    canceled = true;                                                                                // 1701\n                    that.cancel = $.noop;                                                                           // 1702\n                    that.async && that.trigger(\"asyncCanceled\", query);                                             // 1703\n                };                                                                                                  // 1704\n                this.source(query, sync, async);                                                                    // 1705\n                !syncCalled && sync([]);                                                                            // 1706\n                function sync(suggestions) {                                                                        // 1707\n                    if (syncCalled) {                                                                               // 1708\n                        return;                                                                                     // 1709\n                    }                                                                                               // 1710\n                    syncCalled = true;                                                                              // 1711\n                    suggestions = (suggestions || []).slice(0, that.limit);                                         // 1712\n                    rendered = suggestions.length;                                                                  // 1713\n                    that._overwrite(query, suggestions);                                                            // 1714\n                    if (rendered < that.limit && that.async) {                                                      // 1715\n                        that.trigger(\"asyncRequested\", query);                                                      // 1716\n                    }                                                                                               // 1717\n                }                                                                                                   // 1718\n                function async(suggestions) {                                                                       // 1719\n                    suggestions = suggestions || [];                                                                // 1720\n                    if (!canceled && rendered < that.limit) {                                                       // 1721\n                        that.cancel = $.noop;                                                                       // 1722\n                        suggestions = suggestions.slice(0, that.limit - rendered);                                  // 1723\n                        that._append(query, suggestions);                                                           // 1724\n                        rendered += suggestions.length;                                                             // 1725\n                        that.async && that.trigger(\"asyncReceived\", query);                                         // 1726\n                    }                                                                                               // 1727\n                }                                                                                                   // 1728\n            },                                                                                                      // 1729\n            cancel: $.noop,                                                                                         // 1730\n            clear: function clear() {                                                                               // 1731\n                this._empty();                                                                                      // 1732\n                this.cancel();                                                                                      // 1733\n                this.trigger(\"cleared\");                                                                            // 1734\n            },                                                                                                      // 1735\n            isEmpty: function isEmpty() {                                                                           // 1736\n                return this.$el.is(\":empty\");                                                                       // 1737\n            },                                                                                                      // 1738\n            destroy: function destroy() {                                                                           // 1739\n                this.$el = $(\"<div>\");                                                                              // 1740\n            }                                                                                                       // 1741\n        });                                                                                                         // 1742\n        return Dataset;                                                                                             // 1743\n        function getDisplayFn(display) {                                                                            // 1744\n            display = display || _.stringify;                                                                       // 1745\n            return _.isFunction(display) ? display : displayFn;                                                     // 1746\n            function displayFn(obj) {                                                                               // 1747\n                return obj[display];                                                                                // 1748\n            }                                                                                                       // 1749\n        }                                                                                                           // 1750\n        function getTemplates(templates, displayFn) {                                                               // 1751\n            return {                                                                                                // 1752\n                notFound: templates.notFound && _.templatify(templates.notFound),                                   // 1753\n                pending: templates.pending && _.templatify(templates.pending),                                      // 1754\n                header: templates.header && _.templatify(templates.header),                                         // 1755\n                footer: templates.footer && _.templatify(templates.footer),                                         // 1756\n                suggestion: templates.suggestion || suggestionTemplate                                              // 1757\n            };                                                                                                      // 1758\n            function suggestionTemplate(context) {                                                                  // 1759\n                return $(\"<div>\").text(displayFn(context));                                                         // 1760\n            }                                                                                                       // 1761\n        }                                                                                                           // 1762\n        function isValidName(str) {                                                                                 // 1763\n            return /^[_a-zA-Z0-9-]+$/.test(str);                                                                    // 1764\n        }                                                                                                           // 1765\n    }();                                                                                                            // 1766\n    var Menu = function() {                                                                                         // 1767\n        \"use strict\";                                                                                               // 1768\n        function Menu(o, www) {                                                                                     // 1769\n            var that = this;                                                                                        // 1770\n            o = o || {};                                                                                            // 1771\n            if (!o.node) {                                                                                          // 1772\n                $.error(\"node is required\");                                                                        // 1773\n            }                                                                                                       // 1774\n            www.mixin(this);                                                                                        // 1775\n            this.$node = $(o.node);                                                                                 // 1776\n            this.query = null;                                                                                      // 1777\n            this.datasets = _.map(o.datasets, initializeDataset);                                                   // 1778\n            function initializeDataset(oDataset) {                                                                  // 1779\n                var node = that.$node.find(oDataset.node).first();                                                  // 1780\n                oDataset.node = node.length ? node : $(\"<div>\").appendTo(that.$node);                               // 1781\n                return new Dataset(oDataset, www);                                                                  // 1782\n            }                                                                                                       // 1783\n        }                                                                                                           // 1784\n        _.mixin(Menu.prototype, EventEmitter, {                                                                     // 1785\n            _onSelectableClick: function onSelectableClick($e) {                                                    // 1786\n                this.trigger(\"selectableClicked\", $($e.currentTarget));                                             // 1787\n            },                                                                                                      // 1788\n            _onRendered: function onRendered(type, dataset, suggestions, async) {                                   // 1789\n                this.$node.toggleClass(this.classes.empty, this._allDatasetsEmpty());                               // 1790\n                this.trigger(\"datasetRendered\", dataset, suggestions, async);                                       // 1791\n            },                                                                                                      // 1792\n            _onCleared: function onCleared() {                                                                      // 1793\n                this.$node.toggleClass(this.classes.empty, this._allDatasetsEmpty());                               // 1794\n                this.trigger(\"datasetCleared\");                                                                     // 1795\n            },                                                                                                      // 1796\n            _propagate: function propagate() {                                                                      // 1797\n                this.trigger.apply(this, arguments);                                                                // 1798\n            },                                                                                                      // 1799\n            _allDatasetsEmpty: function allDatasetsEmpty() {                                                        // 1800\n                return _.every(this.datasets, isDatasetEmpty);                                                      // 1801\n                function isDatasetEmpty(dataset) {                                                                  // 1802\n                    return dataset.isEmpty();                                                                       // 1803\n                }                                                                                                   // 1804\n            },                                                                                                      // 1805\n            _getSelectables: function getSelectables() {                                                            // 1806\n                return this.$node.find(this.selectors.selectable);                                                  // 1807\n            },                                                                                                      // 1808\n            _removeCursor: function _removeCursor() {                                                               // 1809\n                var $selectable = this.getActiveSelectable();                                                       // 1810\n                $selectable && $selectable.removeClass(this.classes.cursor);                                        // 1811\n            },                                                                                                      // 1812\n            _ensureVisible: function ensureVisible($el) {                                                           // 1813\n                var elTop, elBottom, nodeScrollTop, nodeHeight;                                                     // 1814\n                elTop = $el.position().top;                                                                         // 1815\n                elBottom = elTop + $el.outerHeight(true);                                                           // 1816\n                nodeScrollTop = this.$node.scrollTop();                                                             // 1817\n                nodeHeight = this.$node.height() + parseInt(this.$node.css(\"paddingTop\"), 10) + parseInt(this.$node.css(\"paddingBottom\"), 10);\n                if (elTop < 0) {                                                                                    // 1819\n                    this.$node.scrollTop(nodeScrollTop + elTop);                                                    // 1820\n                } else if (nodeHeight < elBottom) {                                                                 // 1821\n                    this.$node.scrollTop(nodeScrollTop + (elBottom - nodeHeight));                                  // 1822\n                }                                                                                                   // 1823\n            },                                                                                                      // 1824\n            bind: function() {                                                                                      // 1825\n                var that = this, onSelectableClick;                                                                 // 1826\n                onSelectableClick = _.bind(this._onSelectableClick, this);                                          // 1827\n                this.$node.on(\"click.tt\", this.selectors.selectable, onSelectableClick);                            // 1828\n                _.each(this.datasets, function(dataset) {                                                           // 1829\n                    dataset.onSync(\"asyncRequested\", that._propagate, that).onSync(\"asyncCanceled\", that._propagate, that).onSync(\"asyncReceived\", that._propagate, that).onSync(\"rendered\", that._onRendered, that).onSync(\"cleared\", that._onCleared, that);\n                });                                                                                                 // 1831\n                return this;                                                                                        // 1832\n            },                                                                                                      // 1833\n            isOpen: function isOpen() {                                                                             // 1834\n                return this.$node.hasClass(this.classes.open);                                                      // 1835\n            },                                                                                                      // 1836\n            open: function open() {                                                                                 // 1837\n                this.$node.addClass(this.classes.open);                                                             // 1838\n            },                                                                                                      // 1839\n            close: function close() {                                                                               // 1840\n                this.$node.removeClass(this.classes.open);                                                          // 1841\n                this._removeCursor();                                                                               // 1842\n            },                                                                                                      // 1843\n            setLanguageDirection: function setLanguageDirection(dir) {                                              // 1844\n                this.$node.attr(\"dir\", dir);                                                                        // 1845\n            },                                                                                                      // 1846\n            selectableRelativeToCursor: function selectableRelativeToCursor(delta) {                                // 1847\n                var $selectables, $oldCursor, oldIndex, newIndex;                                                   // 1848\n                $oldCursor = this.getActiveSelectable();                                                            // 1849\n                $selectables = this._getSelectables();                                                              // 1850\n                oldIndex = $oldCursor ? $selectables.index($oldCursor) : -1;                                        // 1851\n                newIndex = oldIndex + delta;                                                                        // 1852\n                newIndex = (newIndex + 1) % ($selectables.length + 1) - 1;                                          // 1853\n                newIndex = newIndex < -1 ? $selectables.length - 1 : newIndex;                                      // 1854\n                return newIndex === -1 ? null : $selectables.eq(newIndex);                                          // 1855\n            },                                                                                                      // 1856\n            setCursor: function setCursor($selectable) {                                                            // 1857\n                this._removeCursor();                                                                               // 1858\n                if ($selectable = $selectable && $selectable.first()) {                                             // 1859\n                    $selectable.addClass(this.classes.cursor);                                                      // 1860\n                    this._ensureVisible($selectable);                                                               // 1861\n                }                                                                                                   // 1862\n            },                                                                                                      // 1863\n            getSelectableData: function getSelectableData($el) {                                                    // 1864\n                return $el && $el.length ? Dataset.extractData($el) : null;                                         // 1865\n            },                                                                                                      // 1866\n            getActiveSelectable: function getActiveSelectable() {                                                   // 1867\n                var $selectable = this._getSelectables().filter(this.selectors.cursor).first();                     // 1868\n                return $selectable.length ? $selectable : null;                                                     // 1869\n            },                                                                                                      // 1870\n            getTopSelectable: function getTopSelectable() {                                                         // 1871\n                var $selectable = this._getSelectables().first();                                                   // 1872\n                return $selectable.length ? $selectable : null;                                                     // 1873\n            },                                                                                                      // 1874\n            update: function update(query) {                                                                        // 1875\n                var isValidUpdate = query !== this.query;                                                           // 1876\n                if (isValidUpdate) {                                                                                // 1877\n                    this.query = query;                                                                             // 1878\n                    _.each(this.datasets, updateDataset);                                                           // 1879\n                }                                                                                                   // 1880\n                return isValidUpdate;                                                                               // 1881\n                function updateDataset(dataset) {                                                                   // 1882\n                    dataset.update(query);                                                                          // 1883\n                }                                                                                                   // 1884\n            },                                                                                                      // 1885\n            empty: function empty() {                                                                               // 1886\n                _.each(this.datasets, clearDataset);                                                                // 1887\n                this.query = null;                                                                                  // 1888\n                this.$node.addClass(this.classes.empty);                                                            // 1889\n                function clearDataset(dataset) {                                                                    // 1890\n                    dataset.clear();                                                                                // 1891\n                }                                                                                                   // 1892\n            },                                                                                                      // 1893\n            destroy: function destroy() {                                                                           // 1894\n                this.$node.off(\".tt\");                                                                              // 1895\n                this.$node = $(\"<div>\");                                                                            // 1896\n                _.each(this.datasets, destroyDataset);                                                              // 1897\n                function destroyDataset(dataset) {                                                                  // 1898\n                    dataset.destroy();                                                                              // 1899\n                }                                                                                                   // 1900\n            }                                                                                                       // 1901\n        });                                                                                                         // 1902\n        return Menu;                                                                                                // 1903\n    }();                                                                                                            // 1904\n    var DefaultMenu = function() {                                                                                  // 1905\n        \"use strict\";                                                                                               // 1906\n        var s = Menu.prototype;                                                                                     // 1907\n        function DefaultMenu() {                                                                                    // 1908\n            Menu.apply(this, [].slice.call(arguments, 0));                                                          // 1909\n        }                                                                                                           // 1910\n        _.mixin(DefaultMenu.prototype, Menu.prototype, {                                                            // 1911\n            open: function open() {                                                                                 // 1912\n                !this._allDatasetsEmpty() && this._show();                                                          // 1913\n                return s.open.apply(this, [].slice.call(arguments, 0));                                             // 1914\n            },                                                                                                      // 1915\n            close: function close() {                                                                               // 1916\n                this._hide();                                                                                       // 1917\n                return s.close.apply(this, [].slice.call(arguments, 0));                                            // 1918\n            },                                                                                                      // 1919\n            _onRendered: function onRendered() {                                                                    // 1920\n                if (this._allDatasetsEmpty()) {                                                                     // 1921\n                    this._hide();                                                                                   // 1922\n                } else {                                                                                            // 1923\n                    this.isOpen() && this._show();                                                                  // 1924\n                }                                                                                                   // 1925\n                return s._onRendered.apply(this, [].slice.call(arguments, 0));                                      // 1926\n            },                                                                                                      // 1927\n            _onCleared: function onCleared() {                                                                      // 1928\n                if (this._allDatasetsEmpty()) {                                                                     // 1929\n                    this._hide();                                                                                   // 1930\n                } else {                                                                                            // 1931\n                    this.isOpen() && this._show();                                                                  // 1932\n                }                                                                                                   // 1933\n                return s._onCleared.apply(this, [].slice.call(arguments, 0));                                       // 1934\n            },                                                                                                      // 1935\n            setLanguageDirection: function setLanguageDirection(dir) {                                              // 1936\n                this.$node.css(dir === \"ltr\" ? this.css.ltr : this.css.rtl);                                        // 1937\n                return s.setLanguageDirection.apply(this, [].slice.call(arguments, 0));                             // 1938\n            },                                                                                                      // 1939\n            _hide: function hide() {                                                                                // 1940\n                this.$node.hide();                                                                                  // 1941\n            },                                                                                                      // 1942\n            _show: function show() {                                                                                // 1943\n                this.$node.css(\"display\", \"block\");                                                                 // 1944\n            }                                                                                                       // 1945\n        });                                                                                                         // 1946\n        return DefaultMenu;                                                                                         // 1947\n    }();                                                                                                            // 1948\n    var Typeahead = function() {                                                                                    // 1949\n        \"use strict\";                                                                                               // 1950\n        function Typeahead(o, www) {                                                                                // 1951\n            var onFocused, onBlurred, onEnterKeyed, onTabKeyed, onEscKeyed, onUpKeyed, onDownKeyed, onLeftKeyed, onRightKeyed, onQueryChanged, onWhitespaceChanged;\n            o = o || {};                                                                                            // 1953\n            if (!o.input) {                                                                                         // 1954\n                $.error(\"missing input\");                                                                           // 1955\n            }                                                                                                       // 1956\n            if (!o.menu) {                                                                                          // 1957\n                $.error(\"missing menu\");                                                                            // 1958\n            }                                                                                                       // 1959\n            if (!o.eventBus) {                                                                                      // 1960\n                $.error(\"missing event bus\");                                                                       // 1961\n            }                                                                                                       // 1962\n            www.mixin(this);                                                                                        // 1963\n            this.eventBus = o.eventBus;                                                                             // 1964\n            this.minLength = _.isNumber(o.minLength) ? o.minLength : 1;                                             // 1965\n            this.input = o.input;                                                                                   // 1966\n            this.menu = o.menu;                                                                                     // 1967\n            this.enabled = true;                                                                                    // 1968\n            this.active = false;                                                                                    // 1969\n            this.input.hasFocus() && this.activate();                                                               // 1970\n            this.dir = this.input.getLangDir();                                                                     // 1971\n            this._hacks();                                                                                          // 1972\n            this.menu.bind().onSync(\"selectableClicked\", this._onSelectableClicked, this).onSync(\"asyncRequested\", this._onAsyncRequested, this).onSync(\"asyncCanceled\", this._onAsyncCanceled, this).onSync(\"asyncReceived\", this._onAsyncReceived, this).onSync(\"datasetRendered\", this._onDatasetRendered, this).onSync(\"datasetCleared\", this._onDatasetCleared, this);\n            onFocused = c(this, \"activate\", \"open\", \"_onFocused\");                                                  // 1974\n            onBlurred = c(this, \"deactivate\", \"_onBlurred\");                                                        // 1975\n            onEnterKeyed = c(this, \"isActive\", \"isOpen\", \"_onEnterKeyed\");                                          // 1976\n            onTabKeyed = c(this, \"isActive\", \"isOpen\", \"_onTabKeyed\");                                              // 1977\n            onEscKeyed = c(this, \"isActive\", \"_onEscKeyed\");                                                        // 1978\n            onUpKeyed = c(this, \"isActive\", \"open\", \"_onUpKeyed\");                                                  // 1979\n            onDownKeyed = c(this, \"isActive\", \"open\", \"_onDownKeyed\");                                              // 1980\n            onLeftKeyed = c(this, \"isActive\", \"isOpen\", \"_onLeftKeyed\");                                            // 1981\n            onRightKeyed = c(this, \"isActive\", \"isOpen\", \"_onRightKeyed\");                                          // 1982\n            onQueryChanged = c(this, \"_openIfActive\", \"_onQueryChanged\");                                           // 1983\n            onWhitespaceChanged = c(this, \"_openIfActive\", \"_onWhitespaceChanged\");                                 // 1984\n            this.input.bind().onSync(\"focused\", onFocused, this).onSync(\"blurred\", onBlurred, this).onSync(\"enterKeyed\", onEnterKeyed, this).onSync(\"tabKeyed\", onTabKeyed, this).onSync(\"escKeyed\", onEscKeyed, this).onSync(\"upKeyed\", onUpKeyed, this).onSync(\"downKeyed\", onDownKeyed, this).onSync(\"leftKeyed\", onLeftKeyed, this).onSync(\"rightKeyed\", onRightKeyed, this).onSync(\"queryChanged\", onQueryChanged, this).onSync(\"whitespaceChanged\", onWhitespaceChanged, this).onSync(\"langDirChanged\", this._onLangDirChanged, this);\n        }                                                                                                           // 1986\n        _.mixin(Typeahead.prototype, {                                                                              // 1987\n            _hacks: function hacks() {                                                                              // 1988\n                var $input, $menu;                                                                                  // 1989\n                $input = this.input.$input || $(\"<div>\");                                                           // 1990\n                $menu = this.menu.$node || $(\"<div>\");                                                              // 1991\n                $input.on(\"blur.tt\", function($e) {                                                                 // 1992\n                    var active, isActive, hasActive;                                                                // 1993\n                    active = document.activeElement;                                                                // 1994\n                    isActive = $menu.is(active);                                                                    // 1995\n                    hasActive = $menu.has(active).length > 0;                                                       // 1996\n                    if (_.isMsie() && (isActive || hasActive)) {                                                    // 1997\n                        $e.preventDefault();                                                                        // 1998\n                        $e.stopImmediatePropagation();                                                              // 1999\n                        _.defer(function() {                                                                        // 2000\n                            $input.focus();                                                                         // 2001\n                        });                                                                                         // 2002\n                    }                                                                                               // 2003\n                });                                                                                                 // 2004\n                $menu.on(\"mousedown.tt\", function($e) {                                                             // 2005\n                    $e.preventDefault();                                                                            // 2006\n                });                                                                                                 // 2007\n            },                                                                                                      // 2008\n            _onSelectableClicked: function onSelectableClicked(type, $el) {                                         // 2009\n                this.select($el);                                                                                   // 2010\n            },                                                                                                      // 2011\n            _onDatasetCleared: function onDatasetCleared() {                                                        // 2012\n                this._updateHint();                                                                                 // 2013\n            },                                                                                                      // 2014\n            _onDatasetRendered: function onDatasetRendered(type, dataset, suggestions, async) {                     // 2015\n                this._updateHint();                                                                                 // 2016\n                this.eventBus.trigger(\"render\", suggestions, async, dataset);                                       // 2017\n            },                                                                                                      // 2018\n            _onAsyncRequested: function onAsyncRequested(type, dataset, query) {                                    // 2019\n                this.eventBus.trigger(\"asyncrequest\", query, dataset);                                              // 2020\n            },                                                                                                      // 2021\n            _onAsyncCanceled: function onAsyncCanceled(type, dataset, query) {                                      // 2022\n                this.eventBus.trigger(\"asynccancel\", query, dataset);                                               // 2023\n            },                                                                                                      // 2024\n            _onAsyncReceived: function onAsyncReceived(type, dataset, query) {                                      // 2025\n                this.eventBus.trigger(\"asyncreceive\", query, dataset);                                              // 2026\n            },                                                                                                      // 2027\n            _onFocused: function onFocused() {                                                                      // 2028\n                this._minLengthMet() && this.menu.update(this.input.getQuery());                                    // 2029\n            },                                                                                                      // 2030\n            _onBlurred: function onBlurred() {                                                                      // 2031\n                if (this.input.hasQueryChangedSinceLastFocus()) {                                                   // 2032\n                    this.eventBus.trigger(\"change\", this.input.getQuery());                                         // 2033\n                }                                                                                                   // 2034\n            },                                                                                                      // 2035\n            _onEnterKeyed: function onEnterKeyed(type, $e) {                                                        // 2036\n                var $selectable;                                                                                    // 2037\n                if ($selectable = this.menu.getActiveSelectable()) {                                                // 2038\n                    this.select($selectable) && $e.preventDefault();                                                // 2039\n                }                                                                                                   // 2040\n            },                                                                                                      // 2041\n            _onTabKeyed: function onTabKeyed(type, $e) {                                                            // 2042\n                var $selectable;                                                                                    // 2043\n                if ($selectable = this.menu.getActiveSelectable()) {                                                // 2044\n                    this.select($selectable) && $e.preventDefault();                                                // 2045\n                } else if ($selectable = this.menu.getTopSelectable()) {                                            // 2046\n                    this.autocomplete($selectable) && $e.preventDefault();                                          // 2047\n                }                                                                                                   // 2048\n            },                                                                                                      // 2049\n            _onEscKeyed: function onEscKeyed() {                                                                    // 2050\n                this.close();                                                                                       // 2051\n            },                                                                                                      // 2052\n            _onUpKeyed: function onUpKeyed() {                                                                      // 2053\n                this.moveCursor(-1);                                                                                // 2054\n            },                                                                                                      // 2055\n            _onDownKeyed: function onDownKeyed() {                                                                  // 2056\n                this.moveCursor(+1);                                                                                // 2057\n            },                                                                                                      // 2058\n            _onLeftKeyed: function onLeftKeyed() {                                                                  // 2059\n                if (this.dir === \"rtl\" && this.input.isCursorAtEnd()) {                                             // 2060\n                    this.autocomplete(this.menu.getTopSelectable());                                                // 2061\n                }                                                                                                   // 2062\n            },                                                                                                      // 2063\n            _onRightKeyed: function onRightKeyed() {                                                                // 2064\n                if (this.dir === \"ltr\" && this.input.isCursorAtEnd()) {                                             // 2065\n                    this.autocomplete(this.menu.getTopSelectable());                                                // 2066\n                }                                                                                                   // 2067\n            },                                                                                                      // 2068\n            _onQueryChanged: function onQueryChanged(e, query) {                                                    // 2069\n                this._minLengthMet(query) ? this.menu.update(query) : this.menu.empty();                            // 2070\n            },                                                                                                      // 2071\n            _onWhitespaceChanged: function onWhitespaceChanged() {                                                  // 2072\n                this._updateHint();                                                                                 // 2073\n            },                                                                                                      // 2074\n            _onLangDirChanged: function onLangDirChanged(e, dir) {                                                  // 2075\n                if (this.dir !== dir) {                                                                             // 2076\n                    this.dir = dir;                                                                                 // 2077\n                    this.menu.setLanguageDirection(dir);                                                            // 2078\n                }                                                                                                   // 2079\n            },                                                                                                      // 2080\n            _openIfActive: function openIfActive() {                                                                // 2081\n                this.isActive() && this.open();                                                                     // 2082\n            },                                                                                                      // 2083\n            _minLengthMet: function minLengthMet(query) {                                                           // 2084\n                query = _.isString(query) ? query : this.input.getQuery() || \"\";                                    // 2085\n                return query.length >= this.minLength;                                                              // 2086\n            },                                                                                                      // 2087\n            _updateHint: function updateHint() {                                                                    // 2088\n                var $selectable, data, val, query, escapedQuery, frontMatchRegEx, match;                            // 2089\n                $selectable = this.menu.getTopSelectable();                                                         // 2090\n                data = this.menu.getSelectableData($selectable);                                                    // 2091\n                val = this.input.getInputValue();                                                                   // 2092\n                if (data && !_.isBlankString(val) && !this.input.hasOverflow()) {                                   // 2093\n                    query = Input.normalizeQuery(val);                                                              // 2094\n                    escapedQuery = _.escapeRegExChars(query);                                                       // 2095\n                    frontMatchRegEx = new RegExp(\"^(?:\" + escapedQuery + \")(.+$)\", \"i\");                            // 2096\n                    match = frontMatchRegEx.exec(data.val);                                                         // 2097\n                    match && this.input.setHint(val + match[1]);                                                    // 2098\n                } else {                                                                                            // 2099\n                    this.input.clearHint();                                                                         // 2100\n                }                                                                                                   // 2101\n            },                                                                                                      // 2102\n            isEnabled: function isEnabled() {                                                                       // 2103\n                return this.enabled;                                                                                // 2104\n            },                                                                                                      // 2105\n            enable: function enable() {                                                                             // 2106\n                this.enabled = true;                                                                                // 2107\n            },                                                                                                      // 2108\n            disable: function disable() {                                                                           // 2109\n                this.enabled = false;                                                                               // 2110\n            },                                                                                                      // 2111\n            isActive: function isActive() {                                                                         // 2112\n                return this.active;                                                                                 // 2113\n            },                                                                                                      // 2114\n            activate: function activate() {                                                                         // 2115\n                if (this.isActive()) {                                                                              // 2116\n                    return true;                                                                                    // 2117\n                } else if (!this.isEnabled() || this.eventBus.before(\"active\")) {                                   // 2118\n                    return false;                                                                                   // 2119\n                } else {                                                                                            // 2120\n                    this.active = true;                                                                             // 2121\n                    this.eventBus.trigger(\"active\");                                                                // 2122\n                    return true;                                                                                    // 2123\n                }                                                                                                   // 2124\n            },                                                                                                      // 2125\n            deactivate: function deactivate() {                                                                     // 2126\n                if (!this.isActive()) {                                                                             // 2127\n                    return true;                                                                                    // 2128\n                } else if (this.eventBus.before(\"idle\")) {                                                          // 2129\n                    return false;                                                                                   // 2130\n                } else {                                                                                            // 2131\n                    this.active = false;                                                                            // 2132\n                    this.close();                                                                                   // 2133\n                    this.eventBus.trigger(\"idle\");                                                                  // 2134\n                    return true;                                                                                    // 2135\n                }                                                                                                   // 2136\n            },                                                                                                      // 2137\n            isOpen: function isOpen() {                                                                             // 2138\n                return this.menu.isOpen();                                                                          // 2139\n            },                                                                                                      // 2140\n            open: function open() {                                                                                 // 2141\n                if (!this.isOpen() && !this.eventBus.before(\"open\")) {                                              // 2142\n                    this.menu.open();                                                                               // 2143\n                    this._updateHint();                                                                             // 2144\n                    this.eventBus.trigger(\"open\");                                                                  // 2145\n                }                                                                                                   // 2146\n                return this.isOpen();                                                                               // 2147\n            },                                                                                                      // 2148\n            close: function close() {                                                                               // 2149\n                if (this.isOpen() && !this.eventBus.before(\"close\")) {                                              // 2150\n                    this.menu.close();                                                                              // 2151\n                    this.input.clearHint();                                                                         // 2152\n                    this.input.resetInputValue();                                                                   // 2153\n                    this.eventBus.trigger(\"close\");                                                                 // 2154\n                }                                                                                                   // 2155\n                return !this.isOpen();                                                                              // 2156\n            },                                                                                                      // 2157\n            setVal: function setVal(val) {                                                                          // 2158\n                this.input.setQuery(_.toStr(val));                                                                  // 2159\n            },                                                                                                      // 2160\n            getVal: function getVal() {                                                                             // 2161\n                return this.input.getQuery();                                                                       // 2162\n            },                                                                                                      // 2163\n            select: function select($selectable) {                                                                  // 2164\n                var data = this.menu.getSelectableData($selectable);                                                // 2165\n                if (data && !this.eventBus.before(\"select\", data.obj)) {                                            // 2166\n                    this.input.setQuery(data.val, true);                                                            // 2167\n                    this.eventBus.trigger(\"select\", data.obj);                                                      // 2168\n                    this.close();                                                                                   // 2169\n                    return true;                                                                                    // 2170\n                }                                                                                                   // 2171\n                return false;                                                                                       // 2172\n            },                                                                                                      // 2173\n            autocomplete: function autocomplete($selectable) {                                                      // 2174\n                var query, data, isValid;                                                                           // 2175\n                query = this.input.getQuery();                                                                      // 2176\n                data = this.menu.getSelectableData($selectable);                                                    // 2177\n                isValid = data && query !== data.val;                                                               // 2178\n                if (isValid && !this.eventBus.before(\"autocomplete\", data.obj)) {                                   // 2179\n                    this.input.setQuery(data.val);                                                                  // 2180\n                    this.eventBus.trigger(\"autocomplete\", data.obj);                                                // 2181\n                    return true;                                                                                    // 2182\n                }                                                                                                   // 2183\n                return false;                                                                                       // 2184\n            },                                                                                                      // 2185\n            moveCursor: function moveCursor(delta) {                                                                // 2186\n                var query, $candidate, data, payload, cancelMove;                                                   // 2187\n                query = this.input.getQuery();                                                                      // 2188\n                $candidate = this.menu.selectableRelativeToCursor(delta);                                           // 2189\n                data = this.menu.getSelectableData($candidate);                                                     // 2190\n                payload = data ? data.obj : null;                                                                   // 2191\n                cancelMove = this._minLengthMet() && this.menu.update(query);                                       // 2192\n                if (!cancelMove && !this.eventBus.before(\"cursorchange\", payload)) {                                // 2193\n                    this.menu.setCursor($candidate);                                                                // 2194\n                    if (data) {                                                                                     // 2195\n                        this.input.setInputValue(data.val);                                                         // 2196\n                    } else {                                                                                        // 2197\n                        this.input.resetInputValue();                                                               // 2198\n                        this._updateHint();                                                                         // 2199\n                    }                                                                                               // 2200\n                    this.eventBus.trigger(\"cursorchange\", payload);                                                 // 2201\n                    return true;                                                                                    // 2202\n                }                                                                                                   // 2203\n                return false;                                                                                       // 2204\n            },                                                                                                      // 2205\n            destroy: function destroy() {                                                                           // 2206\n                this.input.destroy();                                                                               // 2207\n                this.menu.destroy();                                                                                // 2208\n            }                                                                                                       // 2209\n        });                                                                                                         // 2210\n        return Typeahead;                                                                                           // 2211\n        function c(ctx) {                                                                                           // 2212\n            var methods = [].slice.call(arguments, 1);                                                              // 2213\n            return function() {                                                                                     // 2214\n                var args = [].slice.call(arguments);                                                                // 2215\n                _.each(methods, function(method) {                                                                  // 2216\n                    return ctx[method].apply(ctx, args);                                                            // 2217\n                });                                                                                                 // 2218\n            };                                                                                                      // 2219\n        }                                                                                                           // 2220\n    }();                                                                                                            // 2221\n    (function() {                                                                                                   // 2222\n        \"use strict\";                                                                                               // 2223\n        var old, keys, methods;                                                                                     // 2224\n        old = $.fn.typeahead;                                                                                       // 2225\n        keys = {                                                                                                    // 2226\n            www: \"tt-www\",                                                                                          // 2227\n            attrs: \"tt-attrs\",                                                                                      // 2228\n            typeahead: \"tt-typeahead\"                                                                               // 2229\n        };                                                                                                          // 2230\n        methods = {                                                                                                 // 2231\n            initialize: function initialize(o, datasets) {                                                          // 2232\n                var www;                                                                                            // 2233\n                datasets = _.isArray(datasets) ? datasets : [].slice.call(arguments, 1);                            // 2234\n                o = o || {};                                                                                        // 2235\n                www = WWW(o.classNames);                                                                            // 2236\n                return this.each(attach);                                                                           // 2237\n                function attach() {                                                                                 // 2238\n                    var $input, $wrapper, $hint, $menu, defaultHint, defaultMenu, eventBus, input, menu, typeahead, MenuConstructor;\n                    _.each(datasets, function(d) {                                                                  // 2240\n                        d.highlight = !!o.highlight;                                                                // 2241\n                    });                                                                                             // 2242\n                    $input = $(this);                                                                               // 2243\n                    $wrapper = $(www.html.wrapper);                                                                 // 2244\n                    $hint = $elOrNull(o.hint);                                                                      // 2245\n                    $menu = $elOrNull(o.menu);                                                                      // 2246\n                    defaultHint = o.hint !== false && !$hint;                                                       // 2247\n                    defaultMenu = o.menu !== false && !$menu;                                                       // 2248\n                    defaultHint && ($hint = buildHintFromInput($input, www));                                       // 2249\n                    defaultMenu && ($menu = $(www.html.menu).css(www.css.menu));                                    // 2250\n                    $hint && $hint.val(\"\");                                                                         // 2251\n                    $input = prepInput($input, www);                                                                // 2252\n                    if (defaultHint || defaultMenu) {                                                               // 2253\n                        $wrapper.css(www.css.wrapper);                                                              // 2254\n                        $input.css(defaultHint ? www.css.input : www.css.inputWithNoHint);                          // 2255\n                        $input.wrap($wrapper).parent().prepend(defaultHint ? $hint : null).append(defaultMenu ? $menu : null);\n                    }                                                                                               // 2257\n                    MenuConstructor = defaultMenu ? DefaultMenu : Menu;                                             // 2258\n                    eventBus = new EventBus({                                                                       // 2259\n                        el: $input                                                                                  // 2260\n                    });                                                                                             // 2261\n                    input = new Input({                                                                             // 2262\n                        hint: $hint,                                                                                // 2263\n                        input: $input                                                                               // 2264\n                    }, www);                                                                                        // 2265\n                    menu = new MenuConstructor({                                                                    // 2266\n                        node: $menu,                                                                                // 2267\n                        datasets: datasets                                                                          // 2268\n                    }, www);                                                                                        // 2269\n                    typeahead = new Typeahead({                                                                     // 2270\n                        input: input,                                                                               // 2271\n                        menu: menu,                                                                                 // 2272\n                        eventBus: eventBus,                                                                         // 2273\n                        minLength: o.minLength                                                                      // 2274\n                    }, www);                                                                                        // 2275\n                    $input.data(keys.www, www);                                                                     // 2276\n                    $input.data(keys.typeahead, typeahead);                                                         // 2277\n                }                                                                                                   // 2278\n            },                                                                                                      // 2279\n            isEnabled: function isEnabled() {                                                                       // 2280\n                var enabled;                                                                                        // 2281\n                ttEach(this.first(), function(t) {                                                                  // 2282\n                    enabled = t.isEnabled();                                                                        // 2283\n                });                                                                                                 // 2284\n                return enabled;                                                                                     // 2285\n            },                                                                                                      // 2286\n            enable: function enable() {                                                                             // 2287\n                ttEach(this, function(t) {                                                                          // 2288\n                    t.enable();                                                                                     // 2289\n                });                                                                                                 // 2290\n                return this;                                                                                        // 2291\n            },                                                                                                      // 2292\n            disable: function disable() {                                                                           // 2293\n                ttEach(this, function(t) {                                                                          // 2294\n                    t.disable();                                                                                    // 2295\n                });                                                                                                 // 2296\n                return this;                                                                                        // 2297\n            },                                                                                                      // 2298\n            isActive: function isActive() {                                                                         // 2299\n                var active;                                                                                         // 2300\n                ttEach(this.first(), function(t) {                                                                  // 2301\n                    active = t.isActive();                                                                          // 2302\n                });                                                                                                 // 2303\n                return active;                                                                                      // 2304\n            },                                                                                                      // 2305\n            activate: function activate() {                                                                         // 2306\n                ttEach(this, function(t) {                                                                          // 2307\n                    t.activate();                                                                                   // 2308\n                });                                                                                                 // 2309\n                return this;                                                                                        // 2310\n            },                                                                                                      // 2311\n            deactivate: function deactivate() {                                                                     // 2312\n                ttEach(this, function(t) {                                                                          // 2313\n                    t.deactivate();                                                                                 // 2314\n                });                                                                                                 // 2315\n                return this;                                                                                        // 2316\n            },                                                                                                      // 2317\n            isOpen: function isOpen() {                                                                             // 2318\n                var open;                                                                                           // 2319\n                ttEach(this.first(), function(t) {                                                                  // 2320\n                    open = t.isOpen();                                                                              // 2321\n                });                                                                                                 // 2322\n                return open;                                                                                        // 2323\n            },                                                                                                      // 2324\n            open: function open() {                                                                                 // 2325\n                ttEach(this, function(t) {                                                                          // 2326\n                    t.open();                                                                                       // 2327\n                });                                                                                                 // 2328\n                return this;                                                                                        // 2329\n            },                                                                                                      // 2330\n            close: function close() {                                                                               // 2331\n                ttEach(this, function(t) {                                                                          // 2332\n                    t.close();                                                                                      // 2333\n                });                                                                                                 // 2334\n                return this;                                                                                        // 2335\n            },                                                                                                      // 2336\n            select: function select(el) {                                                                           // 2337\n                var success = false, $el = $(el);                                                                   // 2338\n                ttEach(this.first(), function(t) {                                                                  // 2339\n                    success = t.select($el);                                                                        // 2340\n                });                                                                                                 // 2341\n                return success;                                                                                     // 2342\n            },                                                                                                      // 2343\n            autocomplete: function autocomplete(el) {                                                               // 2344\n                var success = false, $el = $(el);                                                                   // 2345\n                ttEach(this.first(), function(t) {                                                                  // 2346\n                    success = t.autocomplete($el);                                                                  // 2347\n                });                                                                                                 // 2348\n                return success;                                                                                     // 2349\n            },                                                                                                      // 2350\n            moveCursor: function moveCursoe(delta) {                                                                // 2351\n                var success = false;                                                                                // 2352\n                ttEach(this.first(), function(t) {                                                                  // 2353\n                    success = t.moveCursor(delta);                                                                  // 2354\n                });                                                                                                 // 2355\n                return success;                                                                                     // 2356\n            },                                                                                                      // 2357\n            val: function val(newVal) {                                                                             // 2358\n                var query;                                                                                          // 2359\n                if (!arguments.length) {                                                                            // 2360\n                    ttEach(this.first(), function(t) {                                                              // 2361\n                        query = t.getVal();                                                                         // 2362\n                    });                                                                                             // 2363\n                    return query;                                                                                   // 2364\n                } else {                                                                                            // 2365\n                    ttEach(this, function(t) {                                                                      // 2366\n                        t.setVal(newVal);                                                                           // 2367\n                    });                                                                                             // 2368\n                    return this;                                                                                    // 2369\n                }                                                                                                   // 2370\n            },                                                                                                      // 2371\n            destroy: function destroy() {                                                                           // 2372\n                ttEach(this, function(typeahead, $input) {                                                          // 2373\n                    revert($input);                                                                                 // 2374\n                    typeahead.destroy();                                                                            // 2375\n                });                                                                                                 // 2376\n                return this;                                                                                        // 2377\n            }                                                                                                       // 2378\n        };                                                                                                          // 2379\n        $.fn.typeahead = function(method) {                                                                         // 2380\n            if (methods[method]) {                                                                                  // 2381\n                return methods[method].apply(this, [].slice.call(arguments, 1));                                    // 2382\n            } else {                                                                                                // 2383\n                return methods.initialize.apply(this, arguments);                                                   // 2384\n            }                                                                                                       // 2385\n        };                                                                                                          // 2386\n        $.fn.typeahead.noConflict = function noConflict() {                                                         // 2387\n            $.fn.typeahead = old;                                                                                   // 2388\n            return this;                                                                                            // 2389\n        };                                                                                                          // 2390\n        function ttEach($els, fn) {                                                                                 // 2391\n            $els.each(function() {                                                                                  // 2392\n                var $input = $(this), typeahead;                                                                    // 2393\n                (typeahead = $input.data(keys.typeahead)) && fn(typeahead, $input);                                 // 2394\n            });                                                                                                     // 2395\n        }                                                                                                           // 2396\n        function buildHintFromInput($input, www) {                                                                  // 2397\n            return $input.clone().addClass(www.classes.hint).removeData().css(www.css.hint).css(getBackgroundStyles($input)).prop(\"readonly\", true).removeAttr(\"id name placeholder required\").attr({\n                tabindex: -1                                                                                        // 2399\n            });                                                                                                     // 2400\n        }                                                                                                           // 2401\n        function prepInput($input, www) {                                                                           // 2402\n            $input.data(keys.attrs, {                                                                               // 2403\n                dir: $input.attr(\"dir\"),                                                                            // 2404\n                autocomplete: $input.attr(\"autocomplete\"),                                                          // 2405\n                spellcheck: $input.attr(\"spellcheck\"),                                                              // 2406\n                style: $input.attr(\"style\")                                                                         // 2407\n            });                                                                                                     // 2408\n            $input.addClass(www.classes.input);                                                                     // 2409\n            try {                                                                                                   // 2410\n                !$input.attr(\"dir\") && $input.attr(\"dir\", \"auto\");                                                  // 2411\n            } catch (e) {}                                                                                          // 2412\n            return $input;                                                                                          // 2413\n        }                                                                                                           // 2414\n        function getBackgroundStyles($el) {                                                                         // 2415\n            return {                                                                                                // 2416\n                backgroundAttachment: $el.css(\"background-attachment\"),                                             // 2417\n                backgroundClip: $el.css(\"background-clip\"),                                                         // 2418\n                backgroundColor: $el.css(\"background-color\"),                                                       // 2419\n                backgroundImage: $el.css(\"background-image\"),                                                       // 2420\n                backgroundOrigin: $el.css(\"background-origin\"),                                                     // 2421\n                backgroundPosition: $el.css(\"background-position\"),                                                 // 2422\n                backgroundRepeat: $el.css(\"background-repeat\"),                                                     // 2423\n                backgroundSize: $el.css(\"background-size\")                                                          // 2424\n            };                                                                                                      // 2425\n        }                                                                                                           // 2426\n        function revert($input) {                                                                                   // 2427\n            var www, $wrapper;                                                                                      // 2428\n            www = $input.data(keys.www);                                                                            // 2429\n            $wrapper = $input.parent().filter(www.selectors.wrapper);                                               // 2430\n            _.each($input.data(keys.attrs), function(val, key) {                                                    // 2431\n                _.isUndefined(val) ? $input.removeAttr(key) : $input.attr(key, val);                                // 2432\n            });                                                                                                     // 2433\n            $input.removeData(keys.typeahead).removeData(keys.www).removeData(keys.attr).removeClass(www.classes.input);\n            if ($wrapper.length) {                                                                                  // 2435\n                $input.detach().insertAfter($wrapper);                                                              // 2436\n                $wrapper.remove();                                                                                  // 2437\n            }                                                                                                       // 2438\n        }                                                                                                           // 2439\n        function $elOrNull(obj) {                                                                                   // 2440\n            var isValid, $el;                                                                                       // 2441\n            isValid = _.isJQuery(obj) || _.isElement(obj);                                                          // 2442\n            $el = isValid ? $(obj).first() : [];                                                                    // 2443\n            return $el.length ? $el : null;                                                                         // 2444\n        }                                                                                                           // 2445\n    })();                                                                                                           // 2446\n});                                                                                                                 // 2447\n                                                                                                                    // 2448\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}).call(this);\n\n\n\n\n\n\n(function(){\n\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                  //\n// packages/sergeyt_typeahead/index.js                                                                              //\n//                                                                                                                  //\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                    //\nvar global = this || window;                                                                                        // 1\n                                                                                                                    // 2\nfunction identity(x) { return x; }                                                                                  // 3\n                                                                                                                    // 4\n// String.trim polyfill                                                                                             // 5\nif (!String.prototype.trim) {                                                                                       // 6\n\tString.prototype.trim = function () {                                                                              // 7\n\t\treturn this.replace(/^\\s+|\\s+$/g, '');                                                                            // 8\n\t};                                                                                                                 // 9\n}                                                                                                                   // 10\n                                                                                                                    // 11\nvar typeaheadEvents = [                                                                                             // 12\n\t\"active\",                                                                                                          // 13\n\t\"idle\",                                                                                                            // 14\n\t\"open\",                                                                                                            // 15\n\t\"close\",                                                                                                           // 16\n\t\"change\",                                                                                                          // 17\n\t\"render\",                                                                                                          // 18\n\t\"select\",                                                                                                          // 19\n\t\"autocomplete\",                                                                                                    // 20\n\t\"asyncrequest\",                                                                                                    // 21\n\t\"asynccancel\",                                                                                                     // 22\n\t\"asyncreceive\",                                                                                                    // 23\n];                                                                                                                  // 24\n                                                                                                                    // 25\n/**                                                                                                                 // 26\n * Activates typeahead behavior for given element.                                                                  // 27\n * @param element (required) The DOM element to infect.                                                             // 28\n * @param source (optional) The custom data source.                                                                 // 29\n */                                                                                                                 // 30\nMeteor.typeahead = function(element, source) {                                                                      // 31\n\tvar $e = $(element);                                                                                               // 32\n\tvar datasets = resolve_datasets($e, source);                                                                       // 33\n                                                                                                                    // 34\n\t$e.typeahead('destroy');                                                                                           // 35\n                                                                                                                    // 36\n\tvar options = $e.data('options') || {};                                                                            // 37\n\tif (typeof options != 'object') {                                                                                  // 38\n\t\toptions = {};                                                                                                     // 39\n\t}                                                                                                                  // 40\n                                                                                                                    // 41\n\tfunction get_bool(name, defval) {                                                                                  // 42\n\t\tvar val = $e.data(name);                                                                                          // 43\n\t\treturn val === undefined ? defval : !!val;                                                                        // 44\n\t}                                                                                                                  // 45\n                                                                                                                    // 46\n\t// other known options passed via data attributes                                                                  // 47\n\tvar highlight = get_bool('highlight', false);                                                                      // 48\n\tvar hint = get_bool('hint', true);                                                                                 // 49\n\tvar autoselect = get_bool('autoselect', false);                                                                    // 50\n\tvar minLength = get_min_length($e);                                                                                // 51\n                                                                                                                    // 52\n\toptions = $.extend(options, {                                                                                      // 53\n\t\thighlight: highlight,                                                                                             // 54\n\t\thint: hint,                                                                                                       // 55\n\t\tminLength: minLength,                                                                                             // 56\n\t\tautoselect: autoselect                                                                                            // 57\n\t});                                                                                                                // 58\n                                                                                                                    // 59\n\tvar instance;                                                                                                      // 60\n\tif (Array.isArray(datasets)) {                                                                                     // 61\n\t\tinstance = $e.typeahead.apply($e, [options].concat(datasets));                                                    // 62\n\t} else {                                                                                                           // 63\n\t\tvar dataset = datasets;                                                                                           // 64\n                                                                                                                    // 65\n\t\t// TODO remove this when typeahead.js will support minLength = 0                                                  // 66\n\t\tif (minLength === 0 && dataset.local) {                                                                           // 67\n\t\t\t// based on @snekse suggestion (see https://github.com/twitter/typeahead.js/pull/719)                            // 68\n\t\t\tvar altSource = dataset.source;                                                                                  // 69\n\t\t\tdataset.source = function(query, sync, async) {                                                                  // 70\n\t\t\t\treturn query ? altSource(query, sync, async) : sync(dataset.local());                                           // 71\n\t\t\t};                                                                                                               // 72\n\t\t}                                                                                                                 // 73\n                                                                                                                    // 74\n\t\tinstance = $e.typeahead(options, dataset);                                                                        // 75\n\t}                                                                                                                  // 76\n                                                                                                                    // 77\n\t// bind event handlers                                                                                             // 78\n\ttypeaheadEvents.forEach(function(name) {                                                                           // 79\n\t\tvar fn = resolve_template_function($e[0], $e.data(name));                                                         // 80\n\t\tif ($.isFunction(fn)) {                                                                                           // 81\n\t\t\tinstance.on('typeahead:' + name, fn);                                                                            // 82\n\t\t}                                                                                                                 // 83\n\t});                                                                                                                // 84\n                                                                                                                    // 85\n\t// fix to apply bootstrap form-control to tt-hint                                                                  // 86\n\t// TODO support other classes if needed                                                                            // 87\n\tif ($e.hasClass('form-control')) {                                                                                 // 88\n\t\t$e.parent('.twitter-typeahead').find('.tt-hint').addClass('form-control');                                        // 89\n\t}                                                                                                                  // 90\n                                                                                                                    // 91\n\t// TODO remove this when typeahead.js will support minLength = 0                                                   // 92\n\tif (minLength === 0) {                                                                                             // 93\n\t\t$e.on('focus', function() {                                                                                       // 94\n\t\t\tif ($e.val() === '') {                                                                                           // 95\n\t\t\t\t$e.data('ttTypeahead').input.trigger('queryChanged', '');                                                       // 96\n\t\t\t}                                                                                                                // 97\n\t\t});                                                                                                               // 98\n\t}                                                                                                                  // 99\n                                                                                                                    // 100\n\treturn instance;                                                                                                   // 101\n};                                                                                                                  // 102\n                                                                                                                    // 103\n/**                                                                                                                 // 104\n * Activates all typeahead elements.                                                                                // 105\n * @param selector (optional) selector to find typeahead elements to be activated                                   // 106\n */                                                                                                                 // 107\nMeteor.typeahead.inject = function(selector) {                                                                      // 108\n\tif (!selector) {                                                                                                   // 109\n\t\tselector = '.typeahead';                                                                                          // 110\n\t}                                                                                                                  // 111\n                                                                                                                    // 112\n\t// See if we have a template instance to reference                                                                 // 113\n\tvar template = Template.instance();                                                                                // 114\n\tif (!template) {                                                                                                   // 115\n\t\t// If we don't, just init on the entire DOM                                                                       // 116\n\t\t$(selector).each(init_typeahead);                                                                                 // 117\n\t} else {                                                                                                           // 118\n\t\t// Otherwise just init this template's typeaheads                                                                 // 119\n\t\ttemplate.$(selector).each(init_typeahead);                                                                        // 120\n\t}                                                                                                                  // 121\n};                                                                                                                  // 122\n                                                                                                                    // 123\nfunction init_typeahead(index, element) {                                                                           // 124\n\ttry {                                                                                                              // 125\n\t\tif (!$(element).data('ttTypeahead')) {                                                                            // 126\n\t\t\tMeteor.typeahead(element);                                                                                       // 127\n\t\t}                                                                                                                 // 128\n\t} catch (err) {                                                                                                    // 129\n\t\tconsole.log(err);                                                                                                 // 130\n\t\treturn;                                                                                                           // 131\n\t}                                                                                                                  // 132\n}                                                                                                                   // 133\n                                                                                                                    // 134\nfunction resolve_datasets($e, source) {                                                                             // 135\n\tvar element = $e[0];                                                                                               // 136\n\tvar datasets = $e.data('sources') || $e.data('sets');                                                              // 137\n\tif (datasets) {                                                                                                    // 138\n\t\tif (typeof datasets == 'string') {                                                                                // 139\n\t\t\tdatasets = resolve_template_function(element, datasets);                                                         // 140\n\t\t}                                                                                                                 // 141\n\t\tif ($.isFunction(datasets)) {                                                                                     // 142\n\t\t\tdatasets = datasets() || [];                                                                                     // 143\n\t\t}                                                                                                                 // 144\n\t\treturn datasets.map(function(ds) {                                                                                // 145\n\t\t\treturn make_bloodhound(ds);                                                                                      // 146\n\t\t});                                                                                                               // 147\n\t}                                                                                                                  // 148\n                                                                                                                    // 149\n\tvar name = normalize_dataset_name($e.attr('data-source-name') || $e.attr('name') || $e.attr('id') || 'dataset');   // 150\n\tvar limit = $e.data('limit');                                                                                      // 151\n\tvar templateName = $e.data('template'); // specifies name of custom template                                       // 152\n\tvar templates = $e.data('templates'); // specifies custom templates                                                // 153\n\tvar valueKey = $e.data('value-key') || 'value';                                                                    // 154\n\tvar minLength = get_min_length($e);                                                                                // 155\n                                                                                                                    // 156\n\tif (!source) {                                                                                                     // 157\n\t\tsource = $e.data('source') || [];                                                                                 // 158\n\t}                                                                                                                  // 159\n                                                                                                                    // 160\n\tvar dataset = {                                                                                                    // 161\n\t\tname: name,                                                                                                       // 162\n\t\tvalueKey: valueKey,                                                                                               // 163\n\t\tdisplayKey: valueKey,                                                                                             // 164\n\t\tminLength: minLength,                                                                                             // 165\n\t};                                                                                                                 // 166\n                                                                                                                    // 167\n\tif (limit) {                                                                                                       // 168\n\t\tdataset.limit = limit;                                                                                            // 169\n\t}                                                                                                                  // 170\n                                                                                                                    // 171\n\t// support for custom templates                                                                                    // 172\n\tif (templateName) {                                                                                                // 173\n\t\tdataset.template = templateName;                                                                                  // 174\n\t}                                                                                                                  // 175\n                                                                                                                    // 176\n\t// parse string with custom templates if it is specified                                                           // 177\n\tif (templates && typeof templates === 'string') {                                                                  // 178\n\t\tset_templates(dataset, templates);                                                                                // 179\n\t}                                                                                                                  // 180\n                                                                                                                    // 181\n\tdataset.templates = make_templates(dataset);                                                                       // 182\n                                                                                                                    // 183\n\tif (typeof source === 'string') {                                                                                  // 184\n\t\tdataset.async = true;                                                                                             // 185\n\t\tif (source.indexOf('/') >= 0) { // support prefetch urls                                                          // 186\n\t\t\tisprefetch = true;                                                                                               // 187\n\t\t\tdataset.prefetch = {                                                                                             // 188\n\t\t\t\turl: source,                                                                                                    // 189\n\t\t\t\tfilter: function(list) {                                                                                        // 190\n\t\t\t\t\treturn (list || []).map(value_wrapper(dataset));                                                               // 191\n\t\t\t\t}                                                                                                               // 192\n\t\t\t};                                                                                                               // 193\n\t\t\treturn make_bloodhound(dataset);                                                                                 // 194\n\t\t}                                                                                                                 // 195\n\t\tsource = resolve_data_source(element, source);                                                                    // 196\n\t}                                                                                                                  // 197\n                                                                                                                    // 198\n\tif ($.isArray(source) || ($.isFunction(source) && source.length === 0)) {                                          // 199\n\t\tdataset.local = source;                                                                                           // 200\n\t\treturn make_bloodhound(dataset);                                                                                  // 201\n\t}                                                                                                                  // 202\n                                                                                                                    // 203\n\tdataset.source = source;                                                                                           // 204\n                                                                                                                    // 205\n\treturn dataset;                                                                                                    // 206\n}                                                                                                                   // 207\n                                                                                                                    // 208\nfunction get_min_length($e) {                                                                                       // 209\n\tvar value = parseInt($e.data('min-length'));                                                                       // 210\n\treturn isNaN(value) || value < 0 ? 1 : value;                                                                      // 211\n}                                                                                                                   // 212\n                                                                                                                    // 213\n// typeahead.js throws error if dataset name does not meet /^[_a-zA-Z0-9-]+$/                                       // 214\nfunction normalize_dataset_name(name) {                                                                             // 215\n\treturn name.replace(/[\\]\\[\\.]/g, '_');                                                                             // 216\n}                                                                                                                   // 217\n                                                                                                                    // 218\n// Parses string with template names and set appropriate dataset properties.                                        // 219\nfunction set_templates(dataset, templates) {                                                                        // 220\n\tvar templateKeys = {                                                                                               // 221\n\t\theader: 1,                                                                                                        // 222\n\t\tfooter: 1,                                                                                                        // 223\n\t\tsuggestion: 1,                                                                                                    // 224\n\t\ttemplate: 1, // suggestion alias                                                                                  // 225\n\t\tnotFound: 1,                                                                                                      // 226\n\t\tempty: 1, // notFound alias                                                                                       // 227\n\t\tpending: 1                                                                                                        // 228\n\t};                                                                                                                 // 229\n\tvar pairs = templates.split(/[;,]+/);                                                                              // 230\n\tpairs.map(function(s) {                                                                                            // 231\n\t\tvar p = s.split(/[:=]+/).map(function(it) { return it.trim(); });                                                 // 232\n\t\tswitch (p.length) {                                                                                               // 233\n\t\t\tcase 1: // set suggestion template when no key is specified                                                      // 234\n\t\t\t\treturn ['template', p[0]];                                                                                      // 235\n\t\t\tcase 2:                                                                                                          // 236\n\t\t\t\treturn (p[0] in templateKeys) ? [p[0], p[1]] : null;                                                            // 237\n\t\t\tdefault:                                                                                                         // 238\n\t\t\t\treturn null;                                                                                                    // 239\n\t\t}                                                                                                                 // 240\n\t}).filter(identity).forEach(function(p) {                                                                          // 241\n\t\tdataset[p[0]] = p[1];                                                                                             // 242\n\t});                                                                                                                // 243\n}                                                                                                                   // 244\n                                                                                                                    // 245\n// Resolves data source function.                                                                                   // 246\nfunction resolve_data_source(element, name) {                                                                       // 247\n\tvar fn = resolve_template_function(element, name);                                                                 // 248\n\tif ($.isFunction(fn)) {                                                                                            // 249\n\t\treturn fn;                                                                                                        // 250\n\t}                                                                                                                  // 251\n                                                                                                                    // 252\n\t// collection.name                                                                                                 // 253\n\tvar path = name.split('.');                                                                                        // 254\n\tif (path.length > 0) {                                                                                             // 255\n\t\tvar collection = find_collection(path[0]);                                                                        // 256\n\t\tif (collection) {                                                                                                 // 257\n\t\t\tvar property = path.length > 1 ? path[1] : \"\";                                                                   // 258\n\t\t\treturn function() {                                                                                              // 259\n\t\t\t\treturn collection.find().fetch()                                                                                // 260\n\t\t\t\t\t.map(function(it) {                                                                                            // 261\n\t\t\t\t\t\tvar value = property ? it[property] : it.name || it.title;                                                    // 262\n\t\t\t\t\t\t// wrap to object to use object id in selected event handler                                                  // 263\n\t\t\t\t\t\treturn value ? {value: value, id: it._id} : \"\";                                                               // 264\n\t\t\t\t\t})                                                                                                             // 265\n\t\t\t\t\t.filter(identity);                                                                                             // 266\n\t\t\t};                                                                                                               // 267\n\t\t}                                                                                                                 // 268\n\t}                                                                                                                  // 269\n                                                                                                                    // 270\n\tconsole.log(\"Unable to resolve data source function '%s'.\", name);                                                 // 271\n\treturn [];                                                                                                         // 272\n}                                                                                                                   // 273\n                                                                                                                    // 274\nfunction find_collection(name) {                                                                                    // 275\n\tif (typeof Mongo != \"undefined\" && typeof Mongo.Collection != \"undefined\") {                                       // 276\n\t\t// when use dburles:mongo-collection-instances                                                                    // 277\n\t\tif ($.isFunction(Mongo.Collection.get)) {                                                                         // 278\n\t\t\treturn Mongo.Collection.get(name);                                                                               // 279\n\t\t}                                                                                                                 // 280\n\t}                                                                                                                  // 281\n\tif (global) {                                                                                                      // 282\n\t\treturn global[name] || global[name.toLowerCase()] || null;                                                        // 283\n\t}                                                                                                                  // 284\n\treturn null;                                                                                                       // 285\n}                                                                                                                   // 286\n                                                                                                                    // 287\n// Resolves function with specified name from context of given element.                                             // 288\nfunction resolve_template_function(element, name) {                                                                 // 289\n\tvar fn = null;                                                                                                     // 290\n\tvar opts = {sync:false};                                                                                           // 291\n\t// traverse view hierarchy and find helper function                                                                // 292\n\tvar view = Blaze.getView(element);                                                                                 // 293\n\twhile (view) {                                                                                                     // 294\n\t\tfn = resolve_helper(view, name, opts);                                                                            // 295\n\t\tif ($.isFunction(fn)) {                                                                                           // 296\n\t\t\tbreak;                                                                                                           // 297\n\t\t}                                                                                                                 // 298\n\t\tview = view.parentView;                                                                                           // 299\n\t}                                                                                                                  // 300\n                                                                                                                    // 301\n\tif (!$.isFunction(fn)) {                                                                                           // 302\n\t\treturn null;                                                                                                      // 303\n\t}                                                                                                                  // 304\n                                                                                                                    // 305\n\t// calls template helper function with Template.instance() context                                                 // 306\n\tfunction invoke(args) {                                                                                            // 307\n\t\t// use Blaze._withCurrentView internal function to set current view                                               // 308\n\t\t// also since meteor 1.2 no need to use Template._withTemplateInstanceFunc                                        // 309\n\t\t// since the function is already bound to template instance                                                       // 310\n\t\treturn Blaze._withCurrentView(view, function() {                                                                  // 311\n\t\t\treturn fn.apply(null, args);                                                                                     // 312\n\t\t});                                                                                                               // 313\n\t}                                                                                                                  // 314\n                                                                                                                    // 315\n\tif (opts.sync) { // local dataset?                                                                                 // 316\n\t\treturn function() {                                                                                               // 317\n\t\t\treturn invoke(Array.prototype.slice.call(arguments));                                                            // 318\n\t\t};                                                                                                                // 319\n\t}                                                                                                                  // 320\n\t// async data source                                                                                               // 321\n\treturn function(a) {                                                                                               // 322\n\t\treturn invoke(Array.prototype.slice.call(arguments));                                                             // 323\n\t};                                                                                                                 // 324\n}                                                                                                                   // 325\n                                                                                                                    // 326\nfunction resolve_helper(view, name, opts) {                                                                         // 327\n\tif (!view.template) {                                                                                              // 328\n\t\treturn null;                                                                                                      // 329\n\t}                                                                                                                  // 330\n\t// we need to known whether the helper function is async                                                           // 331\n\t// use view.template.__helpers to determine that                                                                   // 332\n\t// since meteor 1.2 Blaze._getTemplateHelper wraps                                                                 // 333\n\t// the helper function binding it to template context                                                              // 334\n\tvar fn = view.template.__helpers.get(name) || view.template[name];                                                 // 335\n\tif (!$.isFunction(fn)) {                                                                                           // 336\n\t\treturn null;                                                                                                      // 337\n\t}                                                                                                                  // 338\n\topts.sync = fn.length === 0;                                                                                       // 339\n\treturn Blaze._getTemplateHelper(view.template, name, function() {                                                  // 340\n\t\treturn view.templateInstance();                                                                                   // 341\n\t});                                                                                                                // 342\n}                                                                                                                   // 343\n                                                                                                                    // 344\n// Returns HTML template function that generates HTML string using data from suggestion item.                       // 345\n// This function is implemented using given meteor template specified by templateName argument.                     // 346\nfunction make_template_function(templateName) {                                                                     // 347\n\tif (!templateName) {                                                                                               // 348\n\t\tthrow new Error(\"templateName is not specified\");                                                                 // 349\n\t}                                                                                                                  // 350\n                                                                                                                    // 351\n\tvar tmpl = Template[templateName];                                                                                 // 352\n\tif (!tmpl) {                                                                                                       // 353\n\t\tthrow new Error(\"Template '\" + templateName  + \"' is not defined\");                                               // 354\n\t}                                                                                                                  // 355\n                                                                                                                    // 356\n\treturn function(context) {                                                                                         // 357\n\t\tvar div = $(\"<div/>\");                                                                                            // 358\n\t\tif ($.isFunction(Blaze.renderWithData)) {                                                                         // 359\n\t\t\tBlaze.renderWithData(tmpl, context, div[0]);                                                                     // 360\n\t\t} else { // for meteor < v0.9                                                                                     // 361\n\t\t\tvar range = UI.renderWithData(tmpl, context);                                                                    // 362\n\t\t\tUI.insert(range, div[0]);                                                                                        // 363\n\t\t}                                                                                                                 // 364\n\t\t// return html wrapped into div to avoid visual issues                                                            // 365\n\t\treturn div[0].outerHTML;                                                                                          // 366\n\t};                                                                                                                 // 367\n}                                                                                                                   // 368\n                                                                                                                    // 369\n// Creates object with template functions (for header, footer, suggestion, empty templates).                        // 370\nfunction make_templates(dataset) {                                                                                  // 371\n                                                                                                                    // 372\n\tfunction make(value) {                                                                                             // 373\n\t\tif (!value) {                                                                                                     // 374\n\t\t\treturn null;                                                                                                     // 375\n\t\t}                                                                                                                 // 376\n\t\tif (typeof value === \"string\") {                                                                                  // 377\n\t\t\tif (value.indexOf('<') >= 0) { // detect HTML string                                                             // 378\n\t\t\t\treturn value;                                                                                                   // 379\n\t\t\t}                                                                                                                // 380\n\t\t\treturn make_template_function(value);                                                                            // 381\n\t\t}                                                                                                                 // 382\n\t\treturn $.isFunction(value) ? value : null;                                                                        // 383\n\t}                                                                                                                  // 384\n                                                                                                                    // 385\n\tvar templates = {                                                                                                  // 386\n\t\theader: make(dataset.header),                                                                                     // 387\n\t\tfooter: make(dataset.footer),                                                                                     // 388\n\t\tsuggestion: make(dataset.suggestion || dataset.template),                                                         // 389\n\t\tnotFound: make(dataset.notFound || dataset.empty),                                                                // 390\n\t\tpending: make(dataset.pending)                                                                                    // 391\n\t};                                                                                                                 // 392\n                                                                                                                    // 393\n\treturn Object.keys(templates)                                                                                      // 394\n\t\t.filter(function(key) { return templates[key]; })                                                                 // 395\n\t\t.reduce(function(result, key) {                                                                                   // 396\n\t\t\tresult[key] = templates[key];                                                                                    // 397\n\t\t\treturn result;                                                                                                   // 398\n\t\t}, {});                                                                                                           // 399\n}                                                                                                                   // 400\n                                                                                                                    // 401\n// Returns function to map string value to plain JS object required by typeahead.                                   // 402\nfunction value_wrapper(dataset) {                                                                                   // 403\n\treturn function(value) {                                                                                           // 404\n\t\tif (typeof value === 'object') {                                                                                  // 405\n\t\t\treturn value;                                                                                                    // 406\n\t\t}                                                                                                                 // 407\n\t\tvar item = {};                                                                                                    // 408\n\t\titem[dataset.valueKey] = value;                                                                                   // 409\n\t\treturn item;                                                                                                      // 410\n\t};                                                                                                                 // 411\n}                                                                                                                   // 412\n                                                                                                                    // 413\n// Creates Bloodhound suggestion engine based on given dataset.                                                     // 414\nfunction make_bloodhound(dataset) {                                                                                 // 415\n\tif (!dataset.template) {                                                                                           // 416\n\t\tif (Array.isArray(dataset.local)) {                                                                               // 417\n\t\t\tdataset.local = dataset.local.map(value_wrapper(dataset));                                                       // 418\n\t\t} else if ($.isFunction(dataset.local) && dataset.local.length === 0) {                                           // 419\n\t\t\tvar localFn = dataset.local;                                                                                     // 420\n\t\t\tdataset.local = function() {                                                                                     // 421\n\t\t\t\treturn (localFn() || []).map(value_wrapper(dataset));                                                           // 422\n\t\t\t};                                                                                                               // 423\n\t\t}                                                                                                                 // 424\n\t}                                                                                                                  // 425\n                                                                                                                    // 426\n\tvar need_bloodhound = dataset.prefetch || Array.isArray(dataset.local) ||                                          // 427\n\t\t$.isFunction(dataset.local) && dataset.local.length === 0;                                                        // 428\n                                                                                                                    // 429\n\tvar engine;                                                                                                        // 430\n                                                                                                                    // 431\n\tif (need_bloodhound) {                                                                                             // 432\n\t\tvar options = $.extend({}, dataset, {                                                                             // 433\n\t\t\t// TODO support custom tokenizers                                                                                // 434\n\t\t\tdatumTokenizer: Bloodhound.tokenizers.obj.whitespace(dataset.valueKey),                                          // 435\n\t\t\tqueryTokenizer: Bloodhound.tokenizers.whitespace                                                                 // 436\n\t\t});                                                                                                               // 437\n                                                                                                                    // 438\n\t\tengine = new Bloodhound(options);                                                                                 // 439\n\t\tengine.initialize();                                                                                              // 440\n                                                                                                                    // 441\n\t\tif ($.isFunction(dataset.local) && dataset.local.length === 0) {                                                  // 442\n\t\t\t// update data source on changing deps of local function                                                         // 443\n\t\t\t// TODO find better (functional) way to do that                                                                  // 444\n\t\t\tvar tracker = Template.instance() || Tracker;                                                                    // 445\n\t\t\ttracker.autorun(function(comp) {                                                                                 // 446\n\t\t\t\t// TODO stop tracking if typeahead is explicitly destroyed (issue #70)                                          // 447\n\t\t\t\tengine = new Bloodhound(options);                                                                               // 448\n\t\t\t\tengine.initialize();                                                                                            // 449\n\t\t\t});                                                                                                              // 450\n\t\t}                                                                                                                 // 451\n\t}                                                                                                                  // 452\n                                                                                                                    // 453\n\tfunction bloodhound_source(query, cb) {                                                                            // 454\n\t\tvar fn = engine.ttAdapter();                                                                                      // 455\n\t\treturn fn(query, cb);                                                                                             // 456\n\t}                                                                                                                  // 457\n                                                                                                                    // 458\n\tvar src = need_bloodhound || typeof dataset.local !== 'undefined' ?                                                // 459\n\t\t{source: need_bloodhound ? bloodhound_source : dataset.local}                                                     // 460\n\t\t: {};                                                                                                             // 461\n                                                                                                                    // 462\n\tvar templates = typeof dataset.templates === 'undefined' ?                                                         // 463\n\t\t{templates: make_templates(dataset)}                                                                              // 464\n\t\t: {};                                                                                                             // 465\n                                                                                                                    // 466\n\treturn $.extend({}, dataset, src, templates);                                                                      // 467\n}                                                                                                                   // 468\n                                                                                                                    // 469\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}).call(this);\n\n\n/* Exports */\nif (typeof Package === 'undefined') Package = {};\nPackage['sergeyt:typeahead'] = {};\n\n})();\n","servePath":"/packages/sergeyt_typeahead.js","sourceMap":{"version":3,"sources":["/packages/sergeyt_typeahead/typeahead.bundle.js","/packages/sergeyt_typeahead/index.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2H;;;;;;;;;;;;;;;;;;AC/4EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0H","file":"/packages/sergeyt_typeahead.js","sourcesContent":["/*!\n * typeahead.js 0.11.1\n * https://github.com/twitter/typeahead.js\n * Copyright 2013-2015 Twitter, Inc. and other contributors; Licensed MIT\n */\n\n(function(root, factory) {\n    if (typeof define === \"function\" && define.amd) {\n        define(\"bloodhound\", [ \"jquery\" ], function(a0) {\n            return root[\"Bloodhound\"] = factory(a0);\n        });\n    } else if (typeof exports === \"object\") {\n        module.exports = factory(require(\"jquery\"));\n    } else {\n        root[\"Bloodhound\"] = factory(jQuery);\n    }\n})(this, function($) {\n    var _ = function() {\n        \"use strict\";\n        return {\n            isMsie: function() {\n                return /(msie|trident)/i.test(navigator.userAgent) ? navigator.userAgent.match(/(msie |rv:)(\\d+(.\\d+)?)/i)[2] : false;\n            },\n            isBlankString: function(str) {\n                return !str || /^\\s*$/.test(str);\n            },\n            escapeRegExChars: function(str) {\n                return str.replace(/[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g, \"\\\\$&\");\n            },\n            isString: function(obj) {\n                return typeof obj === \"string\";\n            },\n            isNumber: function(obj) {\n                return typeof obj === \"number\";\n            },\n            isArray: $.isArray,\n            isFunction: $.isFunction,\n            isObject: $.isPlainObject,\n            isUndefined: function(obj) {\n                return typeof obj === \"undefined\";\n            },\n            isElement: function(obj) {\n                return !!(obj && obj.nodeType === 1);\n            },\n            isJQuery: function(obj) {\n                return obj instanceof $;\n            },\n            toStr: function toStr(s) {\n                return _.isUndefined(s) || s === null ? \"\" : s + \"\";\n            },\n            bind: $.proxy,\n            each: function(collection, cb) {\n                $.each(collection, reverseArgs);\n                function reverseArgs(index, value) {\n                    return cb(value, index);\n                }\n            },\n            map: $.map,\n            filter: $.grep,\n            every: function(obj, test) {\n                var result = true;\n                if (!obj) {\n                    return result;\n                }\n                $.each(obj, function(key, val) {\n                    if (!(result = test.call(null, val, key, obj))) {\n                        return false;\n                    }\n                });\n                return !!result;\n            },\n            some: function(obj, test) {\n                var result = false;\n                if (!obj) {\n                    return result;\n                }\n                $.each(obj, function(key, val) {\n                    if (result = test.call(null, val, key, obj)) {\n                        return false;\n                    }\n                });\n                return !!result;\n            },\n            mixin: $.extend,\n            identity: function(x) {\n                return x;\n            },\n            clone: function(obj) {\n                return $.extend(true, {}, obj);\n            },\n            getIdGenerator: function() {\n                var counter = 0;\n                return function() {\n                    return counter++;\n                };\n            },\n            templatify: function templatify(obj) {\n                return $.isFunction(obj) ? obj : template;\n                function template() {\n                    return String(obj);\n                }\n            },\n            defer: function(fn) {\n                setTimeout(fn, 0);\n            },\n            debounce: function(func, wait, immediate) {\n                var timeout, result;\n                return function() {\n                    var context = this, args = arguments, later, callNow;\n                    later = function() {\n                        timeout = null;\n                        if (!immediate) {\n                            result = func.apply(context, args);\n                        }\n                    };\n                    callNow = immediate && !timeout;\n                    clearTimeout(timeout);\n                    timeout = setTimeout(later, wait);\n                    if (callNow) {\n                        result = func.apply(context, args);\n                    }\n                    return result;\n                };\n            },\n            throttle: function(func, wait) {\n                var context, args, timeout, result, previous, later;\n                previous = 0;\n                later = function() {\n                    previous = new Date();\n                    timeout = null;\n                    result = func.apply(context, args);\n                };\n                return function() {\n                    var now = new Date(), remaining = wait - (now - previous);\n                    context = this;\n                    args = arguments;\n                    if (remaining <= 0) {\n                        clearTimeout(timeout);\n                        timeout = null;\n                        previous = now;\n                        result = func.apply(context, args);\n                    } else if (!timeout) {\n                        timeout = setTimeout(later, remaining);\n                    }\n                    return result;\n                };\n            },\n            stringify: function(val) {\n                return _.isString(val) ? val : JSON.stringify(val);\n            },\n            noop: function() {}\n        };\n    }();\n    var VERSION = \"0.11.1\";\n    var tokenizers = function() {\n        \"use strict\";\n        return {\n            nonword: nonword,\n            whitespace: whitespace,\n            obj: {\n                nonword: getObjTokenizer(nonword),\n                whitespace: getObjTokenizer(whitespace)\n            }\n        };\n        function whitespace(str) {\n            str = _.toStr(str);\n            return str ? str.split(/\\s+/) : [];\n        }\n        function nonword(str) {\n            str = _.toStr(str);\n            return str ? str.split(/\\W+/) : [];\n        }\n        function getObjTokenizer(tokenizer) {\n            return function setKey(keys) {\n                keys = _.isArray(keys) ? keys : [].slice.call(arguments, 0);\n                return function tokenize(o) {\n                    var tokens = [];\n                    _.each(keys, function(k) {\n                        tokens = tokens.concat(tokenizer(_.toStr(o[k])));\n                    });\n                    return tokens;\n                };\n            };\n        }\n    }();\n    var LruCache = function() {\n        \"use strict\";\n        function LruCache(maxSize) {\n            this.maxSize = _.isNumber(maxSize) ? maxSize : 100;\n            this.reset();\n            if (this.maxSize <= 0) {\n                this.set = this.get = $.noop;\n            }\n        }\n        _.mixin(LruCache.prototype, {\n            set: function set(key, val) {\n                var tailItem = this.list.tail, node;\n                if (this.size >= this.maxSize) {\n                    this.list.remove(tailItem);\n                    delete this.hash[tailItem.key];\n                    this.size--;\n                }\n                if (node = this.hash[key]) {\n                    node.val = val;\n                    this.list.moveToFront(node);\n                } else {\n                    node = new Node(key, val);\n                    this.list.add(node);\n                    this.hash[key] = node;\n                    this.size++;\n                }\n            },\n            get: function get(key) {\n                var node = this.hash[key];\n                if (node) {\n                    this.list.moveToFront(node);\n                    return node.val;\n                }\n            },\n            reset: function reset() {\n                this.size = 0;\n                this.hash = {};\n                this.list = new List();\n            }\n        });\n        function List() {\n            this.head = this.tail = null;\n        }\n        _.mixin(List.prototype, {\n            add: function add(node) {\n                if (this.head) {\n                    node.next = this.head;\n                    this.head.prev = node;\n                }\n                this.head = node;\n                this.tail = this.tail || node;\n            },\n            remove: function remove(node) {\n                node.prev ? node.prev.next = node.next : this.head = node.next;\n                node.next ? node.next.prev = node.prev : this.tail = node.prev;\n            },\n            moveToFront: function(node) {\n                this.remove(node);\n                this.add(node);\n            }\n        });\n        function Node(key, val) {\n            this.key = key;\n            this.val = val;\n            this.prev = this.next = null;\n        }\n        return LruCache;\n    }();\n    var PersistentStorage = function() {\n        \"use strict\";\n        var LOCAL_STORAGE;\n        try {\n            LOCAL_STORAGE = window.localStorage;\n            LOCAL_STORAGE.setItem(\"~~~\", \"!\");\n            LOCAL_STORAGE.removeItem(\"~~~\");\n        } catch (err) {\n            LOCAL_STORAGE = null;\n        }\n        function PersistentStorage(namespace, override) {\n            this.prefix = [ \"__\", namespace, \"__\" ].join(\"\");\n            this.ttlKey = \"__ttl__\";\n            this.keyMatcher = new RegExp(\"^\" + _.escapeRegExChars(this.prefix));\n            this.ls = override || LOCAL_STORAGE;\n            !this.ls && this._noop();\n        }\n        _.mixin(PersistentStorage.prototype, {\n            _prefix: function(key) {\n                return this.prefix + key;\n            },\n            _ttlKey: function(key) {\n                return this._prefix(key) + this.ttlKey;\n            },\n            _noop: function() {\n                this.get = this.set = this.remove = this.clear = this.isExpired = _.noop;\n            },\n            _safeSet: function(key, val) {\n                try {\n                    this.ls.setItem(key, val);\n                } catch (err) {\n                    if (err.name === \"QuotaExceededError\") {\n                        this.clear();\n                        this._noop();\n                    }\n                }\n            },\n            get: function(key) {\n                if (this.isExpired(key)) {\n                    this.remove(key);\n                }\n                return decode(this.ls.getItem(this._prefix(key)));\n            },\n            set: function(key, val, ttl) {\n                if (_.isNumber(ttl)) {\n                    this._safeSet(this._ttlKey(key), encode(now() + ttl));\n                } else {\n                    this.ls.removeItem(this._ttlKey(key));\n                }\n                return this._safeSet(this._prefix(key), encode(val));\n            },\n            remove: function(key) {\n                this.ls.removeItem(this._ttlKey(key));\n                this.ls.removeItem(this._prefix(key));\n                return this;\n            },\n            clear: function() {\n                var i, keys = gatherMatchingKeys(this.keyMatcher);\n                for (i = keys.length; i--; ) {\n                    this.remove(keys[i]);\n                }\n                return this;\n            },\n            isExpired: function(key) {\n                var ttl = decode(this.ls.getItem(this._ttlKey(key)));\n                return _.isNumber(ttl) && now() > ttl ? true : false;\n            }\n        });\n        return PersistentStorage;\n        function now() {\n            return new Date().getTime();\n        }\n        function encode(val) {\n            return JSON.stringify(_.isUndefined(val) ? null : val);\n        }\n        function decode(val) {\n            return $.parseJSON(val);\n        }\n        function gatherMatchingKeys(keyMatcher) {\n            var i, key, keys = [], len = LOCAL_STORAGE.length;\n            for (i = 0; i < len; i++) {\n                if ((key = LOCAL_STORAGE.key(i)).match(keyMatcher)) {\n                    keys.push(key.replace(keyMatcher, \"\"));\n                }\n            }\n            return keys;\n        }\n    }();\n    var Transport = function() {\n        \"use strict\";\n        var pendingRequestsCount = 0, pendingRequests = {}, maxPendingRequests = 6, sharedCache = new LruCache(10);\n        function Transport(o) {\n            o = o || {};\n            this.cancelled = false;\n            this.lastReq = null;\n            this._send = o.transport;\n            this._get = o.limiter ? o.limiter(this._get) : this._get;\n            this._cache = o.cache === false ? new LruCache(0) : sharedCache;\n        }\n        Transport.setMaxPendingRequests = function setMaxPendingRequests(num) {\n            maxPendingRequests = num;\n        };\n        Transport.resetCache = function resetCache() {\n            sharedCache.reset();\n        };\n        _.mixin(Transport.prototype, {\n            _fingerprint: function fingerprint(o) {\n                o = o || {};\n                return o.url + o.type + $.param(o.data || {});\n            },\n            _get: function(o, cb) {\n                var that = this, fingerprint, jqXhr;\n                fingerprint = this._fingerprint(o);\n                if (this.cancelled || fingerprint !== this.lastReq) {\n                    return;\n                }\n                if (jqXhr = pendingRequests[fingerprint]) {\n                    jqXhr.done(done).fail(fail);\n                } else if (pendingRequestsCount < maxPendingRequests) {\n                    pendingRequestsCount++;\n                    pendingRequests[fingerprint] = this._send(o).done(done).fail(fail).always(always);\n                } else {\n                    this.onDeckRequestArgs = [].slice.call(arguments, 0);\n                }\n                function done(resp) {\n                    cb(null, resp);\n                    that._cache.set(fingerprint, resp);\n                }\n                function fail() {\n                    cb(true);\n                }\n                function always() {\n                    pendingRequestsCount--;\n                    delete pendingRequests[fingerprint];\n                    if (that.onDeckRequestArgs) {\n                        that._get.apply(that, that.onDeckRequestArgs);\n                        that.onDeckRequestArgs = null;\n                    }\n                }\n            },\n            get: function(o, cb) {\n                var resp, fingerprint;\n                cb = cb || $.noop;\n                o = _.isString(o) ? {\n                    url: o\n                } : o || {};\n                fingerprint = this._fingerprint(o);\n                this.cancelled = false;\n                this.lastReq = fingerprint;\n                if (resp = this._cache.get(fingerprint)) {\n                    cb(null, resp);\n                } else {\n                    this._get(o, cb);\n                }\n            },\n            cancel: function() {\n                this.cancelled = true;\n            }\n        });\n        return Transport;\n    }();\n    var SearchIndex = window.SearchIndex = function() {\n        \"use strict\";\n        var CHILDREN = \"c\", IDS = \"i\";\n        function SearchIndex(o) {\n            o = o || {};\n            if (!o.datumTokenizer || !o.queryTokenizer) {\n                $.error(\"datumTokenizer and queryTokenizer are both required\");\n            }\n            this.identify = o.identify || _.stringify;\n            this.datumTokenizer = o.datumTokenizer;\n            this.queryTokenizer = o.queryTokenizer;\n            this.reset();\n        }\n        _.mixin(SearchIndex.prototype, {\n            bootstrap: function bootstrap(o) {\n                this.datums = o.datums;\n                this.trie = o.trie;\n            },\n            add: function(data) {\n                var that = this;\n                data = _.isArray(data) ? data : [ data ];\n                _.each(data, function(datum) {\n                    var id, tokens;\n                    that.datums[id = that.identify(datum)] = datum;\n                    tokens = normalizeTokens(that.datumTokenizer(datum));\n                    _.each(tokens, function(token) {\n                        var node, chars, ch;\n                        node = that.trie;\n                        chars = token.split(\"\");\n                        while (ch = chars.shift()) {\n                            node = node[CHILDREN][ch] || (node[CHILDREN][ch] = newNode());\n                            node[IDS].push(id);\n                        }\n                    });\n                });\n            },\n            get: function get(ids) {\n                var that = this;\n                return _.map(ids, function(id) {\n                    return that.datums[id];\n                });\n            },\n            search: function search(query) {\n                var that = this, tokens, matches;\n                tokens = normalizeTokens(this.queryTokenizer(query));\n                _.each(tokens, function(token) {\n                    var node, chars, ch, ids;\n                    if (matches && matches.length === 0) {\n                        return false;\n                    }\n                    node = that.trie;\n                    chars = token.split(\"\");\n                    while (node && (ch = chars.shift())) {\n                        node = node[CHILDREN][ch];\n                    }\n                    if (node && chars.length === 0) {\n                        ids = node[IDS].slice(0);\n                        matches = matches ? getIntersection(matches, ids) : ids;\n                    } else {\n                        matches = [];\n                        return false;\n                    }\n                });\n                return matches ? _.map(unique(matches), function(id) {\n                    return that.datums[id];\n                }) : [];\n            },\n            all: function all() {\n                var values = [];\n                for (var key in this.datums) {\n                    values.push(this.datums[key]);\n                }\n                return values;\n            },\n            reset: function reset() {\n                this.datums = {};\n                this.trie = newNode();\n            },\n            serialize: function serialize() {\n                return {\n                    datums: this.datums,\n                    trie: this.trie\n                };\n            }\n        });\n        return SearchIndex;\n        function normalizeTokens(tokens) {\n            tokens = _.filter(tokens, function(token) {\n                return !!token;\n            });\n            tokens = _.map(tokens, function(token) {\n                return token.toLowerCase();\n            });\n            return tokens;\n        }\n        function newNode() {\n            var node = {};\n            node[IDS] = [];\n            node[CHILDREN] = {};\n            return node;\n        }\n        function unique(array) {\n            var seen = {}, uniques = [];\n            for (var i = 0, len = array.length; i < len; i++) {\n                if (!seen[array[i]]) {\n                    seen[array[i]] = true;\n                    uniques.push(array[i]);\n                }\n            }\n            return uniques;\n        }\n        function getIntersection(arrayA, arrayB) {\n            var ai = 0, bi = 0, intersection = [];\n            arrayA = arrayA.sort();\n            arrayB = arrayB.sort();\n            var lenArrayA = arrayA.length, lenArrayB = arrayB.length;\n            while (ai < lenArrayA && bi < lenArrayB) {\n                if (arrayA[ai] < arrayB[bi]) {\n                    ai++;\n                } else if (arrayA[ai] > arrayB[bi]) {\n                    bi++;\n                } else {\n                    intersection.push(arrayA[ai]);\n                    ai++;\n                    bi++;\n                }\n            }\n            return intersection;\n        }\n    }();\n    var Prefetch = function() {\n        \"use strict\";\n        var keys;\n        keys = {\n            data: \"data\",\n            protocol: \"protocol\",\n            thumbprint: \"thumbprint\"\n        };\n        function Prefetch(o) {\n            this.url = o.url;\n            this.ttl = o.ttl;\n            this.cache = o.cache;\n            this.prepare = o.prepare;\n            this.transform = o.transform;\n            this.transport = o.transport;\n            this.thumbprint = o.thumbprint;\n            this.storage = new PersistentStorage(o.cacheKey);\n        }\n        _.mixin(Prefetch.prototype, {\n            _settings: function settings() {\n                return {\n                    url: this.url,\n                    type: \"GET\",\n                    dataType: \"json\"\n                };\n            },\n            store: function store(data) {\n                if (!this.cache) {\n                    return;\n                }\n                this.storage.set(keys.data, data, this.ttl);\n                this.storage.set(keys.protocol, location.protocol, this.ttl);\n                this.storage.set(keys.thumbprint, this.thumbprint, this.ttl);\n            },\n            fromCache: function fromCache() {\n                var stored = {}, isExpired;\n                if (!this.cache) {\n                    return null;\n                }\n                stored.data = this.storage.get(keys.data);\n                stored.protocol = this.storage.get(keys.protocol);\n                stored.thumbprint = this.storage.get(keys.thumbprint);\n                isExpired = stored.thumbprint !== this.thumbprint || stored.protocol !== location.protocol;\n                return stored.data && !isExpired ? stored.data : null;\n            },\n            fromNetwork: function(cb) {\n                var that = this, settings;\n                if (!cb) {\n                    return;\n                }\n                settings = this.prepare(this._settings());\n                this.transport(settings).fail(onError).done(onResponse);\n                function onError() {\n                    cb(true);\n                }\n                function onResponse(resp) {\n                    cb(null, that.transform(resp));\n                }\n            },\n            clear: function clear() {\n                this.storage.clear();\n                return this;\n            }\n        });\n        return Prefetch;\n    }();\n    var Remote = function() {\n        \"use strict\";\n        function Remote(o) {\n            this.url = o.url;\n            this.prepare = o.prepare;\n            this.transform = o.transform;\n            this.transport = new Transport({\n                cache: o.cache,\n                limiter: o.limiter,\n                transport: o.transport\n            });\n        }\n        _.mixin(Remote.prototype, {\n            _settings: function settings() {\n                return {\n                    url: this.url,\n                    type: \"GET\",\n                    dataType: \"json\"\n                };\n            },\n            get: function get(query, cb) {\n                var that = this, settings;\n                if (!cb) {\n                    return;\n                }\n                query = query || \"\";\n                settings = this.prepare(query, this._settings());\n                return this.transport.get(settings, onResponse);\n                function onResponse(err, resp) {\n                    err ? cb([]) : cb(that.transform(resp));\n                }\n            },\n            cancelLastRequest: function cancelLastRequest() {\n                this.transport.cancel();\n            }\n        });\n        return Remote;\n    }();\n    var oParser = function() {\n        \"use strict\";\n        return function parse(o) {\n            var defaults, sorter;\n            defaults = {\n                initialize: true,\n                identify: _.stringify,\n                datumTokenizer: null,\n                queryTokenizer: null,\n                sufficient: 5,\n                sorter: null,\n                local: [],\n                prefetch: null,\n                remote: null\n            };\n            o = _.mixin(defaults, o || {});\n            !o.datumTokenizer && $.error(\"datumTokenizer is required\");\n            !o.queryTokenizer && $.error(\"queryTokenizer is required\");\n            sorter = o.sorter;\n            o.sorter = sorter ? function(x) {\n                return x.sort(sorter);\n            } : _.identity;\n            o.local = _.isFunction(o.local) ? o.local() : o.local;\n            o.prefetch = parsePrefetch(o.prefetch);\n            o.remote = parseRemote(o.remote);\n            return o;\n        };\n        function parsePrefetch(o) {\n            var defaults;\n            if (!o) {\n                return null;\n            }\n            defaults = {\n                url: null,\n                ttl: 24 * 60 * 60 * 1e3,\n                cache: true,\n                cacheKey: null,\n                thumbprint: \"\",\n                prepare: _.identity,\n                transform: _.identity,\n                transport: null\n            };\n            o = _.isString(o) ? {\n                url: o\n            } : o;\n            o = _.mixin(defaults, o);\n            !o.url && $.error(\"prefetch requires url to be set\");\n            o.transform = o.filter || o.transform;\n            o.cacheKey = o.cacheKey || o.url;\n            o.thumbprint = VERSION + o.thumbprint;\n            o.transport = o.transport ? callbackToDeferred(o.transport) : $.ajax;\n            return o;\n        }\n        function parseRemote(o) {\n            var defaults;\n            if (!o) {\n                return;\n            }\n            defaults = {\n                url: null,\n                cache: true,\n                prepare: null,\n                replace: null,\n                wildcard: null,\n                limiter: null,\n                rateLimitBy: \"debounce\",\n                rateLimitWait: 300,\n                transform: _.identity,\n                transport: null\n            };\n            o = _.isString(o) ? {\n                url: o\n            } : o;\n            o = _.mixin(defaults, o);\n            !o.url && $.error(\"remote requires url to be set\");\n            o.transform = o.filter || o.transform;\n            o.prepare = toRemotePrepare(o);\n            o.limiter = toLimiter(o);\n            o.transport = o.transport ? callbackToDeferred(o.transport) : $.ajax;\n            delete o.replace;\n            delete o.wildcard;\n            delete o.rateLimitBy;\n            delete o.rateLimitWait;\n            return o;\n        }\n        function toRemotePrepare(o) {\n            var prepare, replace, wildcard;\n            prepare = o.prepare;\n            replace = o.replace;\n            wildcard = o.wildcard;\n            if (prepare) {\n                return prepare;\n            }\n            if (replace) {\n                prepare = prepareByReplace;\n            } else if (o.wildcard) {\n                prepare = prepareByWildcard;\n            } else {\n                prepare = idenityPrepare;\n            }\n            return prepare;\n            function prepareByReplace(query, settings) {\n                settings.url = replace(settings.url, query);\n                return settings;\n            }\n            function prepareByWildcard(query, settings) {\n                settings.url = settings.url.replace(wildcard, encodeURIComponent(query));\n                return settings;\n            }\n            function idenityPrepare(query, settings) {\n                return settings;\n            }\n        }\n        function toLimiter(o) {\n            var limiter, method, wait;\n            limiter = o.limiter;\n            method = o.rateLimitBy;\n            wait = o.rateLimitWait;\n            if (!limiter) {\n                limiter = /^throttle$/i.test(method) ? throttle(wait) : debounce(wait);\n            }\n            return limiter;\n            function debounce(wait) {\n                return function debounce(fn) {\n                    return _.debounce(fn, wait);\n                };\n            }\n            function throttle(wait) {\n                return function throttle(fn) {\n                    return _.throttle(fn, wait);\n                };\n            }\n        }\n        function callbackToDeferred(fn) {\n            return function wrapper(o) {\n                var deferred = $.Deferred();\n                fn(o, onSuccess, onError);\n                return deferred;\n                function onSuccess(resp) {\n                    _.defer(function() {\n                        deferred.resolve(resp);\n                    });\n                }\n                function onError(err) {\n                    _.defer(function() {\n                        deferred.reject(err);\n                    });\n                }\n            };\n        }\n    }();\n    var Bloodhound = function() {\n        \"use strict\";\n        var old;\n        old = window && window.Bloodhound;\n        function Bloodhound(o) {\n            o = oParser(o);\n            this.sorter = o.sorter;\n            this.identify = o.identify;\n            this.sufficient = o.sufficient;\n            this.local = o.local;\n            this.remote = o.remote ? new Remote(o.remote) : null;\n            this.prefetch = o.prefetch ? new Prefetch(o.prefetch) : null;\n            this.index = new SearchIndex({\n                identify: this.identify,\n                datumTokenizer: o.datumTokenizer,\n                queryTokenizer: o.queryTokenizer\n            });\n            o.initialize !== false && this.initialize();\n        }\n        Bloodhound.noConflict = function noConflict() {\n            window && (window.Bloodhound = old);\n            return Bloodhound;\n        };\n        Bloodhound.tokenizers = tokenizers;\n        _.mixin(Bloodhound.prototype, {\n            __ttAdapter: function ttAdapter() {\n                var that = this;\n                return this.remote ? withAsync : withoutAsync;\n                function withAsync(query, sync, async) {\n                    return that.search(query, sync, async);\n                }\n                function withoutAsync(query, sync) {\n                    return that.search(query, sync);\n                }\n            },\n            _loadPrefetch: function loadPrefetch() {\n                var that = this, deferred, serialized;\n                deferred = $.Deferred();\n                if (!this.prefetch) {\n                    deferred.resolve();\n                } else if (serialized = this.prefetch.fromCache()) {\n                    this.index.bootstrap(serialized);\n                    deferred.resolve();\n                } else {\n                    this.prefetch.fromNetwork(done);\n                }\n                return deferred.promise();\n                function done(err, data) {\n                    if (err) {\n                        return deferred.reject();\n                    }\n                    that.add(data);\n                    that.prefetch.store(that.index.serialize());\n                    deferred.resolve();\n                }\n            },\n            _initialize: function initialize() {\n                var that = this, deferred;\n                this.clear();\n                (this.initPromise = this._loadPrefetch()).done(addLocalToIndex);\n                return this.initPromise;\n                function addLocalToIndex() {\n                    that.add(that.local);\n                }\n            },\n            initialize: function initialize(force) {\n                return !this.initPromise || force ? this._initialize() : this.initPromise;\n            },\n            add: function add(data) {\n                this.index.add(data);\n                return this;\n            },\n            get: function get(ids) {\n                ids = _.isArray(ids) ? ids : [].slice.call(arguments);\n                return this.index.get(ids);\n            },\n            search: function search(query, sync, async) {\n                var that = this, local;\n                local = this.sorter(this.index.search(query));\n                sync(this.remote ? local.slice() : local);\n                if (this.remote && local.length < this.sufficient) {\n                    this.remote.get(query, processRemote);\n                } else if (this.remote) {\n                    this.remote.cancelLastRequest();\n                }\n                return this;\n                function processRemote(remote) {\n                    var nonDuplicates = [];\n                    _.each(remote, function(r) {\n                        !_.some(local, function(l) {\n                            return that.identify(r) === that.identify(l);\n                        }) && nonDuplicates.push(r);\n                    });\n                    async && async(nonDuplicates);\n                }\n            },\n            all: function all() {\n                return this.index.all();\n            },\n            clear: function clear() {\n                this.index.reset();\n                return this;\n            },\n            clearPrefetchCache: function clearPrefetchCache() {\n                this.prefetch && this.prefetch.clear();\n                return this;\n            },\n            clearRemoteCache: function clearRemoteCache() {\n                Transport.resetCache();\n                return this;\n            },\n            ttAdapter: function ttAdapter() {\n                return this.__ttAdapter();\n            }\n        });\n        return Bloodhound;\n    }();\n    return Bloodhound;\n});\n\n(function(root, factory) {\n    if (typeof define === \"function\" && define.amd) {\n        define(\"typeahead.js\", [ \"jquery\" ], function(a0) {\n            return factory(a0);\n        });\n    } else if (typeof exports === \"object\") {\n        module.exports = factory(require(\"jquery\"));\n    } else {\n        factory(jQuery);\n    }\n})(this, function($) {\n    var _ = function() {\n        \"use strict\";\n        return {\n            isMsie: function() {\n                return /(msie|trident)/i.test(navigator.userAgent) ? navigator.userAgent.match(/(msie |rv:)(\\d+(.\\d+)?)/i)[2] : false;\n            },\n            isBlankString: function(str) {\n                return !str || /^\\s*$/.test(str);\n            },\n            escapeRegExChars: function(str) {\n                return str.replace(/[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g, \"\\\\$&\");\n            },\n            isString: function(obj) {\n                return typeof obj === \"string\";\n            },\n            isNumber: function(obj) {\n                return typeof obj === \"number\";\n            },\n            isArray: $.isArray,\n            isFunction: $.isFunction,\n            isObject: $.isPlainObject,\n            isUndefined: function(obj) {\n                return typeof obj === \"undefined\";\n            },\n            isElement: function(obj) {\n                return !!(obj && obj.nodeType === 1);\n            },\n            isJQuery: function(obj) {\n                return obj instanceof $;\n            },\n            toStr: function toStr(s) {\n                return _.isUndefined(s) || s === null ? \"\" : s + \"\";\n            },\n            bind: $.proxy,\n            each: function(collection, cb) {\n                $.each(collection, reverseArgs);\n                function reverseArgs(index, value) {\n                    return cb(value, index);\n                }\n            },\n            map: $.map,\n            filter: $.grep,\n            every: function(obj, test) {\n                var result = true;\n                if (!obj) {\n                    return result;\n                }\n                $.each(obj, function(key, val) {\n                    if (!(result = test.call(null, val, key, obj))) {\n                        return false;\n                    }\n                });\n                return !!result;\n            },\n            some: function(obj, test) {\n                var result = false;\n                if (!obj) {\n                    return result;\n                }\n                $.each(obj, function(key, val) {\n                    if (result = test.call(null, val, key, obj)) {\n                        return false;\n                    }\n                });\n                return !!result;\n            },\n            mixin: $.extend,\n            identity: function(x) {\n                return x;\n            },\n            clone: function(obj) {\n                return $.extend(true, {}, obj);\n            },\n            getIdGenerator: function() {\n                var counter = 0;\n                return function() {\n                    return counter++;\n                };\n            },\n            templatify: function templatify(obj) {\n                return $.isFunction(obj) ? obj : template;\n                function template() {\n                    return String(obj);\n                }\n            },\n            defer: function(fn) {\n                setTimeout(fn, 0);\n            },\n            debounce: function(func, wait, immediate) {\n                var timeout, result;\n                return function() {\n                    var context = this, args = arguments, later, callNow;\n                    later = function() {\n                        timeout = null;\n                        if (!immediate) {\n                            result = func.apply(context, args);\n                        }\n                    };\n                    callNow = immediate && !timeout;\n                    clearTimeout(timeout);\n                    timeout = setTimeout(later, wait);\n                    if (callNow) {\n                        result = func.apply(context, args);\n                    }\n                    return result;\n                };\n            },\n            throttle: function(func, wait) {\n                var context, args, timeout, result, previous, later;\n                previous = 0;\n                later = function() {\n                    previous = new Date();\n                    timeout = null;\n                    result = func.apply(context, args);\n                };\n                return function() {\n                    var now = new Date(), remaining = wait - (now - previous);\n                    context = this;\n                    args = arguments;\n                    if (remaining <= 0) {\n                        clearTimeout(timeout);\n                        timeout = null;\n                        previous = now;\n                        result = func.apply(context, args);\n                    } else if (!timeout) {\n                        timeout = setTimeout(later, remaining);\n                    }\n                    return result;\n                };\n            },\n            stringify: function(val) {\n                return _.isString(val) ? val : JSON.stringify(val);\n            },\n            noop: function() {}\n        };\n    }();\n    var WWW = function() {\n        \"use strict\";\n        var defaultClassNames = {\n            wrapper: \"twitter-typeahead\",\n            input: \"tt-input\",\n            hint: \"tt-hint\",\n            menu: \"tt-menu\",\n            dataset: \"tt-dataset\",\n            suggestion: \"tt-suggestion\",\n            selectable: \"tt-selectable\",\n            empty: \"tt-empty\",\n            open: \"tt-open\",\n            cursor: \"tt-cursor\",\n            highlight: \"tt-highlight\"\n        };\n        return build;\n        function build(o) {\n            var www, classes;\n            classes = _.mixin({}, defaultClassNames, o);\n            www = {\n                css: buildCss(),\n                classes: classes,\n                html: buildHtml(classes),\n                selectors: buildSelectors(classes)\n            };\n            return {\n                css: www.css,\n                html: www.html,\n                classes: www.classes,\n                selectors: www.selectors,\n                mixin: function(o) {\n                    _.mixin(o, www);\n                }\n            };\n        }\n        function buildHtml(c) {\n            return {\n                wrapper: '<span class=\"' + c.wrapper + '\"></span>',\n                menu: '<div class=\"' + c.menu + '\"></div>'\n            };\n        }\n        function buildSelectors(classes) {\n            var selectors = {};\n            _.each(classes, function(v, k) {\n                selectors[k] = \".\" + v;\n            });\n            return selectors;\n        }\n        function buildCss() {\n            var css = {\n                wrapper: {\n                    position: \"relative\",\n                    display: \"inline-block\"\n                },\n                hint: {\n                    position: \"absolute\",\n                    top: \"0\",\n                    left: \"0\",\n                    borderColor: \"transparent\",\n                    boxShadow: \"none\",\n                    opacity: \"1\"\n                },\n                input: {\n                    position: \"relative\",\n                    verticalAlign: \"top\",\n                    backgroundColor: \"transparent\"\n                },\n                inputWithNoHint: {\n                    position: \"relative\",\n                    verticalAlign: \"top\"\n                },\n                menu: {\n                    position: \"absolute\",\n                    top: \"100%\",\n                    left: \"0\",\n                    zIndex: \"100\",\n                    display: \"none\"\n                },\n                ltr: {\n                    left: \"0\",\n                    right: \"auto\"\n                },\n                rtl: {\n                    left: \"auto\",\n                    right: \" 0\"\n                }\n            };\n            if (_.isMsie()) {\n                _.mixin(css.input, {\n                    backgroundImage: \"url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)\"\n                });\n            }\n            return css;\n        }\n    }();\n    var EventBus = function() {\n        \"use strict\";\n        var namespace, deprecationMap;\n        namespace = \"typeahead:\";\n        deprecationMap = {\n            render: \"rendered\",\n            cursorchange: \"cursorchanged\",\n            select: \"selected\",\n            autocomplete: \"autocompleted\"\n        };\n        function EventBus(o) {\n            if (!o || !o.el) {\n                $.error(\"EventBus initialized without el\");\n            }\n            this.$el = $(o.el);\n        }\n        _.mixin(EventBus.prototype, {\n            _trigger: function(type, args) {\n                var $e;\n                $e = $.Event(namespace + type);\n                (args = args || []).unshift($e);\n                this.$el.trigger.apply(this.$el, args);\n                return $e;\n            },\n            before: function(type) {\n                var args, $e;\n                args = [].slice.call(arguments, 1);\n                $e = this._trigger(\"before\" + type, args);\n                return $e.isDefaultPrevented();\n            },\n            trigger: function(type) {\n                var deprecatedType;\n                this._trigger(type, [].slice.call(arguments, 1));\n                if (deprecatedType = deprecationMap[type]) {\n                    this._trigger(deprecatedType, [].slice.call(arguments, 1));\n                }\n            }\n        });\n        return EventBus;\n    }();\n    var EventEmitter = function() {\n        \"use strict\";\n        var splitter = /\\s+/, nextTick = getNextTick();\n        return {\n            onSync: onSync,\n            onAsync: onAsync,\n            off: off,\n            trigger: trigger\n        };\n        function on(method, types, cb, context) {\n            var type;\n            if (!cb) {\n                return this;\n            }\n            types = types.split(splitter);\n            cb = context ? bindContext(cb, context) : cb;\n            this._callbacks = this._callbacks || {};\n            while (type = types.shift()) {\n                this._callbacks[type] = this._callbacks[type] || {\n                    sync: [],\n                    async: []\n                };\n                this._callbacks[type][method].push(cb);\n            }\n            return this;\n        }\n        function onAsync(types, cb, context) {\n            return on.call(this, \"async\", types, cb, context);\n        }\n        function onSync(types, cb, context) {\n            return on.call(this, \"sync\", types, cb, context);\n        }\n        function off(types) {\n            var type;\n            if (!this._callbacks) {\n                return this;\n            }\n            types = types.split(splitter);\n            while (type = types.shift()) {\n                delete this._callbacks[type];\n            }\n            return this;\n        }\n        function trigger(types) {\n            var type, callbacks, args, syncFlush, asyncFlush;\n            if (!this._callbacks) {\n                return this;\n            }\n            types = types.split(splitter);\n            args = [].slice.call(arguments, 1);\n            while ((type = types.shift()) && (callbacks = this._callbacks[type])) {\n                syncFlush = getFlush(callbacks.sync, this, [ type ].concat(args));\n                asyncFlush = getFlush(callbacks.async, this, [ type ].concat(args));\n                syncFlush() && nextTick(asyncFlush);\n            }\n            return this;\n        }\n        function getFlush(callbacks, context, args) {\n            return flush;\n            function flush() {\n                var cancelled;\n                for (var i = 0, len = callbacks.length; !cancelled && i < len; i += 1) {\n                    cancelled = callbacks[i].apply(context, args) === false;\n                }\n                return !cancelled;\n            }\n        }\n        function getNextTick() {\n            var nextTickFn;\n            if (window.setImmediate) {\n                nextTickFn = function nextTickSetImmediate(fn) {\n                    setImmediate(function() {\n                        fn();\n                    });\n                };\n            } else {\n                nextTickFn = function nextTickSetTimeout(fn) {\n                    setTimeout(function() {\n                        fn();\n                    }, 0);\n                };\n            }\n            return nextTickFn;\n        }\n        function bindContext(fn, context) {\n            return fn.bind ? fn.bind(context) : function() {\n                fn.apply(context, [].slice.call(arguments, 0));\n            };\n        }\n    }();\n    var highlight = function(doc) {\n        \"use strict\";\n        var defaults = {\n            node: null,\n            pattern: null,\n            tagName: \"strong\",\n            className: null,\n            wordsOnly: false,\n            caseSensitive: false\n        };\n        return function hightlight(o) {\n            var regex;\n            o = _.mixin({}, defaults, o);\n            if (!o.node || !o.pattern) {\n                return;\n            }\n            o.pattern = _.isArray(o.pattern) ? o.pattern : [ o.pattern ];\n            regex = getRegex(o.pattern, o.caseSensitive, o.wordsOnly);\n            traverse(o.node, hightlightTextNode);\n            function hightlightTextNode(textNode) {\n                var match, patternNode, wrapperNode;\n                if (match = regex.exec(textNode.data)) {\n                    wrapperNode = doc.createElement(o.tagName);\n                    o.className && (wrapperNode.className = o.className);\n                    patternNode = textNode.splitText(match.index);\n                    patternNode.splitText(match[0].length);\n                    wrapperNode.appendChild(patternNode.cloneNode(true));\n                    textNode.parentNode.replaceChild(wrapperNode, patternNode);\n                }\n                return !!match;\n            }\n            function traverse(el, hightlightTextNode) {\n                var childNode, TEXT_NODE_TYPE = 3;\n                for (var i = 0; i < el.childNodes.length; i++) {\n                    childNode = el.childNodes[i];\n                    if (childNode.nodeType === TEXT_NODE_TYPE) {\n                        i += hightlightTextNode(childNode) ? 1 : 0;\n                    } else {\n                        traverse(childNode, hightlightTextNode);\n                    }\n                }\n            }\n        };\n        function getRegex(patterns, caseSensitive, wordsOnly) {\n            var escapedPatterns = [], regexStr;\n            for (var i = 0, len = patterns.length; i < len; i++) {\n                escapedPatterns.push(_.escapeRegExChars(patterns[i]));\n            }\n            regexStr = wordsOnly ? \"\\\\b(\" + escapedPatterns.join(\"|\") + \")\\\\b\" : \"(\" + escapedPatterns.join(\"|\") + \")\";\n            return caseSensitive ? new RegExp(regexStr) : new RegExp(regexStr, \"i\");\n        }\n    }(window.document);\n    var Input = function() {\n        \"use strict\";\n        var specialKeyCodeMap;\n        specialKeyCodeMap = {\n            9: \"tab\",\n            27: \"esc\",\n            37: \"left\",\n            39: \"right\",\n            13: \"enter\",\n            38: \"up\",\n            40: \"down\"\n        };\n        function Input(o, www) {\n            o = o || {};\n            if (!o.input) {\n                $.error(\"input is missing\");\n            }\n            www.mixin(this);\n            this.$hint = $(o.hint);\n            this.$input = $(o.input);\n            this.query = this.$input.val();\n            this.queryWhenFocused = this.hasFocus() ? this.query : null;\n            this.$overflowHelper = buildOverflowHelper(this.$input);\n            this._checkLanguageDirection();\n            if (this.$hint.length === 0) {\n                this.setHint = this.getHint = this.clearHint = this.clearHintIfInvalid = _.noop;\n            }\n        }\n        Input.normalizeQuery = function(str) {\n            return _.toStr(str).replace(/^\\s*/g, \"\").replace(/\\s{2,}/g, \" \");\n        };\n        _.mixin(Input.prototype, EventEmitter, {\n            _onBlur: function onBlur() {\n                this.resetInputValue();\n                this.trigger(\"blurred\");\n            },\n            _onFocus: function onFocus() {\n                this.queryWhenFocused = this.query;\n                this.trigger(\"focused\");\n            },\n            _onKeydown: function onKeydown($e) {\n                var keyName = specialKeyCodeMap[$e.which || $e.keyCode];\n                this._managePreventDefault(keyName, $e);\n                if (keyName && this._shouldTrigger(keyName, $e)) {\n                    this.trigger(keyName + \"Keyed\", $e);\n                }\n            },\n            _onInput: function onInput() {\n                this._setQuery(this.getInputValue());\n                this.clearHintIfInvalid();\n                this._checkLanguageDirection();\n            },\n            _managePreventDefault: function managePreventDefault(keyName, $e) {\n                var preventDefault;\n                switch (keyName) {\n                  case \"up\":\n                  case \"down\":\n                    preventDefault = !withModifier($e);\n                    break;\n\n                  default:\n                    preventDefault = false;\n                }\n                preventDefault && $e.preventDefault();\n            },\n            _shouldTrigger: function shouldTrigger(keyName, $e) {\n                var trigger;\n                switch (keyName) {\n                  case \"tab\":\n                    trigger = !withModifier($e);\n                    break;\n\n                  default:\n                    trigger = true;\n                }\n                return trigger;\n            },\n            _checkLanguageDirection: function checkLanguageDirection() {\n                var dir = (this.$input.css(\"direction\") || \"ltr\").toLowerCase();\n                if (this.dir !== dir) {\n                    this.dir = dir;\n                    this.$hint.attr(\"dir\", dir);\n                    this.trigger(\"langDirChanged\", dir);\n                }\n            },\n            _setQuery: function setQuery(val, silent) {\n                var areEquivalent, hasDifferentWhitespace;\n                areEquivalent = areQueriesEquivalent(val, this.query);\n                hasDifferentWhitespace = areEquivalent ? this.query.length !== val.length : false;\n                this.query = val;\n                if (!silent && !areEquivalent) {\n                    this.trigger(\"queryChanged\", this.query);\n                } else if (!silent && hasDifferentWhitespace) {\n                    this.trigger(\"whitespaceChanged\", this.query);\n                }\n            },\n            bind: function() {\n                var that = this, onBlur, onFocus, onKeydown, onInput;\n                onBlur = _.bind(this._onBlur, this);\n                onFocus = _.bind(this._onFocus, this);\n                onKeydown = _.bind(this._onKeydown, this);\n                onInput = _.bind(this._onInput, this);\n                this.$input.on(\"blur.tt\", onBlur).on(\"focus.tt\", onFocus).on(\"keydown.tt\", onKeydown);\n                if (!_.isMsie() || _.isMsie() > 9) {\n                    this.$input.on(\"input.tt\", onInput);\n                } else {\n                    this.$input.on(\"keydown.tt keypress.tt cut.tt paste.tt\", function($e) {\n                        if (specialKeyCodeMap[$e.which || $e.keyCode]) {\n                            return;\n                        }\n                        _.defer(_.bind(that._onInput, that, $e));\n                    });\n                }\n                return this;\n            },\n            focus: function focus() {\n                this.$input.focus();\n            },\n            blur: function blur() {\n                this.$input.blur();\n            },\n            getLangDir: function getLangDir() {\n                return this.dir;\n            },\n            getQuery: function getQuery() {\n                return this.query || \"\";\n            },\n            setQuery: function setQuery(val, silent) {\n                this.setInputValue(val);\n                this._setQuery(val, silent);\n            },\n            hasQueryChangedSinceLastFocus: function hasQueryChangedSinceLastFocus() {\n                return this.query !== this.queryWhenFocused;\n            },\n            getInputValue: function getInputValue() {\n                return this.$input.val();\n            },\n            setInputValue: function setInputValue(value) {\n                this.$input.val(value);\n                this.clearHintIfInvalid();\n                this._checkLanguageDirection();\n            },\n            resetInputValue: function resetInputValue() {\n                this.setInputValue(this.query);\n            },\n            getHint: function getHint() {\n                return this.$hint.val();\n            },\n            setHint: function setHint(value) {\n                this.$hint.val(value);\n            },\n            clearHint: function clearHint() {\n                this.setHint(\"\");\n            },\n            clearHintIfInvalid: function clearHintIfInvalid() {\n                var val, hint, valIsPrefixOfHint, isValid;\n                val = this.getInputValue();\n                hint = this.getHint();\n                valIsPrefixOfHint = val !== hint && hint.indexOf(val) === 0;\n                isValid = val !== \"\" && valIsPrefixOfHint && !this.hasOverflow();\n                !isValid && this.clearHint();\n            },\n            hasFocus: function hasFocus() {\n                return this.$input.is(\":focus\");\n            },\n            hasOverflow: function hasOverflow() {\n                var constraint = this.$input.width() - 2;\n                this.$overflowHelper.text(this.getInputValue());\n                return this.$overflowHelper.width() >= constraint;\n            },\n            isCursorAtEnd: function() {\n                var valueLength, selectionStart, range;\n                valueLength = this.$input.val().length;\n                selectionStart = this.$input[0].selectionStart;\n                if (_.isNumber(selectionStart)) {\n                    return selectionStart === valueLength;\n                } else if (document.selection) {\n                    range = document.selection.createRange();\n                    range.moveStart(\"character\", -valueLength);\n                    return valueLength === range.text.length;\n                }\n                return true;\n            },\n            destroy: function destroy() {\n                this.$hint.off(\".tt\");\n                this.$input.off(\".tt\");\n                this.$overflowHelper.remove();\n                this.$hint = this.$input = this.$overflowHelper = $(\"<div>\");\n            }\n        });\n        return Input;\n        function buildOverflowHelper($input) {\n            return $('<pre aria-hidden=\"true\"></pre>').css({\n                position: \"absolute\",\n                visibility: \"hidden\",\n                whiteSpace: \"pre\",\n                fontFamily: $input.css(\"font-family\"),\n                fontSize: $input.css(\"font-size\"),\n                fontStyle: $input.css(\"font-style\"),\n                fontVariant: $input.css(\"font-variant\"),\n                fontWeight: $input.css(\"font-weight\"),\n                wordSpacing: $input.css(\"word-spacing\"),\n                letterSpacing: $input.css(\"letter-spacing\"),\n                textIndent: $input.css(\"text-indent\"),\n                textRendering: $input.css(\"text-rendering\"),\n                textTransform: $input.css(\"text-transform\")\n            }).insertAfter($input);\n        }\n        function areQueriesEquivalent(a, b) {\n            return Input.normalizeQuery(a) === Input.normalizeQuery(b);\n        }\n        function withModifier($e) {\n            return $e.altKey || $e.ctrlKey || $e.metaKey || $e.shiftKey;\n        }\n    }();\n    var Dataset = function() {\n        \"use strict\";\n        var keys, nameGenerator;\n        keys = {\n            val: \"tt-selectable-display\",\n            obj: \"tt-selectable-object\"\n        };\n        nameGenerator = _.getIdGenerator();\n        function Dataset(o, www) {\n            o = o || {};\n            o.templates = o.templates || {};\n            o.templates.notFound = o.templates.notFound || o.templates.empty;\n            if (!o.source) {\n                $.error(\"missing source\");\n            }\n            if (!o.node) {\n                $.error(\"missing node\");\n            }\n            if (o.name && !isValidName(o.name)) {\n                $.error(\"invalid dataset name: \" + o.name);\n            }\n            www.mixin(this);\n            this.highlight = !!o.highlight;\n            this.name = o.name || nameGenerator();\n            this.limit = o.limit || 5;\n            this.displayFn = getDisplayFn(o.display || o.displayKey);\n            this.templates = getTemplates(o.templates, this.displayFn);\n            this.source = o.source.__ttAdapter ? o.source.__ttAdapter() : o.source;\n            this.async = _.isUndefined(o.async) ? this.source.length > 2 : !!o.async;\n            this._resetLastSuggestion();\n            this.$el = $(o.node).addClass(this.classes.dataset).addClass(this.classes.dataset + \"-\" + this.name);\n        }\n        Dataset.extractData = function extractData(el) {\n            var $el = $(el);\n            if ($el.data(keys.obj)) {\n                return {\n                    val: $el.data(keys.val) || \"\",\n                    obj: $el.data(keys.obj) || null\n                };\n            }\n            return null;\n        };\n        _.mixin(Dataset.prototype, EventEmitter, {\n            _overwrite: function overwrite(query, suggestions) {\n                suggestions = suggestions || [];\n                if (suggestions.length) {\n                    this._renderSuggestions(query, suggestions);\n                } else if (this.async && this.templates.pending) {\n                    this._renderPending(query);\n                } else if (!this.async && this.templates.notFound) {\n                    this._renderNotFound(query);\n                } else {\n                    this._empty();\n                }\n                this.trigger(\"rendered\", this.name, suggestions, false);\n            },\n            _append: function append(query, suggestions) {\n                suggestions = suggestions || [];\n                if (suggestions.length && this.$lastSuggestion.length) {\n                    this._appendSuggestions(query, suggestions);\n                } else if (suggestions.length) {\n                    this._renderSuggestions(query, suggestions);\n                } else if (!this.$lastSuggestion.length && this.templates.notFound) {\n                    this._renderNotFound(query);\n                }\n                this.trigger(\"rendered\", this.name, suggestions, true);\n            },\n            _renderSuggestions: function renderSuggestions(query, suggestions) {\n                var $fragment;\n                $fragment = this._getSuggestionsFragment(query, suggestions);\n                this.$lastSuggestion = $fragment.children().last();\n                this.$el.html($fragment).prepend(this._getHeader(query, suggestions)).append(this._getFooter(query, suggestions));\n            },\n            _appendSuggestions: function appendSuggestions(query, suggestions) {\n                var $fragment, $lastSuggestion;\n                $fragment = this._getSuggestionsFragment(query, suggestions);\n                $lastSuggestion = $fragment.children().last();\n                this.$lastSuggestion.after($fragment);\n                this.$lastSuggestion = $lastSuggestion;\n            },\n            _renderPending: function renderPending(query) {\n                var template = this.templates.pending;\n                this._resetLastSuggestion();\n                template && this.$el.html(template({\n                    query: query,\n                    dataset: this.name\n                }));\n            },\n            _renderNotFound: function renderNotFound(query) {\n                var template = this.templates.notFound;\n                this._resetLastSuggestion();\n                template && this.$el.html(template({\n                    query: query,\n                    dataset: this.name\n                }));\n            },\n            _empty: function empty() {\n                this.$el.empty();\n                this._resetLastSuggestion();\n            },\n            _getSuggestionsFragment: function getSuggestionsFragment(query, suggestions) {\n                var that = this, fragment;\n                fragment = document.createDocumentFragment();\n                _.each(suggestions, function getSuggestionNode(suggestion) {\n                    var $el, context;\n                    context = that._injectQuery(query, suggestion);\n                    $el = $(that.templates.suggestion(context)).data(keys.obj, suggestion).data(keys.val, that.displayFn(suggestion)).addClass(that.classes.suggestion + \" \" + that.classes.selectable);\n                    fragment.appendChild($el[0]);\n                });\n                this.highlight && highlight({\n                    className: this.classes.highlight,\n                    node: fragment,\n                    pattern: query\n                });\n                return $(fragment);\n            },\n            _getFooter: function getFooter(query, suggestions) {\n                return this.templates.footer ? this.templates.footer({\n                    query: query,\n                    suggestions: suggestions,\n                    dataset: this.name\n                }) : null;\n            },\n            _getHeader: function getHeader(query, suggestions) {\n                return this.templates.header ? this.templates.header({\n                    query: query,\n                    suggestions: suggestions,\n                    dataset: this.name\n                }) : null;\n            },\n            _resetLastSuggestion: function resetLastSuggestion() {\n                this.$lastSuggestion = $();\n            },\n            _injectQuery: function injectQuery(query, obj) {\n                return _.isObject(obj) ? _.mixin({\n                    _query: query\n                }, obj) : obj;\n            },\n            update: function update(query) {\n                var that = this, canceled = false, syncCalled = false, rendered = 0;\n                this.cancel();\n                this.cancel = function cancel() {\n                    canceled = true;\n                    that.cancel = $.noop;\n                    that.async && that.trigger(\"asyncCanceled\", query);\n                };\n                this.source(query, sync, async);\n                !syncCalled && sync([]);\n                function sync(suggestions) {\n                    if (syncCalled) {\n                        return;\n                    }\n                    syncCalled = true;\n                    suggestions = (suggestions || []).slice(0, that.limit);\n                    rendered = suggestions.length;\n                    that._overwrite(query, suggestions);\n                    if (rendered < that.limit && that.async) {\n                        that.trigger(\"asyncRequested\", query);\n                    }\n                }\n                function async(suggestions) {\n                    suggestions = suggestions || [];\n                    if (!canceled && rendered < that.limit) {\n                        that.cancel = $.noop;\n                        suggestions = suggestions.slice(0, that.limit - rendered);\n                        that._append(query, suggestions);\n                        rendered += suggestions.length;\n                        that.async && that.trigger(\"asyncReceived\", query);\n                    }\n                }\n            },\n            cancel: $.noop,\n            clear: function clear() {\n                this._empty();\n                this.cancel();\n                this.trigger(\"cleared\");\n            },\n            isEmpty: function isEmpty() {\n                return this.$el.is(\":empty\");\n            },\n            destroy: function destroy() {\n                this.$el = $(\"<div>\");\n            }\n        });\n        return Dataset;\n        function getDisplayFn(display) {\n            display = display || _.stringify;\n            return _.isFunction(display) ? display : displayFn;\n            function displayFn(obj) {\n                return obj[display];\n            }\n        }\n        function getTemplates(templates, displayFn) {\n            return {\n                notFound: templates.notFound && _.templatify(templates.notFound),\n                pending: templates.pending && _.templatify(templates.pending),\n                header: templates.header && _.templatify(templates.header),\n                footer: templates.footer && _.templatify(templates.footer),\n                suggestion: templates.suggestion || suggestionTemplate\n            };\n            function suggestionTemplate(context) {\n                return $(\"<div>\").text(displayFn(context));\n            }\n        }\n        function isValidName(str) {\n            return /^[_a-zA-Z0-9-]+$/.test(str);\n        }\n    }();\n    var Menu = function() {\n        \"use strict\";\n        function Menu(o, www) {\n            var that = this;\n            o = o || {};\n            if (!o.node) {\n                $.error(\"node is required\");\n            }\n            www.mixin(this);\n            this.$node = $(o.node);\n            this.query = null;\n            this.datasets = _.map(o.datasets, initializeDataset);\n            function initializeDataset(oDataset) {\n                var node = that.$node.find(oDataset.node).first();\n                oDataset.node = node.length ? node : $(\"<div>\").appendTo(that.$node);\n                return new Dataset(oDataset, www);\n            }\n        }\n        _.mixin(Menu.prototype, EventEmitter, {\n            _onSelectableClick: function onSelectableClick($e) {\n                this.trigger(\"selectableClicked\", $($e.currentTarget));\n            },\n            _onRendered: function onRendered(type, dataset, suggestions, async) {\n                this.$node.toggleClass(this.classes.empty, this._allDatasetsEmpty());\n                this.trigger(\"datasetRendered\", dataset, suggestions, async);\n            },\n            _onCleared: function onCleared() {\n                this.$node.toggleClass(this.classes.empty, this._allDatasetsEmpty());\n                this.trigger(\"datasetCleared\");\n            },\n            _propagate: function propagate() {\n                this.trigger.apply(this, arguments);\n            },\n            _allDatasetsEmpty: function allDatasetsEmpty() {\n                return _.every(this.datasets, isDatasetEmpty);\n                function isDatasetEmpty(dataset) {\n                    return dataset.isEmpty();\n                }\n            },\n            _getSelectables: function getSelectables() {\n                return this.$node.find(this.selectors.selectable);\n            },\n            _removeCursor: function _removeCursor() {\n                var $selectable = this.getActiveSelectable();\n                $selectable && $selectable.removeClass(this.classes.cursor);\n            },\n            _ensureVisible: function ensureVisible($el) {\n                var elTop, elBottom, nodeScrollTop, nodeHeight;\n                elTop = $el.position().top;\n                elBottom = elTop + $el.outerHeight(true);\n                nodeScrollTop = this.$node.scrollTop();\n                nodeHeight = this.$node.height() + parseInt(this.$node.css(\"paddingTop\"), 10) + parseInt(this.$node.css(\"paddingBottom\"), 10);\n                if (elTop < 0) {\n                    this.$node.scrollTop(nodeScrollTop + elTop);\n                } else if (nodeHeight < elBottom) {\n                    this.$node.scrollTop(nodeScrollTop + (elBottom - nodeHeight));\n                }\n            },\n            bind: function() {\n                var that = this, onSelectableClick;\n                onSelectableClick = _.bind(this._onSelectableClick, this);\n                this.$node.on(\"click.tt\", this.selectors.selectable, onSelectableClick);\n                _.each(this.datasets, function(dataset) {\n                    dataset.onSync(\"asyncRequested\", that._propagate, that).onSync(\"asyncCanceled\", that._propagate, that).onSync(\"asyncReceived\", that._propagate, that).onSync(\"rendered\", that._onRendered, that).onSync(\"cleared\", that._onCleared, that);\n                });\n                return this;\n            },\n            isOpen: function isOpen() {\n                return this.$node.hasClass(this.classes.open);\n            },\n            open: function open() {\n                this.$node.addClass(this.classes.open);\n            },\n            close: function close() {\n                this.$node.removeClass(this.classes.open);\n                this._removeCursor();\n            },\n            setLanguageDirection: function setLanguageDirection(dir) {\n                this.$node.attr(\"dir\", dir);\n            },\n            selectableRelativeToCursor: function selectableRelativeToCursor(delta) {\n                var $selectables, $oldCursor, oldIndex, newIndex;\n                $oldCursor = this.getActiveSelectable();\n                $selectables = this._getSelectables();\n                oldIndex = $oldCursor ? $selectables.index($oldCursor) : -1;\n                newIndex = oldIndex + delta;\n                newIndex = (newIndex + 1) % ($selectables.length + 1) - 1;\n                newIndex = newIndex < -1 ? $selectables.length - 1 : newIndex;\n                return newIndex === -1 ? null : $selectables.eq(newIndex);\n            },\n            setCursor: function setCursor($selectable) {\n                this._removeCursor();\n                if ($selectable = $selectable && $selectable.first()) {\n                    $selectable.addClass(this.classes.cursor);\n                    this._ensureVisible($selectable);\n                }\n            },\n            getSelectableData: function getSelectableData($el) {\n                return $el && $el.length ? Dataset.extractData($el) : null;\n            },\n            getActiveSelectable: function getActiveSelectable() {\n                var $selectable = this._getSelectables().filter(this.selectors.cursor).first();\n                return $selectable.length ? $selectable : null;\n            },\n            getTopSelectable: function getTopSelectable() {\n                var $selectable = this._getSelectables().first();\n                return $selectable.length ? $selectable : null;\n            },\n            update: function update(query) {\n                var isValidUpdate = query !== this.query;\n                if (isValidUpdate) {\n                    this.query = query;\n                    _.each(this.datasets, updateDataset);\n                }\n                return isValidUpdate;\n                function updateDataset(dataset) {\n                    dataset.update(query);\n                }\n            },\n            empty: function empty() {\n                _.each(this.datasets, clearDataset);\n                this.query = null;\n                this.$node.addClass(this.classes.empty);\n                function clearDataset(dataset) {\n                    dataset.clear();\n                }\n            },\n            destroy: function destroy() {\n                this.$node.off(\".tt\");\n                this.$node = $(\"<div>\");\n                _.each(this.datasets, destroyDataset);\n                function destroyDataset(dataset) {\n                    dataset.destroy();\n                }\n            }\n        });\n        return Menu;\n    }();\n    var DefaultMenu = function() {\n        \"use strict\";\n        var s = Menu.prototype;\n        function DefaultMenu() {\n            Menu.apply(this, [].slice.call(arguments, 0));\n        }\n        _.mixin(DefaultMenu.prototype, Menu.prototype, {\n            open: function open() {\n                !this._allDatasetsEmpty() && this._show();\n                return s.open.apply(this, [].slice.call(arguments, 0));\n            },\n            close: function close() {\n                this._hide();\n                return s.close.apply(this, [].slice.call(arguments, 0));\n            },\n            _onRendered: function onRendered() {\n                if (this._allDatasetsEmpty()) {\n                    this._hide();\n                } else {\n                    this.isOpen() && this._show();\n                }\n                return s._onRendered.apply(this, [].slice.call(arguments, 0));\n            },\n            _onCleared: function onCleared() {\n                if (this._allDatasetsEmpty()) {\n                    this._hide();\n                } else {\n                    this.isOpen() && this._show();\n                }\n                return s._onCleared.apply(this, [].slice.call(arguments, 0));\n            },\n            setLanguageDirection: function setLanguageDirection(dir) {\n                this.$node.css(dir === \"ltr\" ? this.css.ltr : this.css.rtl);\n                return s.setLanguageDirection.apply(this, [].slice.call(arguments, 0));\n            },\n            _hide: function hide() {\n                this.$node.hide();\n            },\n            _show: function show() {\n                this.$node.css(\"display\", \"block\");\n            }\n        });\n        return DefaultMenu;\n    }();\n    var Typeahead = function() {\n        \"use strict\";\n        function Typeahead(o, www) {\n            var onFocused, onBlurred, onEnterKeyed, onTabKeyed, onEscKeyed, onUpKeyed, onDownKeyed, onLeftKeyed, onRightKeyed, onQueryChanged, onWhitespaceChanged;\n            o = o || {};\n            if (!o.input) {\n                $.error(\"missing input\");\n            }\n            if (!o.menu) {\n                $.error(\"missing menu\");\n            }\n            if (!o.eventBus) {\n                $.error(\"missing event bus\");\n            }\n            www.mixin(this);\n            this.eventBus = o.eventBus;\n            this.minLength = _.isNumber(o.minLength) ? o.minLength : 1;\n            this.input = o.input;\n            this.menu = o.menu;\n            this.enabled = true;\n            this.active = false;\n            this.input.hasFocus() && this.activate();\n            this.dir = this.input.getLangDir();\n            this._hacks();\n            this.menu.bind().onSync(\"selectableClicked\", this._onSelectableClicked, this).onSync(\"asyncRequested\", this._onAsyncRequested, this).onSync(\"asyncCanceled\", this._onAsyncCanceled, this).onSync(\"asyncReceived\", this._onAsyncReceived, this).onSync(\"datasetRendered\", this._onDatasetRendered, this).onSync(\"datasetCleared\", this._onDatasetCleared, this);\n            onFocused = c(this, \"activate\", \"open\", \"_onFocused\");\n            onBlurred = c(this, \"deactivate\", \"_onBlurred\");\n            onEnterKeyed = c(this, \"isActive\", \"isOpen\", \"_onEnterKeyed\");\n            onTabKeyed = c(this, \"isActive\", \"isOpen\", \"_onTabKeyed\");\n            onEscKeyed = c(this, \"isActive\", \"_onEscKeyed\");\n            onUpKeyed = c(this, \"isActive\", \"open\", \"_onUpKeyed\");\n            onDownKeyed = c(this, \"isActive\", \"open\", \"_onDownKeyed\");\n            onLeftKeyed = c(this, \"isActive\", \"isOpen\", \"_onLeftKeyed\");\n            onRightKeyed = c(this, \"isActive\", \"isOpen\", \"_onRightKeyed\");\n            onQueryChanged = c(this, \"_openIfActive\", \"_onQueryChanged\");\n            onWhitespaceChanged = c(this, \"_openIfActive\", \"_onWhitespaceChanged\");\n            this.input.bind().onSync(\"focused\", onFocused, this).onSync(\"blurred\", onBlurred, this).onSync(\"enterKeyed\", onEnterKeyed, this).onSync(\"tabKeyed\", onTabKeyed, this).onSync(\"escKeyed\", onEscKeyed, this).onSync(\"upKeyed\", onUpKeyed, this).onSync(\"downKeyed\", onDownKeyed, this).onSync(\"leftKeyed\", onLeftKeyed, this).onSync(\"rightKeyed\", onRightKeyed, this).onSync(\"queryChanged\", onQueryChanged, this).onSync(\"whitespaceChanged\", onWhitespaceChanged, this).onSync(\"langDirChanged\", this._onLangDirChanged, this);\n        }\n        _.mixin(Typeahead.prototype, {\n            _hacks: function hacks() {\n                var $input, $menu;\n                $input = this.input.$input || $(\"<div>\");\n                $menu = this.menu.$node || $(\"<div>\");\n                $input.on(\"blur.tt\", function($e) {\n                    var active, isActive, hasActive;\n                    active = document.activeElement;\n                    isActive = $menu.is(active);\n                    hasActive = $menu.has(active).length > 0;\n                    if (_.isMsie() && (isActive || hasActive)) {\n                        $e.preventDefault();\n                        $e.stopImmediatePropagation();\n                        _.defer(function() {\n                            $input.focus();\n                        });\n                    }\n                });\n                $menu.on(\"mousedown.tt\", function($e) {\n                    $e.preventDefault();\n                });\n            },\n            _onSelectableClicked: function onSelectableClicked(type, $el) {\n                this.select($el);\n            },\n            _onDatasetCleared: function onDatasetCleared() {\n                this._updateHint();\n            },\n            _onDatasetRendered: function onDatasetRendered(type, dataset, suggestions, async) {\n                this._updateHint();\n                this.eventBus.trigger(\"render\", suggestions, async, dataset);\n            },\n            _onAsyncRequested: function onAsyncRequested(type, dataset, query) {\n                this.eventBus.trigger(\"asyncrequest\", query, dataset);\n            },\n            _onAsyncCanceled: function onAsyncCanceled(type, dataset, query) {\n                this.eventBus.trigger(\"asynccancel\", query, dataset);\n            },\n            _onAsyncReceived: function onAsyncReceived(type, dataset, query) {\n                this.eventBus.trigger(\"asyncreceive\", query, dataset);\n            },\n            _onFocused: function onFocused() {\n                this._minLengthMet() && this.menu.update(this.input.getQuery());\n            },\n            _onBlurred: function onBlurred() {\n                if (this.input.hasQueryChangedSinceLastFocus()) {\n                    this.eventBus.trigger(\"change\", this.input.getQuery());\n                }\n            },\n            _onEnterKeyed: function onEnterKeyed(type, $e) {\n                var $selectable;\n                if ($selectable = this.menu.getActiveSelectable()) {\n                    this.select($selectable) && $e.preventDefault();\n                }\n            },\n            _onTabKeyed: function onTabKeyed(type, $e) {\n                var $selectable;\n                if ($selectable = this.menu.getActiveSelectable()) {\n                    this.select($selectable) && $e.preventDefault();\n                } else if ($selectable = this.menu.getTopSelectable()) {\n                    this.autocomplete($selectable) && $e.preventDefault();\n                }\n            },\n            _onEscKeyed: function onEscKeyed() {\n                this.close();\n            },\n            _onUpKeyed: function onUpKeyed() {\n                this.moveCursor(-1);\n            },\n            _onDownKeyed: function onDownKeyed() {\n                this.moveCursor(+1);\n            },\n            _onLeftKeyed: function onLeftKeyed() {\n                if (this.dir === \"rtl\" && this.input.isCursorAtEnd()) {\n                    this.autocomplete(this.menu.getTopSelectable());\n                }\n            },\n            _onRightKeyed: function onRightKeyed() {\n                if (this.dir === \"ltr\" && this.input.isCursorAtEnd()) {\n                    this.autocomplete(this.menu.getTopSelectable());\n                }\n            },\n            _onQueryChanged: function onQueryChanged(e, query) {\n                this._minLengthMet(query) ? this.menu.update(query) : this.menu.empty();\n            },\n            _onWhitespaceChanged: function onWhitespaceChanged() {\n                this._updateHint();\n            },\n            _onLangDirChanged: function onLangDirChanged(e, dir) {\n                if (this.dir !== dir) {\n                    this.dir = dir;\n                    this.menu.setLanguageDirection(dir);\n                }\n            },\n            _openIfActive: function openIfActive() {\n                this.isActive() && this.open();\n            },\n            _minLengthMet: function minLengthMet(query) {\n                query = _.isString(query) ? query : this.input.getQuery() || \"\";\n                return query.length >= this.minLength;\n            },\n            _updateHint: function updateHint() {\n                var $selectable, data, val, query, escapedQuery, frontMatchRegEx, match;\n                $selectable = this.menu.getTopSelectable();\n                data = this.menu.getSelectableData($selectable);\n                val = this.input.getInputValue();\n                if (data && !_.isBlankString(val) && !this.input.hasOverflow()) {\n                    query = Input.normalizeQuery(val);\n                    escapedQuery = _.escapeRegExChars(query);\n                    frontMatchRegEx = new RegExp(\"^(?:\" + escapedQuery + \")(.+$)\", \"i\");\n                    match = frontMatchRegEx.exec(data.val);\n                    match && this.input.setHint(val + match[1]);\n                } else {\n                    this.input.clearHint();\n                }\n            },\n            isEnabled: function isEnabled() {\n                return this.enabled;\n            },\n            enable: function enable() {\n                this.enabled = true;\n            },\n            disable: function disable() {\n                this.enabled = false;\n            },\n            isActive: function isActive() {\n                return this.active;\n            },\n            activate: function activate() {\n                if (this.isActive()) {\n                    return true;\n                } else if (!this.isEnabled() || this.eventBus.before(\"active\")) {\n                    return false;\n                } else {\n                    this.active = true;\n                    this.eventBus.trigger(\"active\");\n                    return true;\n                }\n            },\n            deactivate: function deactivate() {\n                if (!this.isActive()) {\n                    return true;\n                } else if (this.eventBus.before(\"idle\")) {\n                    return false;\n                } else {\n                    this.active = false;\n                    this.close();\n                    this.eventBus.trigger(\"idle\");\n                    return true;\n                }\n            },\n            isOpen: function isOpen() {\n                return this.menu.isOpen();\n            },\n            open: function open() {\n                if (!this.isOpen() && !this.eventBus.before(\"open\")) {\n                    this.menu.open();\n                    this._updateHint();\n                    this.eventBus.trigger(\"open\");\n                }\n                return this.isOpen();\n            },\n            close: function close() {\n                if (this.isOpen() && !this.eventBus.before(\"close\")) {\n                    this.menu.close();\n                    this.input.clearHint();\n                    this.input.resetInputValue();\n                    this.eventBus.trigger(\"close\");\n                }\n                return !this.isOpen();\n            },\n            setVal: function setVal(val) {\n                this.input.setQuery(_.toStr(val));\n            },\n            getVal: function getVal() {\n                return this.input.getQuery();\n            },\n            select: function select($selectable) {\n                var data = this.menu.getSelectableData($selectable);\n                if (data && !this.eventBus.before(\"select\", data.obj)) {\n                    this.input.setQuery(data.val, true);\n                    this.eventBus.trigger(\"select\", data.obj);\n                    this.close();\n                    return true;\n                }\n                return false;\n            },\n            autocomplete: function autocomplete($selectable) {\n                var query, data, isValid;\n                query = this.input.getQuery();\n                data = this.menu.getSelectableData($selectable);\n                isValid = data && query !== data.val;\n                if (isValid && !this.eventBus.before(\"autocomplete\", data.obj)) {\n                    this.input.setQuery(data.val);\n                    this.eventBus.trigger(\"autocomplete\", data.obj);\n                    return true;\n                }\n                return false;\n            },\n            moveCursor: function moveCursor(delta) {\n                var query, $candidate, data, payload, cancelMove;\n                query = this.input.getQuery();\n                $candidate = this.menu.selectableRelativeToCursor(delta);\n                data = this.menu.getSelectableData($candidate);\n                payload = data ? data.obj : null;\n                cancelMove = this._minLengthMet() && this.menu.update(query);\n                if (!cancelMove && !this.eventBus.before(\"cursorchange\", payload)) {\n                    this.menu.setCursor($candidate);\n                    if (data) {\n                        this.input.setInputValue(data.val);\n                    } else {\n                        this.input.resetInputValue();\n                        this._updateHint();\n                    }\n                    this.eventBus.trigger(\"cursorchange\", payload);\n                    return true;\n                }\n                return false;\n            },\n            destroy: function destroy() {\n                this.input.destroy();\n                this.menu.destroy();\n            }\n        });\n        return Typeahead;\n        function c(ctx) {\n            var methods = [].slice.call(arguments, 1);\n            return function() {\n                var args = [].slice.call(arguments);\n                _.each(methods, function(method) {\n                    return ctx[method].apply(ctx, args);\n                });\n            };\n        }\n    }();\n    (function() {\n        \"use strict\";\n        var old, keys, methods;\n        old = $.fn.typeahead;\n        keys = {\n            www: \"tt-www\",\n            attrs: \"tt-attrs\",\n            typeahead: \"tt-typeahead\"\n        };\n        methods = {\n            initialize: function initialize(o, datasets) {\n                var www;\n                datasets = _.isArray(datasets) ? datasets : [].slice.call(arguments, 1);\n                o = o || {};\n                www = WWW(o.classNames);\n                return this.each(attach);\n                function attach() {\n                    var $input, $wrapper, $hint, $menu, defaultHint, defaultMenu, eventBus, input, menu, typeahead, MenuConstructor;\n                    _.each(datasets, function(d) {\n                        d.highlight = !!o.highlight;\n                    });\n                    $input = $(this);\n                    $wrapper = $(www.html.wrapper);\n                    $hint = $elOrNull(o.hint);\n                    $menu = $elOrNull(o.menu);\n                    defaultHint = o.hint !== false && !$hint;\n                    defaultMenu = o.menu !== false && !$menu;\n                    defaultHint && ($hint = buildHintFromInput($input, www));\n                    defaultMenu && ($menu = $(www.html.menu).css(www.css.menu));\n                    $hint && $hint.val(\"\");\n                    $input = prepInput($input, www);\n                    if (defaultHint || defaultMenu) {\n                        $wrapper.css(www.css.wrapper);\n                        $input.css(defaultHint ? www.css.input : www.css.inputWithNoHint);\n                        $input.wrap($wrapper).parent().prepend(defaultHint ? $hint : null).append(defaultMenu ? $menu : null);\n                    }\n                    MenuConstructor = defaultMenu ? DefaultMenu : Menu;\n                    eventBus = new EventBus({\n                        el: $input\n                    });\n                    input = new Input({\n                        hint: $hint,\n                        input: $input\n                    }, www);\n                    menu = new MenuConstructor({\n                        node: $menu,\n                        datasets: datasets\n                    }, www);\n                    typeahead = new Typeahead({\n                        input: input,\n                        menu: menu,\n                        eventBus: eventBus,\n                        minLength: o.minLength\n                    }, www);\n                    $input.data(keys.www, www);\n                    $input.data(keys.typeahead, typeahead);\n                }\n            },\n            isEnabled: function isEnabled() {\n                var enabled;\n                ttEach(this.first(), function(t) {\n                    enabled = t.isEnabled();\n                });\n                return enabled;\n            },\n            enable: function enable() {\n                ttEach(this, function(t) {\n                    t.enable();\n                });\n                return this;\n            },\n            disable: function disable() {\n                ttEach(this, function(t) {\n                    t.disable();\n                });\n                return this;\n            },\n            isActive: function isActive() {\n                var active;\n                ttEach(this.first(), function(t) {\n                    active = t.isActive();\n                });\n                return active;\n            },\n            activate: function activate() {\n                ttEach(this, function(t) {\n                    t.activate();\n                });\n                return this;\n            },\n            deactivate: function deactivate() {\n                ttEach(this, function(t) {\n                    t.deactivate();\n                });\n                return this;\n            },\n            isOpen: function isOpen() {\n                var open;\n                ttEach(this.first(), function(t) {\n                    open = t.isOpen();\n                });\n                return open;\n            },\n            open: function open() {\n                ttEach(this, function(t) {\n                    t.open();\n                });\n                return this;\n            },\n            close: function close() {\n                ttEach(this, function(t) {\n                    t.close();\n                });\n                return this;\n            },\n            select: function select(el) {\n                var success = false, $el = $(el);\n                ttEach(this.first(), function(t) {\n                    success = t.select($el);\n                });\n                return success;\n            },\n            autocomplete: function autocomplete(el) {\n                var success = false, $el = $(el);\n                ttEach(this.first(), function(t) {\n                    success = t.autocomplete($el);\n                });\n                return success;\n            },\n            moveCursor: function moveCursoe(delta) {\n                var success = false;\n                ttEach(this.first(), function(t) {\n                    success = t.moveCursor(delta);\n                });\n                return success;\n            },\n            val: function val(newVal) {\n                var query;\n                if (!arguments.length) {\n                    ttEach(this.first(), function(t) {\n                        query = t.getVal();\n                    });\n                    return query;\n                } else {\n                    ttEach(this, function(t) {\n                        t.setVal(newVal);\n                    });\n                    return this;\n                }\n            },\n            destroy: function destroy() {\n                ttEach(this, function(typeahead, $input) {\n                    revert($input);\n                    typeahead.destroy();\n                });\n                return this;\n            }\n        };\n        $.fn.typeahead = function(method) {\n            if (methods[method]) {\n                return methods[method].apply(this, [].slice.call(arguments, 1));\n            } else {\n                return methods.initialize.apply(this, arguments);\n            }\n        };\n        $.fn.typeahead.noConflict = function noConflict() {\n            $.fn.typeahead = old;\n            return this;\n        };\n        function ttEach($els, fn) {\n            $els.each(function() {\n                var $input = $(this), typeahead;\n                (typeahead = $input.data(keys.typeahead)) && fn(typeahead, $input);\n            });\n        }\n        function buildHintFromInput($input, www) {\n            return $input.clone().addClass(www.classes.hint).removeData().css(www.css.hint).css(getBackgroundStyles($input)).prop(\"readonly\", true).removeAttr(\"id name placeholder required\").attr({\n                tabindex: -1\n            });\n        }\n        function prepInput($input, www) {\n            $input.data(keys.attrs, {\n                dir: $input.attr(\"dir\"),\n                autocomplete: $input.attr(\"autocomplete\"),\n                spellcheck: $input.attr(\"spellcheck\"),\n                style: $input.attr(\"style\")\n            });\n            $input.addClass(www.classes.input);\n            try {\n                !$input.attr(\"dir\") && $input.attr(\"dir\", \"auto\");\n            } catch (e) {}\n            return $input;\n        }\n        function getBackgroundStyles($el) {\n            return {\n                backgroundAttachment: $el.css(\"background-attachment\"),\n                backgroundClip: $el.css(\"background-clip\"),\n                backgroundColor: $el.css(\"background-color\"),\n                backgroundImage: $el.css(\"background-image\"),\n                backgroundOrigin: $el.css(\"background-origin\"),\n                backgroundPosition: $el.css(\"background-position\"),\n                backgroundRepeat: $el.css(\"background-repeat\"),\n                backgroundSize: $el.css(\"background-size\")\n            };\n        }\n        function revert($input) {\n            var www, $wrapper;\n            www = $input.data(keys.www);\n            $wrapper = $input.parent().filter(www.selectors.wrapper);\n            _.each($input.data(keys.attrs), function(val, key) {\n                _.isUndefined(val) ? $input.removeAttr(key) : $input.attr(key, val);\n            });\n            $input.removeData(keys.typeahead).removeData(keys.www).removeData(keys.attr).removeClass(www.classes.input);\n            if ($wrapper.length) {\n                $input.detach().insertAfter($wrapper);\n                $wrapper.remove();\n            }\n        }\n        function $elOrNull(obj) {\n            var isValid, $el;\n            isValid = _.isJQuery(obj) || _.isElement(obj);\n            $el = isValid ? $(obj).first() : [];\n            return $el.length ? $el : null;\n        }\n    })();\n});\n","var global = this || window;\n\nfunction identity(x) { return x; }\n\n// String.trim polyfill\nif (!String.prototype.trim) {\n\tString.prototype.trim = function () {\n\t\treturn this.replace(/^\\s+|\\s+$/g, '');\n\t};\n}\n\nvar typeaheadEvents = [\n\t\"active\",\n\t\"idle\",\n\t\"open\",\n\t\"close\",\n\t\"change\",\n\t\"render\",\n\t\"select\",\n\t\"autocomplete\",\n\t\"asyncrequest\",\n\t\"asynccancel\",\n\t\"asyncreceive\",\n];\n\n/**\n * Activates typeahead behavior for given element.\n * @param element (required) The DOM element to infect.\n * @param source (optional) The custom data source.\n */\nMeteor.typeahead = function(element, source) {\n\tvar $e = $(element);\n\tvar datasets = resolve_datasets($e, source);\n\n\t$e.typeahead('destroy');\n\n\tvar options = $e.data('options') || {};\n\tif (typeof options != 'object') {\n\t\toptions = {};\n\t}\n\n\tfunction get_bool(name, defval) {\n\t\tvar val = $e.data(name);\n\t\treturn val === undefined ? defval : !!val;\n\t}\n\n\t// other known options passed via data attributes\n\tvar highlight = get_bool('highlight', false);\n\tvar hint = get_bool('hint', true);\n\tvar autoselect = get_bool('autoselect', false);\n\tvar minLength = get_min_length($e);\n\n\toptions = $.extend(options, {\n\t\thighlight: highlight,\n\t\thint: hint,\n\t\tminLength: minLength,\n\t\tautoselect: autoselect\n\t});\n\n\tvar instance;\n\tif (Array.isArray(datasets)) {\n\t\tinstance = $e.typeahead.apply($e, [options].concat(datasets));\n\t} else {\n\t\tvar dataset = datasets;\n\n\t\t// TODO remove this when typeahead.js will support minLength = 0\n\t\tif (minLength === 0 && dataset.local) {\n\t\t\t// based on @snekse suggestion (see https://github.com/twitter/typeahead.js/pull/719)\n\t\t\tvar altSource = dataset.source;\n\t\t\tdataset.source = function(query, sync, async) {\n\t\t\t\treturn query ? altSource(query, sync, async) : sync(dataset.local());\n\t\t\t};\n\t\t}\n\n\t\tinstance = $e.typeahead(options, dataset);\n\t}\n\n\t// bind event handlers\n\ttypeaheadEvents.forEach(function(name) {\n\t\tvar fn = resolve_template_function($e[0], $e.data(name));\n\t\tif ($.isFunction(fn)) {\n\t\t\tinstance.on('typeahead:' + name, fn);\n\t\t}\n\t});\n\n\t// fix to apply bootstrap form-control to tt-hint\n\t// TODO support other classes if needed\n\tif ($e.hasClass('form-control')) {\n\t\t$e.parent('.twitter-typeahead').find('.tt-hint').addClass('form-control');\n\t}\n\n\t// TODO remove this when typeahead.js will support minLength = 0\n\tif (minLength === 0) {\n\t\t$e.on('focus', function() {\n\t\t\tif ($e.val() === '') {\n\t\t\t\t$e.data('ttTypeahead').input.trigger('queryChanged', '');\n\t\t\t}\n\t\t});\n\t}\n\n\treturn instance;\n};\n\n/**\n * Activates all typeahead elements.\n * @param selector (optional) selector to find typeahead elements to be activated\n */\nMeteor.typeahead.inject = function(selector) {\n\tif (!selector) {\n\t\tselector = '.typeahead';\n\t}\n\n\t// See if we have a template instance to reference\n\tvar template = Template.instance();\n\tif (!template) {\n\t\t// If we don't, just init on the entire DOM\n\t\t$(selector).each(init_typeahead);\n\t} else {\n\t\t// Otherwise just init this template's typeaheads\n\t\ttemplate.$(selector).each(init_typeahead);\n\t}\n};\n\nfunction init_typeahead(index, element) {\n\ttry {\n\t\tif (!$(element).data('ttTypeahead')) {\n\t\t\tMeteor.typeahead(element);\n\t\t}\n\t} catch (err) {\n\t\tconsole.log(err);\n\t\treturn;\n\t}\n}\n\nfunction resolve_datasets($e, source) {\n\tvar element = $e[0];\n\tvar datasets = $e.data('sources') || $e.data('sets');\n\tif (datasets) {\n\t\tif (typeof datasets == 'string') {\n\t\t\tdatasets = resolve_template_function(element, datasets);\n\t\t}\n\t\tif ($.isFunction(datasets)) {\n\t\t\tdatasets = datasets() || [];\n\t\t}\n\t\treturn datasets.map(function(ds) {\n\t\t\treturn make_bloodhound(ds);\n\t\t});\n\t}\n\n\tvar name = normalize_dataset_name($e.attr('data-source-name') || $e.attr('name') || $e.attr('id') || 'dataset');\n\tvar limit = $e.data('limit');\n\tvar templateName = $e.data('template'); // specifies name of custom template\n\tvar templates = $e.data('templates'); // specifies custom templates\n\tvar valueKey = $e.data('value-key') || 'value';\n\tvar minLength = get_min_length($e);\n\n\tif (!source) {\n\t\tsource = $e.data('source') || [];\n\t}\n\n\tvar dataset = {\n\t\tname: name,\n\t\tvalueKey: valueKey,\n\t\tdisplayKey: valueKey,\n\t\tminLength: minLength,\n\t};\n\n\tif (limit) {\n\t\tdataset.limit = limit;\n\t}\n\n\t// support for custom templates\n\tif (templateName) {\n\t\tdataset.template = templateName;\n\t}\n\n\t// parse string with custom templates if it is specified\n\tif (templates && typeof templates === 'string') {\n\t\tset_templates(dataset, templates);\n\t}\n\n\tdataset.templates = make_templates(dataset);\n\n\tif (typeof source === 'string') {\n\t\tdataset.async = true;\n\t\tif (source.indexOf('/') >= 0) { // support prefetch urls\n\t\t\tisprefetch = true;\n\t\t\tdataset.prefetch = {\n\t\t\t\turl: source,\n\t\t\t\tfilter: function(list) {\n\t\t\t\t\treturn (list || []).map(value_wrapper(dataset));\n\t\t\t\t}\n\t\t\t};\n\t\t\treturn make_bloodhound(dataset);\n\t\t}\n\t\tsource = resolve_data_source(element, source);\n\t}\n\n\tif ($.isArray(source) || ($.isFunction(source) && source.length === 0)) {\n\t\tdataset.local = source;\n\t\treturn make_bloodhound(dataset);\n\t}\n\n\tdataset.source = source;\n\n\treturn dataset;\n}\n\nfunction get_min_length($e) {\n\tvar value = parseInt($e.data('min-length'));\n\treturn isNaN(value) || value < 0 ? 1 : value;\n}\n\n// typeahead.js throws error if dataset name does not meet /^[_a-zA-Z0-9-]+$/\nfunction normalize_dataset_name(name) {\n\treturn name.replace(/[\\]\\[\\.]/g, '_');\n}\n\n// Parses string with template names and set appropriate dataset properties.\nfunction set_templates(dataset, templates) {\n\tvar templateKeys = {\n\t\theader: 1,\n\t\tfooter: 1,\n\t\tsuggestion: 1,\n\t\ttemplate: 1, // suggestion alias\n\t\tnotFound: 1,\n\t\tempty: 1, // notFound alias\n\t\tpending: 1\n\t};\n\tvar pairs = templates.split(/[;,]+/);\n\tpairs.map(function(s) {\n\t\tvar p = s.split(/[:=]+/).map(function(it) { return it.trim(); });\n\t\tswitch (p.length) {\n\t\t\tcase 1: // set suggestion template when no key is specified\n\t\t\t\treturn ['template', p[0]];\n\t\t\tcase 2:\n\t\t\t\treturn (p[0] in templateKeys) ? [p[0], p[1]] : null;\n\t\t\tdefault:\n\t\t\t\treturn null;\n\t\t}\n\t}).filter(identity).forEach(function(p) {\n\t\tdataset[p[0]] = p[1];\n\t});\n}\n\n// Resolves data source function.\nfunction resolve_data_source(element, name) {\n\tvar fn = resolve_template_function(element, name);\n\tif ($.isFunction(fn)) {\n\t\treturn fn;\n\t}\n\n\t// collection.name\n\tvar path = name.split('.');\n\tif (path.length > 0) {\n\t\tvar collection = find_collection(path[0]);\n\t\tif (collection) {\n\t\t\tvar property = path.length > 1 ? path[1] : \"\";\n\t\t\treturn function() {\n\t\t\t\treturn collection.find().fetch()\n\t\t\t\t\t.map(function(it) {\n\t\t\t\t\t\tvar value = property ? it[property] : it.name || it.title;\n\t\t\t\t\t\t// wrap to object to use object id in selected event handler\n\t\t\t\t\t\treturn value ? {value: value, id: it._id} : \"\";\n\t\t\t\t\t})\n\t\t\t\t\t.filter(identity);\n\t\t\t};\n\t\t}\n\t}\n\n\tconsole.log(\"Unable to resolve data source function '%s'.\", name);\n\treturn [];\n}\n\nfunction find_collection(name) {\n\tif (typeof Mongo != \"undefined\" && typeof Mongo.Collection != \"undefined\") {\n\t\t// when use dburles:mongo-collection-instances\n\t\tif ($.isFunction(Mongo.Collection.get)) {\n\t\t\treturn Mongo.Collection.get(name);\n\t\t}\n\t}\n\tif (global) {\n\t\treturn global[name] || global[name.toLowerCase()] || null;\n\t}\n\treturn null;\n}\n\n// Resolves function with specified name from context of given element.\nfunction resolve_template_function(element, name) {\n\tvar fn = null;\n\tvar opts = {sync:false};\n\t// traverse view hierarchy and find helper function\n\tvar view = Blaze.getView(element);\n\twhile (view) {\n\t\tfn = resolve_helper(view, name, opts);\n\t\tif ($.isFunction(fn)) {\n\t\t\tbreak;\n\t\t}\n\t\tview = view.parentView;\n\t}\n\n\tif (!$.isFunction(fn)) {\n\t\treturn null;\n\t}\n\n\t// calls template helper function with Template.instance() context\n\tfunction invoke(args) {\n\t\t// use Blaze._withCurrentView internal function to set current view\n\t\t// also since meteor 1.2 no need to use Template._withTemplateInstanceFunc\n\t\t// since the function is already bound to template instance\n\t\treturn Blaze._withCurrentView(view, function() {\n\t\t\treturn fn.apply(null, args);\n\t\t});\n\t}\n\n\tif (opts.sync) { // local dataset?\n\t\treturn function() {\n\t\t\treturn invoke(Array.prototype.slice.call(arguments));\n\t\t};\n\t}\n\t// async data source\n\treturn function(a) {\n\t\treturn invoke(Array.prototype.slice.call(arguments));\n\t};\n}\n\nfunction resolve_helper(view, name, opts) {\n\tif (!view.template) {\n\t\treturn null;\n\t}\n\t// we need to known whether the helper function is async\n\t// use view.template.__helpers to determine that\n\t// since meteor 1.2 Blaze._getTemplateHelper wraps\n\t// the helper function binding it to template context\n\tvar fn = view.template.__helpers.get(name) || view.template[name];\n\tif (!$.isFunction(fn)) {\n\t\treturn null;\n\t}\n\topts.sync = fn.length === 0;\n\treturn Blaze._getTemplateHelper(view.template, name, function() {\n\t\treturn view.templateInstance();\n\t});\n}\n\n// Returns HTML template function that generates HTML string using data from suggestion item.\n// This function is implemented using given meteor template specified by templateName argument.\nfunction make_template_function(templateName) {\n\tif (!templateName) {\n\t\tthrow new Error(\"templateName is not specified\");\n\t}\n\n\tvar tmpl = Template[templateName];\n\tif (!tmpl) {\n\t\tthrow new Error(\"Template '\" + templateName  + \"' is not defined\");\n\t}\n\n\treturn function(context) {\n\t\tvar div = $(\"<div/>\");\n\t\tif ($.isFunction(Blaze.renderWithData)) {\n\t\t\tBlaze.renderWithData(tmpl, context, div[0]);\n\t\t} else { // for meteor < v0.9\n\t\t\tvar range = UI.renderWithData(tmpl, context);\n\t\t\tUI.insert(range, div[0]);\n\t\t}\n\t\t// return html wrapped into div to avoid visual issues\n\t\treturn div[0].outerHTML;\n\t};\n}\n\n// Creates object with template functions (for header, footer, suggestion, empty templates).\nfunction make_templates(dataset) {\n\n\tfunction make(value) {\n\t\tif (!value) {\n\t\t\treturn null;\n\t\t}\n\t\tif (typeof value === \"string\") {\n\t\t\tif (value.indexOf('<') >= 0) { // detect HTML string\n\t\t\t\treturn value;\n\t\t\t}\n\t\t\treturn make_template_function(value);\n\t\t}\n\t\treturn $.isFunction(value) ? value : null;\n\t}\n\n\tvar templates = {\n\t\theader: make(dataset.header),\n\t\tfooter: make(dataset.footer),\n\t\tsuggestion: make(dataset.suggestion || dataset.template),\n\t\tnotFound: make(dataset.notFound || dataset.empty),\n\t\tpending: make(dataset.pending)\n\t};\n\n\treturn Object.keys(templates)\n\t\t.filter(function(key) { return templates[key]; })\n\t\t.reduce(function(result, key) {\n\t\t\tresult[key] = templates[key];\n\t\t\treturn result;\n\t\t}, {});\n}\n\n// Returns function to map string value to plain JS object required by typeahead.\nfunction value_wrapper(dataset) {\n\treturn function(value) {\n\t\tif (typeof value === 'object') {\n\t\t\treturn value;\n\t\t}\n\t\tvar item = {};\n\t\titem[dataset.valueKey] = value;\n\t\treturn item;\n\t};\n}\n\n// Creates Bloodhound suggestion engine based on given dataset.\nfunction make_bloodhound(dataset) {\n\tif (!dataset.template) {\n\t\tif (Array.isArray(dataset.local)) {\n\t\t\tdataset.local = dataset.local.map(value_wrapper(dataset));\n\t\t} else if ($.isFunction(dataset.local) && dataset.local.length === 0) {\n\t\t\tvar localFn = dataset.local;\n\t\t\tdataset.local = function() {\n\t\t\t\treturn (localFn() || []).map(value_wrapper(dataset));\n\t\t\t};\n\t\t}\n\t}\n\n\tvar need_bloodhound = dataset.prefetch || Array.isArray(dataset.local) ||\n\t\t$.isFunction(dataset.local) && dataset.local.length === 0;\n\n\tvar engine;\n\n\tif (need_bloodhound) {\n\t\tvar options = $.extend({}, dataset, {\n\t\t\t// TODO support custom tokenizers\n\t\t\tdatumTokenizer: Bloodhound.tokenizers.obj.whitespace(dataset.valueKey),\n\t\t\tqueryTokenizer: Bloodhound.tokenizers.whitespace\n\t\t});\n\n\t\tengine = new Bloodhound(options);\n\t\tengine.initialize();\n\n\t\tif ($.isFunction(dataset.local) && dataset.local.length === 0) {\n\t\t\t// update data source on changing deps of local function\n\t\t\t// TODO find better (functional) way to do that\n\t\t\tvar tracker = Template.instance() || Tracker;\n\t\t\ttracker.autorun(function(comp) {\n\t\t\t\t// TODO stop tracking if typeahead is explicitly destroyed (issue #70)\n\t\t\t\tengine = new Bloodhound(options);\n\t\t\t\tengine.initialize();\n\t\t\t});\n\t\t}\n\t}\n\n\tfunction bloodhound_source(query, cb) {\n\t\tvar fn = engine.ttAdapter();\n\t\treturn fn(query, cb);\n\t}\n\n\tvar src = need_bloodhound || typeof dataset.local !== 'undefined' ?\n\t\t{source: need_bloodhound ? bloodhound_source : dataset.local}\n\t\t: {};\n\n\tvar templates = typeof dataset.templates === 'undefined' ?\n\t\t{templates: make_templates(dataset)}\n\t\t: {};\n\n\treturn $.extend({}, dataset, src, templates);\n}\n"]}}]