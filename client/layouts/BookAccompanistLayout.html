<template name="BookAccompanistLayout">
  <header>
  </header>
  <main>
    <br>
    {{>ReviewView}}


  </main>
</template>

<template name="ReviewView">
  <div class="row">
    <div class="col s12 m7 l7">
      {{>ReviewLeftFormPanel}}
    </div>

    <div class="col s12 m5 l5">
      {{> ReviewRightSummaryPanel}}
    </div>
  </div>
</template>

<template name="ReviewLeftFormPanel">
  <div class="card z-depth-0">
    <div class="card-content">
      <span class="black-text">
        {{> Template.dynamic template=currentStep}}
     </span>
    </div>
    <div class="card-action">
      <a class={{getNextButtonClass}}>Next</a><br><br>
    </div>
  </div>
</template>

<template name="ReviewRightSummaryPanel">
  {{#with currentBooking}}
  <div class="card z-depth-0">
    <div class="card-content center">
      <span class="black-text">
        <h5>Booking Summary</h5>
          <div class="divider"></div>
          <img class="responsive-img" src="{{coverPicById accompanist}}"/>
          <div class="limit-width-30 overlap-into-top-image"><img src="{{profilePicById accompanist}}" alt="" class="circle responsive-img" style="border:3px solid white"></div>

        <div class="container">



          {{#with basicProfileById accompanist}}
            <h6>{{name}}</h6>
            A pianist from {{affiliation}}<br>
          {{/with}}<br>
          <div class="divider"></div><br>

          <h6>{{formatDate startDate}}&nbsp;&nbsp;<i class="material-icons vertical-align-middle padding-bottom-3">keyboard_arrow_right</i>&nbsp;&nbsp;{{formatDate endDate}}</h6>
          <br>


          {{#with priceDetails accompanist sessionCount}}
          <div class="divider"></div>
          <table>
             <tbody>
               <tr>
                 <td>{{sessionCount}} Sessions</td>
                 <td><div class="right"><h6>${{total}}.00</h6></div></td>
               </tr>
             </tbody>
           </table>
          {{/with}}


      </div>
     </span>
    </div>
  </div>
  {{/with}}
</template>

<template name='EventReview'>

  <h5>1. Event</h5>

  <div class="divider"></div><br>
  {{#with currentTransaction}}
      {{#autoForm id="UpdateEventInformation" collection="Transactions" type="update" doc=this}}
        <!-- Pre-Filled from previous page -->
        {{> afQuickField name="startDate" type="hidden"}}
        {{> afQuickField name="endDate" type="hidden"}}
        {{> afQuickField name="status" type="hidden"}}
        {{> afQuickField name="accompanist" type="hidden"}}


        <!-- {{> afQuickField name="repertoire" type="hidden"}} -->
        {{> afArrayField name="repertoire" template="newAccompCustomArrayField" data="booking"}}

          Where is the location of the final performance?
          {{> afQuickField name="performanceLocation" label="Performance Location"}}
      {{/autoForm}}
  {{else}}
      <!-- Some kind of error prevented transaction from being carried over-->
      {{#autoForm id="UpdateSessionCount" collection="Transactions" type="update" doc=this}}
        {{> afQuickField name="startDate"}}
        {{> afQuickField name="endDate"}}
        {{> afQuickField name="repertoire"}}
        {{> afQuickField name="status" type="hidden" value="Pending"}}
        {{> afQuickField name="accompanist" type="hidden" value=routeAccompanist}}

          How many sessions? (Rehearsal and Performance)
          <div class="row">
            <div class="col s4">
              {{> afQuickField name="sessionCount" label=false type="select" defaultValue=defaultSessionCount firstOption="1 session" options=sessionsOptions }}
            </div>
          </div><br>

      {{/autoForm}}
  {{/with}}


  {{#autoForm id="InsertFirstSession" collection="Sessions" type="update" doc=currentSession}}
    {{> afQuickField name="sessionType" value="Rehearsal" type="hidden"}}
    {{> afQuickField name="status" value="Pending" type="hidden"}}
    {{> afQuickField name="firstSession" value="true" type="hidden"}}

    When would you like to have your FIRST session?<br><br>
    {{> afFieldInput id="firstSessionDate" name="date" type="date"}}
    <br><br>
    Suggest some times for the FIRST session? (At least 2)<br><br>
    <!-- {{> afQuickField name="suggestedTimes" }} -->
    <!-- {{> afArrayField name="suggestedTimes" template="newAccompCustomArrayField" data="sessionTime"}} -->
    {{> afFieldInput id="firstSuggestedHours" name="suggestedHours" type="time-checkboxes" options=optionsArray}} <br>

  {{/autoForm}}
</template>


<template name="SessionReview">

  <h5>2. Sessions</h5>

  <div class="divider"></div><br>
  {{#with currentTransaction}}
      {{#autoForm id="UpdateSessionCount" collection="Transactions" type="update" doc=this}}
        <!-- Pre-Filled from previous page -->
        {{> afQuickField name="startDate" type="time"}}
        {{> afQuickField name="endDate" type="hidden"}}
        {{> afQuickField name="status" type="hidden"}}
        {{> afQuickField name="accompanist" type="hidden"}}

        <!-- {{> afQuickField name="repertoire" type="hidden"}} -->
        {{> afArrayField name="repertoire" template="newAccompCustomArrayField" data="booking"}}

          Where is the location of the final performance?
          {{> afQuickField name="performanceLocation" label="Performance Location"}}
      {{/autoForm}}
  {{else}}
      <!-- Some kind of error prevented transaction from being carried over-->
      {{#autoForm id="UpdateSessionCount" collection="Transactions" type="update" doc=this}}
        {{> afQuickField name="startDate"}}
        {{> afQuickField name="endDate"}}
        {{> afQuickField name="repertoire"}}
        {{> afQuickField name="status" type="hidden" value="Pending"}}
        {{> afQuickField name="accompanist" type="hidden" value=routeAccompanist}}

          How many sessions? (Rehearsal and Performance)
          <div class="row">
            <div class="col s4">
              {{> afQuickField name="sessionCount" label=false type="select" defaultValue=defaultSessionCount firstOption="1 session" options=sessionsOptions }}
            </div>
          </div><br>

      {{/autoForm}}
  {{/with}}


  {{#autoForm id="InsertFirstSession" collection="Sessions" type="update" doc=currentSession}}
    {{> afQuickField name="sessionType" value="Rehearsal" type="hidden"}}
    {{> afQuickField name="status" value="Pending" type="hidden"}}
    {{> afQuickField name="firstSession" value="true" type="hidden"}}

    When would you like to have your FIRST session?<br><br>
    {{> afFieldInput id="firstSessionDate" name="date" type="date"}}
    <br><br>
    Suggest some times for the FIRST session? (At least 2)<br><br>
    <!-- {{> afQuickField name="suggestedTimes" }} -->
    <!-- {{> afArrayField name="suggestedTimes" template="newAccompCustomArrayField" data="sessionTime"}} -->
    {{> afFieldInput id="firstSuggestedHours" name="suggestedHours" type="time-checkboxes" options=optionsArray}} <br>

  {{/autoForm}}
</template>

<template name="PaymentReview">
  <h5>2. Payment</h5>
    <div class="divider"></div>

</template>

<template name="SuccessLayout">
  <h3 class="center">Booking Request Sent!</h3>
  <div class="row">
    <div class="col s12 m4 l4 push-m4 push-l4">
      {{> Template.dynamic template="BookingCard" data=routeTransaction}}
    </div>
  </div>
</template>

<!-- <template name="bookAccompanistForm">
  {{#with routeAccompanist}}
    {{#autoForm id="bookAccompanistForm" collection="Transactions" type="insert"}}
      {{> afQuickField name="musician" value=currentUser._id type="hidden"}}
      {{> afQuickField name="accompanist" value=this type="hidden"}}
      {{> afQuickField name="status" value="Pending" type="hidden"}}
      <br>
      <div class="row">
        <div class="col s5 tooltipped" data-tooltip="Start date of rehearsals">
          <label for="sd" class="active">Start Date</label>
          {{> afFieldInput name="startDate" id="sd" value=urlStartDate type="date" }}
        </div>
        <div class="col s2">
          <i class=" arrow fa-rotate-180 small material-icons prefix blue-text text-darken-2">keyboard_backspace</i>
        </div>
        <div class="col s5 tooltipped" data-tooltip="Final performance date">
          <label for="ed" class="active">End Date</label>
          {{> afFieldInput name="endDate" id="ed" value=urlEndDate type="date" }}
        </div>
      </div>

       <label for="pt" class="active">Performance Type</label>
      {{> afFieldInput name="performanceType" id="pt" type="select" options="allowed"}}

      {{> afArrayField name="repertoire" template="newAccompCustomArrayField" data="booking"}}

    {{/autoForm}}
    <div class="center"><button class="btn wave-light book-accompanist">Request To Book</button></div>
  {{else}}
    Not on an accompanist page.
  {{/with}}
</template> -->
<!-- <template name="invalidId">
  <h2>Invalid ID</h2>
</template> -->
