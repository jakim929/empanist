<template name="TestLayout">

<script type="text/javascript">
// $(function() {
//     $('input[name="daterange"]').daterangepicker();
// });
// </script>
       <header>
        <link rel="stylesheet" href="../style.css">
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
      </header>


      <main>

        <div class="container">
          {{>picOverlord}}
        </div>

      </main>


	<!-- Include Required Prerequisites -->




</template>

<template name="picOverlord">
  <div class="row">
    <div class="col s12">
      <ul class="tabs">
        <li class="tab col s3"><a class="upload-image-tab grey lighten-5 active" href="#uploadImage">Upload Image</a></li>
        <li class="tab col s3"><a class="change-thumbnail-tab grey lighten-5" href="#editThumbnail">Edit Thumbnail</a></li>
      </ul>
    </div>
    <div id="uploadImage" class="col s12">{{>picUploader}}</div>
    <div id="editThumbnail" class="col s12">{{>picCropper}}</div>
  </div>

</template>

<template name="picUploader">


      <div class="row">
        {{#if Template.subscriptionsReady}}
        {{#with currentImage}}


        <div class="col s6">
          <div class="card change-image-container z-depth-0">
            <div class="card-content">
              <span class="card-title flow-text">Current Image</span>
              <p>
                <div class="thumbnail">

                    <!-- {{#if derivatives.thumbnail}} -->
                    <!-- <img class="responsive-img" src="{{derivatives.thumbnail}}" id="{{_id}}">
                    {{else}} -->
                    <img class="responsive-img limit-height" src="{{url}}" height="200" id="{{_id}}">
                    <!-- {{/if}} -->
                    <!-- <h6 class="id">Current Image</h6> -->
                </div>
              </p>
            </div>
          </div>
        </div>

        {{/with}}
        {{/if}}

        <div class="col s6">
          <div class="card change-image-container z-depth-0 {{previewPresent}}">
            <div class="card-content">
              <span class="card-title">Upload Preview</span>
              <p>
                <div class="preview thumbnail">
                      <canvas id="thumbnail_canvas"></canvas>
                      <!-- <h6 class="id">Preview</h6> -->

                  <!-- <button class="btn crop-uploader-upload">Upload</button> -->
                </div>
              </p>
            </div>
          </div>
        </div>
      </div>



      <div class="row">
        <div class="col s12">

          <div class="card z-depth-0">
            <div class="card-content">
              {{>cropUploader thumbnailWidth=dimensions.width thumbnailHeight=dimensions.height aspectRatio=dimensions.aspectRatio picType=picType}}
            </div>

          </div>
        </div>
      </div>


</template>

<template name="picCropper">
  {{#if Template.subscriptionsReady}}
    {{#with currentImage}}
    <div class="container">
      <div class="cropper-container">
        {{>cropUploaderCropper imageid=_id url=url thumbnailWidth=dimensions.width thumbnailHeight=dimensions.height}}
      </div>
      <br>
      <div class="buttons center row">
          <!-- <button class="btn blue lighten-2 rotate">Rotate</button> -->
          {{#if currentUser}}
          <button class="btn btn-success save col s4 push-s1" imageid="{{_id}}">Save</button>
          <button class="btn btn-danger red darken-2 delete col s4 push-s3" imageid="{{_id}}">Delete</button>
          {{/if}}
      </div>
    </div>
    {{/with}}
  {{else}}
      Loading
  {{/if}}
</template>

<!-- <template name="picUploader">
  <div class="container">
    {{#with currentImage}}
      <div class="cropper-image">
        {{>cropUploaderCropper imageid=_id url=url thumbnailWidth=250 thumbnailHeight=250}}
      </div>
      <br><br>
      <div class="buttons">
          <button class="btn rotate">Rotate</button>
          {{#if currentUser}}
          <button class="btn btn-success save" imageid="{{_id}}">Save</button>
          <button class="btn btn-danger delete" imageid="{{_id}}">Delete</button>
          {{/if}}
      </div>
    {{else}}
      {{>cropUploader thumbnailWidth=250 thumbnailHeight=250 picType=picType}}
    {{/with}}
  </div>
</template> -->


<template name="images">
  {{>cropUploader thumbnailWidth=200 thumbnailHeight=200}}

  <div class="images" id="images">
    {{#if Template.subscriptionsReady}}
      {{#each images}}
        <div class="thumbnail">
          {{#if derivatives.thumbnail}}
          <img src="{{derivatives.thumbnail}}" id="{{_id}}">
          {{else}}
          <img src="{{url}}" width="100" height="100" id="{{_id}}">
          {{/if}}
          <h6 class="id">{{_id}}</h6>
        </div>
      {{/each}}
    {{/if}}
    <div class="preview thumbnail">
          <canvas id="thumbnail_canvas"></canvas>
          <h6 class="id">Preview</h6>
    </div>
  </div>
</template>

<template name="cropper">
    {{#if Template.subscriptionsReady}}
        {{>cropUploaderCropper imageid=imageid url=url thumbnailWidth=200 thumbnailHeight=200}}
        <div class="buttons">
            <button class="btn rotate">Rotate</button>
            {{#if currentUser}}
            <button class="btn btn-success save" imageid="{{imageid}}">Save</button>
            <button class="btn btn-danger delete" imageid="{{imageid}}">Delete</button>
            {{/if}}
        </div>
    {{else}}
        Loading
    {{/if}}
</template>



<!-- <template name="BookPanel">
  <div class="row">
    <div class="col s12 m6">
      <div class="card blue-grey darken-1">
        <div class="card-content white-text">
          <span class="card-title">Book Accompanist</span>
          {{>bookAccompanist}}
        </div>
        <div class="card-action">
          <a href="#">This is a link</a>
          <a href="#">This is a link</a>
        </div>
      </div>
    </div>
  </div>
</template>


<template name="bookAccompanist">
  {{#autoForm collection="Transactions" doc=defaultTransaction id="bookAccompanist" type="insert"}}
    <fieldset>
    <legend>Book Accompanist</legend>

    {{>afArrayField name="repertoire" template="changed"}}

    {{>afQuickField name="startDate" type="pickadate" label-class="active"}}
    {{>afQuickField name="endDate" type="pickadate" label-class="active"}}

    <button type="submit" class="btn btn-primary">Book</button>
    </fieldset>
  {{/autoForm}}
</template> -->

<!-- <template name="modalConfirm">
   Modal Trigger -->
<!-- <a class="waves-effect waves-light btn modal-trigger" href="#modal1">Modal</a>
 -->
<!-- Modal Structure -->
<!-- <div id="modal1" class="modal">
  <div class="modal-content">
    <h4>Review Booking Request</h4>
    {{> Template.dynamic template="BookingRequest" data=(transactionById "2STt9vFsiQDmXXwK9")}}
  </div>
  <div class="modal-footer">
    <a href="#!" class=" modal-action modal-close waves-effect waves-green btn-flat">Confirm</a>
    <a href="#!" class=" modal-action modal-close waves-effect waves-green btn-flat">Reject</a>
  </div>
</div>
</template> -->
